<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeri Keyboard Navigasi & Zoom Otomatis</title>
    <style>
        :root {
            --neon-blue: #00ffff; /* Biru Neon Cerah */
            --dark-background: #121212; /* Latar Belakang Sangat Gelap */
            --card-background: #1e1e1e; /* Latar Belakang Card Gelap */
            --input-background: #2a2a2a; /* Latar Belakang Input Gelap */
            --border-color: #00bfff; /* Biru Neon Sekunder untuk batas */
            --text-color: #e0f7fa; /* Teks Putih Kebiruan */
            --secondary-neon: #00bfff; /* Biru Neon Sekunder untuk highlight */
            --danger-color: #ff4d4d; /* Merah Neon untuk bahaya */
            --success-color: #39ff14; /* Hijau Neon untuk sukses */
            --warning-color: #f1c40f; /* Kuning Neon untuk peringatan/caption */
            --primary-button: #00bfff; /* Warna utama tombol */
            --primary-button-hover: #00e5ff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--dark-background);
            color: var(--text-color);
            padding: 20px;
            margin: 0;
            line-height: 1.6;
        }

        .container, 
        .scatter-section {
            max-width: 960px;
            margin: 20px auto;
            background: var(--card-background); 
            padding: 30px;
            border-radius: 12px;
            /* Efek glow biru neon */
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2), 0 0 10px rgba(0, 255, 255, 0.1); 
            border: 1px solid var(--border-color);
        }

        .scatter-section {
            padding: 20px;
            margin-bottom: 25px;
        }

        h1 {
            text-align: center;
            color: var(--neon-blue);
            margin-bottom: 25px;
        }

        h2 {
            text-align: center;
            color: var(--secondary-neon);
            margin-top: 20px;
            text-shadow: 0 0 5px rgba(0, 191, 255, 0.7);
        }

        .judul-glow {
            text-align: center;
            color: var(--success-color); /* Menggunakan warna sukses neon */
            text-shadow: 0 0 10px var(--success-color), 0 0 20px var(--success-color);
            margin-bottom: 20px;
            font-size: 2.5em; /* Konsisten dengan h1 */
        }

        /* * --- Form, Input & Tombol --- 
         */
        textarea {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid var(--secondary-neon); /* Border neon */
            box-sizing: border-box;
            background-color: var(--input-background); /* Latar belakang gelap */
            color: var(--text-color);
            border-radius: 6px;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 191, 255, 0.8);
        }

        /* Style untuk semua button yang tidak spesifik */
        button,
        .btn {
            padding: 10px 18px;
            color: var(--dark-background);
            background-color: var(--primary-button); /* Biru neon sebagai warna primer */
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s, box-shadow 0.3s;
            font-weight: bold;
            margin-right: 10px;
            /* Efek neon ringan */
            box-shadow: 0 0 5px rgba(0, 191, 255, 0.5);
        }

        button:hover,
        .btn:hover {
            background-color: var(--primary-button-hover);
            box-shadow: 0 0 10px var(--primary-button-hover);
        }

        /* Tombol Danger */
        #clearDataBtn,
        .btn.danger {
            background-color: var(--danger-color); /* Merah Neon */
            color: var(--text-color);
            box-shadow: 0 0 5px var(--danger-color);
        }
        #clearDataBtn:hover,
        .btn.danger:hover {
            background-color: #ff8080; /* Merah yang lebih terang saat hover */
            box-shadow: 0 0 10px var(--danger-color);
        }

        .button-group {
            display: flex;
            justify-content: flex-end; /* Posisikan tombol Hapus di kanan */
            margin-bottom: 15px;
            margin-top: 10px; /* Diperbarui agar lebih konsisten */
            text-align: unset; /* override center dari style lama */
        }

        /* Style untuk textarea spesifik */
        .input-textarea {
            height: 100px;
            background: var(--input-background);
            color: var(--text-color);
            border: 1px solid var(--secondary-neon);
            padding: 10px;
            margin: 10px 0;
        }

        /* Style untuk toggle */
        .ts-toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-secondary);
            padding: 10px 15px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .ts-toggle-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .ts-toggle {
            position: relative;
            display: inline-block;
            width: 50px;
        }

        .ts-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .ts-toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-card);
            transition: .4s;
            border-radius: 24px;
            border: 1px solid var(--border-color);
        }

        .ts-toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 2px;
            background-color: var(--text-secondary);
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .ts-toggle-slider {
            background: var(--primary-color);
        }

        input:checked + .ts-toggle-slider:before {
            transform: translateX(26px);
            background-color: white;
        }

        .card {
background: var(--bg-card);
border-radius: 16px;
padding: 30px;
box-shadow: 0 15px 40px var(--shadow-color);
position: relative;
overflow: hidden;
margin-bottom: 30px;
border: 1px solid var(--border-color);
backdrop-filter: blur(8px);
-webkit-backdrop-filter: blur(8px);
}

h2 {
color: var(--primary-color);
margin: 0 0 25px;
font-weight: 700;
font-size: 1.7rem;
padding-bottom: 15px;
border-bottom: 2px solid var(--border-color);
text-shadow: 0 1px 3px rgba(0,0,0,0.3);
}

h3 {
color: var(--primary-light);
margin-bottom: 15px;
font-weight: 600;
font-size: 1.2rem;
padding-bottom: 10px;
}

/* Tab Container */
.tab-container {
display: flex;
margin-bottom: 25px;
border-bottom: 2px solid var(--border-color);
}

.tab-button {
padding: 12px 24px;
background: transparent;
border: none;
color: var(--text-secondary);
font-weight: 600;
cursor: pointer;
position: relative;
transition: all 0.3s ease;
font-size: 1rem;
border-radius: 8px 8px 0 0;
}

.tab-button.active {
color: var(--primary-color);
}

.tab-button.active::after {
content: '';
position: absolute;
bottom: -2px;
left: 0;
width: 100%;
height: 3px;
background: linear-gradient(90deg, var(--primary-color), var(--primary-darker));
border-radius: 3px;
}

.tab-content {
display: none;
}

.tab-content.active {
display: block;
}

/* STYLE UNTUK KALKULATOR CREDIT - DIKECILKAN */
.credit-calculator-container {
margin-top: 20px;
padding: 20px;
background: var(--bg-secondary);
border-radius: 12px;
border: 1px solid var(--border-color);
transform: scale(0.9);
transform-origin: top left;
width: 111%; /* Mengkompensasi scaling */
}

.credit-calculator-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 20px;
}

.credit-input-section {
grid-column: 1;
}

.credit-result-section {
grid-column: 2;
display: flex;
flex-direction: column;
justify-content: space-between;
}

#creditData {
min-height: 150px;
font-size: 0.85rem;
padding: 12px;
background-color: var(--bg-card);
color: var(--text-primary);
border: 1px solid var(--border-color);
border-radius: 8px;
resize: vertical;
width: 100%;
}

.credit-result-box {
background-color: var(--bg-card);
border: 1px solid var(--border-color);
border-radius: 10px;
padding: 15px;
height: 100%;
display: flex;
flex-direction: column;
}

.credit-result-header {
display: flex;
justify-content: space-between;
margin-bottom: 10px;
padding-bottom: 8px;
border-bottom: 1px solid var(--border-color);
}

.credit-result-title {
color: var(--primary-color);
font-weight: 600;
font-size: 1rem;
}

.credit-total {
font-size: 1.3rem;
color: var(--primary-color);
font-weight: bold;
margin: 10px 0;
text-align: center;
padding: 10px;
background-color: var(--primary-lighter);
border-radius: 8px;
border: 1px solid var(--primary-color);
}

.credit-action-buttons {
display: flex;
gap: 10px;
margin-top: auto;
}

.credit-btn {
flex: 1;
padding: 8px 12px;
border-radius: 6px;
font-size: 0.85rem;
display: flex;
align-items: center;
justify-content: center;
gap: 6px;
cursor: pointer;
transition: all 0.3s ease;
border: none;
font-weight: 600;
}

.credit-copy-btn {
background: var(--primary-color);
color: white;
}

.credit-copy-btn:hover {
background: var(--primary-dark);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
}

.credit-clear-btn {
background: var(--delete-color);
color: white;
}

.credit-clear-btn:hover {
background: #d32f2f;
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(244, 67, 54, 0.3);
}

.copy-notification {
color: var(--primary-color);
font-size: 0.75rem;
font-weight: 500;
display: none;
align-items: center;
gap: 5px;
background: rgba(76, 175, 80, 0.1);
padding: 8px 12px;
border-radius: 8px;
}

/* STYLE LAINNYA YANG SUDAH SAMA SEPERTI SEBELUM */
    </style>
</head>
<body>

    <div class="container">
        <h1>üì∏ Gambar Otomatis</h1>
        <p style="text-align: center; color: #3498db;">**Tempel/Ketik** data. Format: **USERID link_gambar1 link_gambar2 link_gambar3**</p>

        <textarea id="linkInput" 
                  placeholder="Tempelkan data paket di sini. Setiap baris adalah satu paket." 
                  rows="8" 
                  oninput="handleInput()"
                  onpaste="handleInput()"></textarea>
        
        <div class="button-group">
            <button id="clearDataBtn" onclick="clearAllData()">üóëÔ∏è Hapus Semua Data</button>
        </div>

        <hr>

        <div class="gallery-container">
            
            <div class="combined-image-slot" id="combinedImageSlot" onclick="openZoom()">
                
                <p class="caption-userid" id="combinedSlotUserid">USER ID</p>
                
                <img id="imgSlot1" data-link="" src="https://via.placeholder.com/200x180/2c3e50/ffffff?text=Slot+1" alt="Slot 1">
                <img id="imgSlot2" data-link="" src="https://via.placeholder.com/200x180/2c3e50/ffffff?text=Slot+2" alt="Slot 2">
                <img id="imgSlot3" data-link="" src="https://via.placeholder.com/200x180/2c3e50/ffffff?text=Slot+3" alt="Slot 3">
            </div>
            
        </div>

        <p class="package-info">
            Paket: <span id="currentPackageNum">0</span> / <span id="maxPackageNum">0</span>
        </p>

    </div>

    <div id="zoomModal" class="modal" onclick="closeZoom(event)">
        <span class="close-btn">&times;</span>
        <span id="zoomedUserid" class="zoomed-userid"></span> 
        
        <div class="zoomed-content-area">
            
            <button class="zoom-nav-button" id="prevZoomBtn" onclick="navigatePackage('prev')">&#9664;</button>
            
            <div class="zoomed-content-wrapper" id="zoomedContentWrapper">
                </div>

            <button class="zoom-nav-button" id="nextZoomBtn" onclick="navigatePackage('next')">&#9654;</button>
        </div>
        
        <textarea id="zoomLinkInput" class="zoom-link-input-area"></textarea>
               
        <div id="caption">Geser paket menggunakan tombol navigasi (&#9664; / &#9654;) atau tombol panah Kiri/Kanan pada keyboard.</div>
    </div>

    <div class="container">
<header>
<h1>Scatter Unlimited Kolom & Kalkulator Credit</h1>
<p>Tools untuk memproses data scatter Unlimited kolom berbeda dan credit PG SOFT</p>
</header>

<div class="card">
<!-- Tab Navigation -->
<div class="tab-container">
<button class="tab-button active" data-tab="scatter-tab">Scatter Unlimited Kolom</button>
<button class="tab-button" data-tab="credit-tab">Kalkulator Credit PG SOFT</button>
</div>

<!-- Tab Scatter 6 Kolom -->
<div id="scatter-tab" class="tab-content active">
<h2>Input Data Scatter</h2>

<!-- Input otomatis - SATU-SATUNYA INPUT UNTUK SCATTER -->
<div class="auto-input-container" id="autoInputContainer">
<div class="auto-input-header">
<h3>
<i class="fas fa-magic"></i>
Input Otomatis Unlimited Kolom sekaligus
</h3>
<div class="auto-input-info">
<span>Data terdeteksi: <span id="dataCount" class="count-badge">0</span></span>
</div>
</div>
<textarea id="autoInput" placeholder="Tempel data mentah di sini... Data akan otomatis tersebar ke kolom di bawah ini. Input unlimited."></textarea>
<div class="auto-input-actions">
<div class="auto-input-warning" id="autoInputWarning">
<i class="fas fa-info-circle"></i>
<span>Data akan selalu ditampilakan berapapun hasilnya.</span>
</div>
<div class="auto-input-error" id="autoInputError">
<i class="fas fa-exclamation-triangle"></i>
<span>Format data tidak valid. Pastikan data mengandung link gambar.</span>
</div>
<button class="auto-delete-btn" id="autoDeleteBtn">
<i class="fas fa-trash-alt"></i> Hapus Input
</button>
</div>

<div class="action-buttons">
<button class="btn btn-clear" id="clearScatter6Btn">
<i class="fas fa-trash-alt"></i> Hapus Semua
</button>
</div>

<div class="result-container">
<div class="result-header">
<h2>Hasil Format Scatter</h2>
<div class="ts-toggle-container">
<span class="ts-toggle-label">TS Mode:</span>
<label class="ts-toggle">
<input type="checkbox" id="tsToggle">
<span class="ts-toggle-slider"></span>
</label>
</div>
</div>
<div class="six-columns-result" id="scatter6Results">
<!-- Hasil akan diisi oleh JavaScript -->
</div>
</div>
</div>

<!-- Tab Kalkulator Credit PG SOFT -->
<div id="credit-tab" class="tab-content">
<h2>Kalkulator Credit PG SOFT</h2>

<div class="credit-calculator-container">
<p class="credit-description">Tempel data dari seamless untuk menghitung total credit secara otomatis</p>

<div class="credit-calculator-grid">
<div class="credit-input-section">
<div class="input-wrapper">
<textarea id="creditData" placeholder="Tempelnya disini...
Contoh:
...
Credit
IDR 1,000
...
Credit
IDR 2,500"></textarea>
</div>

<div class="action-buttons">
<button class="credit-btn credit-clear-btn" id="clearCreditBtn">
<i class="fas fa-trash-alt"></i> Hapus
</button>
</div>
</div>

<div class="credit-result-section">
<div class="credit-result-box">
<div class="credit-result-header">
<span class="credit-result-title">Total Credit:</span>
</div>

<div class="credit-total" id="creditTotal">IDR 0</div>

<div class="credit-action-buttons">
<button class="credit-btn credit-copy-btn" id="copyCreditBtn">
<i class="far fa-copy"></i> Salin Nominal
</button>
</div>
<div class="copy-notification" id="creditCopyNotification"></div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Modal untuk preview gambar -->
<div id="imageModal" class="modal">
<span class="close-btn">&times;</span>
<div class="modal-content">
<div class="image-info" id="imageInfo">
<div class="image-detail">
<i class="fas fa-columns"></i>
<span id="colInfo">Kolom 1</span>
</div>
<div class="image-detail">
<i class="fas fa-user"></i>
<span id="userIdInfo">User ID: -</span>
</div>
<div class="image-detail">
<i class="fas fa-ticket-alt"></i>
<span id="ticketInfo">Kode Tiket: -</span>
</div>
</div>

<!-- Kontrol zoom -->
<div class="zoom-controls">
<button class="zoom-btn" id="zoomOutBtn" title="Zoom Out">
<i class="fas fa-search-minus"></i>
</button>
<button class="zoom-btn" id="zoomResetBtn" title="Reset Zoom">
<i class="fas fa-sync-alt"></i>
</button>
<button class="zoom-btn" id="zoomInBtn" title="Zoom In">
<i class="fas fa-search-plus"></i>
</button>
</div>

<div class="zoom-indicator" id="zoomIndicator">100%</div>

<!-- Tombol navigasi kolom - akan dibuat dinamis -->
<div class="modal-navigation" id="modalNavigation">
<!-- Tombol navigasi akan diisi secara dinamis -->
</div>

<div class="images-container" id="imagesContainer">
<!-- Gambar akan ditambahkan di sini -->
</div>
</div>

<!-- Toast Notification -->
<div id="toast">
<i class="fas fa-check-circle"></i>
<span id="toastMessage">‚úì Disalin ke clipboard</span>
</div>
    
    <script>
        /* ======================== JAVASCRIPT ======================== */
        let allPackagesData = []; 
        let currentPackageIndex = 0; 
        const packageSize = 3; 
        const placeholderImage = "https://via.placeholder.com/200x180/2c3e50/ffffff?text=Kosong"; 
        let isZoomOpen = false;

        // --- Fungsi untuk Memuat Gambar (dari Textarea) ---
        function loadImages() {
            const inputArea = document.getElementById('linkInput');
            
            const rawLines = inputArea.value
                .split('\n')
                .map(line => line.trim())
                .filter(line => line.length > 0);
            
            allPackagesData = [];
            const urlRegex = /(https?:\/\/[^\s]+)/g;

            rawLines.forEach((line) => {
                const urls = line.match(urlRegex) || [];
                
                const words = line.split(/\s+/).filter(w => w.length > 0);
                let userid = 'N/A';

                if (words.length > 2) {
                    userid = words[2].trim();
                }

                const links = line.match(urlRegex) || [];
                const linksText = links.join(', ') || '-';
                const betValue = '-';

                allPackagesData.push({
                    userId: userid,
                    ticketCode: '-',
                    links: links,
                    linksText: linksText,
                    betValue: betValue,
                    hasData: true,
                    hasImages: links.length > 0,
                    isCancelled: false
                });
            });

            if (allPackagesData.length === 0) {
                 // Kosongkan hasil jika tidak ada data
                return;
            }

            document.getElementById('maxPackageNum').textContent = allPackagesData.length;
            
            if (allPackagesData.length > 0) {
                currentPackageIndex = Math.min(currentPackageIndex, allPackagesData.length - 1);
                currentPackageIndex = Math.max(0, currentPackageIndex);
                updateGallery(currentPackageIndex);
            }
        }

        // --- Fungsi untuk Memperbarui Tampilan Galeri ---
        function updateGallery(index) {
            const imgSlots = [
                document.getElementById('imgSlot1'),
                document.getElementById('imgSlot2'),
                document.getElementById('imgSlot3')
            ];
            
            const combinedSlot = document.getElementById('combinedImageSlot');
            const useridCaption = document.getElementById('combinedSlotUserid');
            const validPackages = allPackagesData.length;
            
            let currentPackage = { userId: 'N/A', links: ["", "", ""], hasImages: false };
            
            if (index >= 0 && index < validPackages) {
                currentPackage = allPackagesData[index];
                combinedSlot.style.pointerEvents = 'auto'; // Dapat diklik
            }
            
            let currentPackage = { userId: 'N/A', links: ["", "", ""], hasImages: false };
            
            if (index >= 0 && index < validPackages) {
                currentPackage = allPackagesData[index];
                combinedSlot.style.pointerEvents = 'auto'; // Dapat diklik
            }
            
            combinedSlot.setAttribute('data-userid', currentPackage.userid);
            useridCaption.textContent = currentPackage.userid === 'N/A' ? 'Belum Ada Data' : `USER ID: ${currentPackage.userid}`;

            let validLinkCount = 0;
            for (let i = 0; i < packageSize; i++) {
                const link = currentPackage.links[i] || "";

                if (link) {
                    imgSlots[i].src = link;
                    imgSlots[i].style.display = 'block';
                    imgSlots[i].setAttribute('data-link', link);
                    validLinkCount++;
                } else {
                    imgSlots[i].src = placeholderImage;
                    // Tampilkan placeholder tengah saja jika tidak ada data sama sekali
                    imgSlots[i].style.display = (index === -1 && i === 1) ? 'block' : 'none'; 
                    imgSlots[i].setAttribute('data-link', "");
                }
            }
            
            if (validLinkCount > 0) {
                combinedSlot.style.opacity = 1;
            } else {
                combinedSlot.style.opacity = 0.5;
            }

            document.getElementById('currentPackageNum').textContent = validPackages > 0 ? index + 1 : 0;
            
            if (isZoomOpen) {
                updateZoomDisplay(currentPackage.userid, currentPackage.links);
                updateZoomNavButtons();
            }
        }

        // --- Fungsi Navigasi (Untuk Tombol Fisik & Keyboard) ---
        function navigatePackage(direction) {
            let newIndex = currentPackageIndex;
            if (direction === 'next' && currentPackageIndex < allPackagesData.length - 1) {
                newIndex++;
            } else if (direction === 'prev' && currentPackageIndex > 0) {
                newIndex--;
            }
            
            if (newIndex !== currentPackageIndex) {
                currentPackageIndex = newIndex;
                updateGallery(currentPackageIndex); 
            }
        }
        
        // --- Update Tampilan Zoom ---
        function updateZoomDisplay(userid, links) {
            const wrapper = document.getElementById("zoomedContentWrapper");
            const zoomedUserid = document.getElementById("zoomedUserid");
            
            wrapper.innerHTML = '';
            
            links.forEach(link => {
                if (link) {
                    const img = document.createElement('img');
                    img.src = link;
                    img.className = 'modal-img';
                    img.alt = 'Zoomed Image';
                    wrapper.appendChild(img);
                }
            });
            
            zoomedUserid.textContent = userid; 
        }
        
        // --- Update Status Tombol Navigasi Zoom ---
        function updateZoomNavButtons() {
            const prevBtn = document.getElementById('prevZoomBtn');
            const nextBtn = document.getElementById('nextZoomBtn');
            
            if (allPackagesData.length <= 1) {
                prevBtn.disabled = true;
                nextBtn.disabled = true;
            } else {
                prevBtn.disabled = (currentPackageIndex === 0);
                nextBtn.disabled = (currentPackageIndex >= allPackagesData.length - 1);
            }
        }

        // --- Fungsi Zoom in ---
        function zoomIn() {
            if (currentZoomLevel < MAX_ZOOM) {
                currentZoomLevel += ZOOM_STEP;
                applyZoom();
            }
        }

        // --- Fungsi Zoom out ---
        function zoomOut() {
            if (currentZoomLevel > MIN_ZOOM) {
                currentZoomLevel -= ZOOM_STEP;
                applyZoom();
            }
        }

// --- Fungsi Reset Zoom ---
        function resetZoom() {
            currentZoomLevel = 1;
            applyZoom();
        }

        // --- Fungsi untuk menerapkan Zoom ke semua gambar ---
        function applyZoom() {
            const images = document.querySelectorAll('.modal-img');
            images.forEach(img => {
                img.style.transform = `scale(${currentZoomLevel})`;
            });

            // Update indikator zoom
            zoomIndicator.textContent = `${Math.round(currentZoomLevel * 100)}%`;

            // Tampilkan indikator zoom sementara
            zoomIndicator.style.display = 'block';
            setTimeout(() => {
                zoomIndicator.style.display = 'none';
            }, 2000);
        }

        // --- Fungsi untuk menutup modal ---
        function closeModal() {
            document.getElementById("zoomModal").style.display = "none";
            // Reset zoom saat menutup modal
            resetZoom();
        }

        // --- Event Listener Keyboard (Untuk Navigasi Zoom) ---
        document.addEventListener('keydown', (event) => {
            if (isZoomOpen) {
                if (event.key === "ArrowLeft") {
                    event.preventDefault(); 
                }

                if (event.key === "ArrowRight") {
                    event.preventDefault(); 
                }

                if (event.key === "ArrowLeft") {
                    navigatePackage('prev');
                } else if (event.key === "ArrowRight") {
                    navigatePackage('next');
                } else if (event.key === "Escape") {
                    closeZoom({ target: document.getElementById("zoomModal") });
                }
            }
        });

        // --- Fungsi Hapus Semua Data ---
        function clearAllData() {
            // 1. Kosongkan array data utama
            allPackagesData = [];
            // 2. Kosongkan Textarea
            document.getElementById('linkInput').value = '';
            // 3. Reset state tampilan
            updateDataCount();
            hideAllMessages();
        }

        // --- Perbaikan Fungsi Utama: Untuk memproses input otomatis ---
        let inputTimeout;
        function handleInput() {
            clearTimeout(inputTimeout);
            inputTimeout = setTimeout(() => {
                loadImages();
            }, 50);
        }

        // --- FUNGSI YANG DIPERBAIKI: Untuk memproses data scatter tunggal ---
        function processSingleScatterData(data) {
            if (!data) {
                return {
                    userId: '-',
                    ticketCode: '-',
                    links: [],
                    linksText: '-',
                    betValue: '-',
                    hasData: false,
                    hasImages: false,
                    isCancelled: false
                };
            }

            // Pisahkan data berdasarkan tab
            const parts = data.split(/\t/).filter(part => part.trim() !== '');

            // Ekstrak User ID (posisi ke-3 dalam format baru)
            let userId = '-';
            if (parts.length > 2) {
                userId = parts[2].trim();
            }

            // Ekstrak Kode Tiket (posisi ke-4 dalam format baru)
            let ticketCode = '-';
            if (parts.length > 3) {
                ticketCode = parts[3].trim();
            }

            // Ekstrak Link Bukti (posisi ke-5 dalam format baru)
            let imageLinks = [];
            if (parts.length > 4) {
                const linksPart = parts[4].trim();
                // Pisahkan berdasarkan koma dan hapus spasi berlebih
                imageLinks = linksPart.split(',').map(link => link.trim()).filter(link => link.length > 0);
            }

            const linksText = imageLinks.join(', ') || '-';
            const betValue = '-';

            return {
                userId: userId,
                ticketCode: ticketCode,
                links: imageLinks,
                linksText: linksText,
                betValue: betValue,
                hasData: true,
                hasImages: imageLinks.length > 0,
                isCancelled: false
            };
        }

        return {
            userId: userId,
            ticketCode: ticketCode,
            links: imageLinks,
            linksText: linksText,
            betValue: betValue,
            hasData: true,
            hasImages: hasImages,
            isCancelled: false
        };
        }

        // ===== FUNGSI LAINNYA TETAP SAMA =====
        // ===== FUNGSI SCATTER 6 KOLOM =====
        // ===== FUNGSI KALKULATOR CREDIT =====
        // ===== FUNGSI COPY TEXT =====
        // ===== FUNGSI TOAST NOTIFICATION =====
    </script>
</body>
