<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Galeri Keyboard Navigasi & Zoom Otomatis</title>
  <style>
    :root {
      --neon-blue: #00ffff;
      --secondary-neon: #00bfff;
      --dark-background: #121212;
      --card-background: #1e1e1e;
      --input-background: #2a2a2a;
      --border-color: #00bfff;
      --text-color: #e0f7fa;
      --danger-color: #ff4d4d;
      --success-color: #39ff14;
      --warning-color: #f1c40f;
      --primary-button: #00bfff;
      --primary-button-hover: #00e5ff;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--dark-background);
      color: var(--text-color);
      padding: 20px;
      margin: 0;
      line-height: 1.6;
    }

    .container,
    .scatter-section,
    .card {
      max-width: 960px;
      margin: 20px auto;
      background: var(--card-background);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.2), 0 0 10px rgba(0, 255, 255, 0.1);
      border: 1px solid var(--secondary-neon);
    }

    .scatter-section {
      padding: 20px;
      margin-bottom: 25px;
    }

    h1 {
      text-align: center;
      color: var(--neon-blue);
      margin-bottom: 25px;
      text-shadow: 0 0 8px var(--neon-blue), 0 0 15px var(--secondary-neon);
      font-size: 2.5em;
    }

    h2 {
      text-align: center;
      color: var(--secondary-neon);
      margin: 20px 0;
      text-shadow: 0 0 5px rgba(0, 191, 255, 0.7);
    }

    .judul-glow {
      text-align: center;
      color: var(--success-color);
      text-shadow: 0 0 10px var(--success-color), 0 0 20px var(--success-color);
      margin-bottom: 20px;
      font-size: 2.5em;
    }

    textarea {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid var(--secondary-neon);
      background-color: var(--input-background);
      color: var(--text-color);
      border-radius: 6px;
      resize: vertical;
      transition: box-shadow 0.3s;
    }

    textarea:focus {
      outline: none;
      box-shadow: 0 0 8px rgba(0, 191, 255, 0.8);
    }

    button,
    .btn {
      padding: 10px 18px;
      color: var(--dark-background);
      background-color: var(--primary-button);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin-right: 10px;
      box-shadow: 0 0 5px rgba(0, 191, 255, 0.5);
    }

    button:hover,
    .btn:hover {
      background-color: var(--primary-button-hover);
      box-shadow: 0 0 10px var(--primary-button-hover);
    }

    #clearDataBtn,
    .btn.danger {
      background-color: var(--danger-color);
      color: var(--text-color);
      box-shadow: 0 0 5px var(--danger-color);
    }

    #clearDataBtn:hover,
    .btn.danger:hover {
      background-color: #ff8080;
      box-shadow: 0 0 10px var(--danger-color);
    }

    .button-group {
      display: flex;
      justify-content: flex-end;
      margin: 10px 0 15px;
    }

    .card {
      margin-bottom: 30px;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    hr {
      border: 0;
      height: 1px;
      background-image: linear-gradient(to right, transparent, var(--secondary-neon), transparent);
      margin: 25px 0;
    }

    /* --- GALLERY --- */
    .gallery-container {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .combined-image-slot {
      width: 80%;
      max-width: 700px;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      border: 2px solid var(--secondary-neon);
      padding: 5px;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      background-color: var(--input-background);
      min-height: 200px;
    }

    .combined-image-slot:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px rgba(0, 191, 255, 0.8), 0 0 20px rgba(0, 191, 255, 0.4);
    }

    .combined-image-slot img {
      max-width: 33.33%;
      height: 180px;
      object-fit: contain;
      margin: 0;
      border-radius: 4px;
    }

    .combined-image-slot .caption-userid {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: var(--warning-color);
      font-size: 1.5em;
      font-weight: bold;
      background: rgba(0, 0, 0, 0.8);
      padding: 5px 10px;
      border-radius: 5px;
      display: none;
      pointer-events: none;
      z-index: 10;
    }

    .combined-image-slot:hover .caption-userid {
      display: block;
    }

    .package-info {
      text-align: center;
      margin-top: 20px;
      font-weight: bold;
      font-size: 1.1em;
      color: var(--neon-blue);
      text-shadow: 0 0 5px var(--neon-blue);
    }

    /* --- MODAL ZOOM --- */
    .modal,
    #zoomModal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
      overflow: auto;
    }

    .close-btn,
    .close {
      position: absolute;
      top: 20px;
      right: 35px;
      color: var(--danger-color);
      font-size: 45px;
      font-weight: bold;
      cursor: pointer;
      text-shadow: 0 0 10px var(--danger-color);
      z-index: 10000;
    }

    .close-btn:hover {
      color: #ff8080;
    }

    .zoomed-content-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      width: 90%;
      max-width: 1200px;
      max-height: 80vh;
      margin: 10px 0;
      overflow: hidden;
    }

    .zoomed-content-wrapper img {
      max-width: calc(33.33% - 10px);
      height: auto;
      max-height: 80vh;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 191, 255, 0.8);
      object-fit: contain;
    }

    .zoomed-userid {
      text-align: center;
      color: var(--warning-color);
      font-size: 2.2em;
      font-weight: bold;
      margin-bottom: 15px;
      text-shadow: 0 0 10px var(--warning-color);
    }

    .zoom-nav-button {
      background: transparent;
      color: var(--secondary-neon);
      border: none;
      font-size: 3em;
      padding: 0 20px;
      cursor: pointer;
      z-index: 10000;
    }

    .zoom-nav-button:hover:not(:disabled) {
      color: var(--neon-blue);
    }

    /* --- TABS --- */
    .tab-container {
      display: flex;
      margin-bottom: 25px;
      border-bottom: 2px solid var(--border-color);
    }

    .tab-button {
      padding: 12px 24px;
      background: transparent;
      border: none;
      color: var(--text-color);
      font-weight: 600;
      cursor: pointer;
    }

    .tab-button.active {
      color: var(--neon-blue);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* --- SCATTER 6 KOLOM --- */
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--border-color);
    }

    .ts-toggle-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .six-columns-result {
      margin-top: 25px;
    }

    .scatter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      margin-bottom: 20px;
    }

    .scatter-row.full-row {
      justify-content: space-between;
    }

    .column-result {
      flex: 0 0 calc(16.666% - 10px);
      max-width: calc(16.666% - 10px);
      background: var(--input-background);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.7);
    }

    @media (max-width: 1200px) {
      .column-result {
        flex: 0 0 calc(50% - 12px);
        max-width: calc(50% - 12px);
      }
    }

    @media (max-width: 768px) {
      .column-result {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }

    /* --- LIGHTBOX MODAL --- */
    #imageModal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      animation: fadeIn 0.3s;
    }

    .modal-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
      padding: 20px;
      position: relative;
    }

    .image-info {
      position: absolute;
      top: 30px;
      left: 40px;
      color: var(--neon-blue);
      font-size: 18px;
      background: rgba(0, 0, 0, 0.7);
      padding: 15px 25px;
      border-radius: 30px;
      z-index: 1001;
    }

    .images-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .modal-img {
      max-width: 800px;
      max-height: 900px;
      object-fit: contain;
      border: 3px solid var(--neon-blue);
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
    }

    .modal-navigation {
      display: flex;
      justify-content: center;
      gap: 10px;
      position: absolute;
      bottom: 30px;
      max-width: 90%;
      z-index: 1002;
      flex-wrap: wrap;
    }

    .nav-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid var(--neon-blue);
      background: rgba(10, 14, 18, 0.7);
      color: var(--neon-blue);
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .nav-btn.active,
    .nav-btn:hover {
      background: var(--neon-blue);
      color: white;
      transform: scale(1.1);
    }

    /* --- TOAST --- */
    #toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: var(--success-color);
      color: black;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      z-index: 10000;
      display: none;
      animation: toastSlideIn 0.3s, toastSlideOut 0.3s 1.7s forwards;
    }

    #toast.error {
      background: var(--danger-color);
    }

    @keyframes toastSlideIn {
      from { opacity: 0; transform: translateX(100%); }
      to { opacity: 1; transform: translateX(0); }
    }

    @keyframes toastSlideOut {
      from { opacity: 1; transform: translateX(0); }
      to { opacity: 0; transform: translateX(100%); }
    }

    /* --- CREDIT CALCULATOR (MINIMAL) --- */
    .credit-calculator-container {
      margin-top: 20px;
      padding: 20px;
      background: var(--input-background);
      border-radius: 12px;
      border: 1px solid var(--border-color);
    }

    #creditTotal {
      font-size: 1.3em;
      color: var(--neon-blue);
      text-align: center;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <!-- GALERI OTOMATIS -->
  <div class="container">
    <h1>üì∏ Gambar Otomatis</h1>
    <p style="text-align: center; color: #3498db;">**Tempel/Ketik** data. Format: **USERID link_gambar1 link_gambar2 link_gambar3**</p>
    <textarea id="linkInput" placeholder="Tempelkan data paket di sini. Setiap baris = satu paket." rows="8"></textarea>
    <div class="button-group">
      <button id="clearDataBtn">üóëÔ∏è Hapus Semua Data</button>
    </div>
    <hr />
    <div class="gallery-container">
      <div class="combined-image-slot" id="combinedImageSlot">
        <p class="caption-userid" id="combinedSlotUserid">USER ID</p>
        <img id="imgSlot1" src="https://via.placeholder.com/200x180/2c3e50/ffffff?text=Slot+1" alt="Slot 1" />
        <img id="imgSlot2" src="https://via.placeholder.com/200x180/2c3e50/ffffff?text=Slot+2" alt="Slot 2" />
        <img id="imgSlot3" src="https://via.placeholder.com/200x180/2c3e50/ffffff?text=Slot+3" alt="Slot 3" />
      </div>
    </div>
    <p class="package-info">
      Paket: <span id="currentPackageNum">0</span> / <span id="maxPackageNum">0</span>
    </p>
  </div>

  <!-- TABS -->
  <div class="card">
    <div class="tab-container">
      <button class="tab-button active" data-tab="scatter-tab">Scatter Unlimited Kolom</button>
      <button class="tab-button" data-tab="credit-tab">Kalkulator Credit PG SOFT</button>
    </div>

    <!-- TAB SCATTER -->
    <div id="scatter-tab" class="tab-content active">
      <h2>Input Data Scatter</h2>
      <div class="auto-input-container" id="autoInputContainer">
        <textarea id="autoInput" placeholder="Tempel data mentah di sini..."></textarea>
        <div class="auto-input-actions">
          <button class="auto-delete-btn" id="autoDeleteBtn">üóëÔ∏è Hapus Input</button>
        </div>
      </div>
      <div class="action-buttons">
        <button class="btn btn-clear" id="clearScatter6Btn">üóëÔ∏è Hapus Semua</button>
      </div>
      <div class="result-header">
        <h2>Hasil Format Scatter</h2>
        <div class="ts-toggle-container">
          <span>TS Mode:</span>
          <input type="checkbox" id="tsToggle" />
        </div>
      </div>
      <div class="six-columns-result" id="scatter6Results"></div>
    </div>

    <!-- TAB CREDIT -->
    <div id="credit-tab" class="tab-content">
      <h2>Kalkulator Credit PG SOFT</h2>
      <div class="credit-calculator-container">
        <textarea id="creditData" placeholder="Tempel data seamless..."></textarea>
        <button class="btn danger" id="clearCreditBtn">üóëÔ∏è Hapus</button>
        <button class="btn" id="copyCreditBtn">üìã Salin Total</button>
        <div id="creditTotal">IDR 0</div>
      </div>
    </div>
  </div>

  <!-- ZOOM MODAL -->
  <div id="zoomModal" class="modal">
    <span class="close-btn">&times;</span>
    <span id="zoomedUserid" class="zoomed-userid"></span>
    <div class="zoomed-content-wrapper" id="zoomedContentWrapper"></div>
    <button class="zoom-nav-button" id="prevZoomBtn">&#9664;</button>
    <button class="zoom-nav-button" id="nextZoomBtn">&#9654;</button>
  </div>

  <!-- LIGHTBOX MODAL -->
  <div id="imageModal" class="modal">
    <span class="close-btn">&times;</span>
    <div class="image-info" id="imageInfo">
      <div>Kolom: <span id="colInfo">1</span></div>
      <div>User ID: <span id="userIdInfo">-</span></div>
    </div>
    <div class="images-container" id="imagesContainer"></div>
    <div class="modal-navigation" id="modalNavigation"></div>
  </div>

  <!-- TOAST -->
  <div id="toast">‚úì Disalin ke clipboard</div>

  <script>
    // === GALLERY AUTOMATIS ===
    let allPackagesData = [];
    let currentPackageIndex = 0;
    let isZoomOpen = false;
    const placeholderImage = "https://via.placeholder.com/200x180/2c3e50/ffffff?text=Kosong";

    function handleInput() {
      const lines = document.getElementById('linkInput').value
        .split('\n')
        .map(line => line.trim())
        .filter(line => line);
      allPackagesData = [];
      const urlRegex = /https?:\/\/[^\s]+/g;
      lines.forEach(line => {
        const urls = line.match(urlRegex) || [];
        const words = line.split(/\s+/);
        const userid = words[0]?.startsWith('http') ? 'N/A' : words[0] || 'N/A';
        const links = urls.slice(0, 3);
        while (links.length < 3) links.push('');
        allPackagesData.push({ userid, links });
      });
      document.getElementById('maxPackageNum').textContent = allPackagesData.length;
      if (allPackagesData.length > 0) {
        currentPackageIndex = Math.min(currentPackageIndex, allPackagesData.length - 1);
        updateGallery(currentPackageIndex);
      } else {
        updateGallery(-1);
      }
    }

    function updateGallery(index) {
      const imgSlots = ['imgSlot1', 'imgSlot2', 'imgSlot3'].map(id => document.getElementById(id));
      const useridCaption = document.getElementById('combinedSlotUserid');
      const valid = index >= 0 && index < allPackagesData.length;
      const pkg = valid ? allPackagesData[index] : { userid: 'N/A', links: ['', '', ''] };
      document.getElementById('combinedImageSlot').style.pointerEvents = valid ? 'auto' : 'none';
      useridCaption.textContent = pkg.userid === 'N/A' ? 'Belum Ada Data' : `USER ID: ${pkg.userid}`;
      document.getElementById('currentPackageNum').textContent = valid ? index + 1 : 0;
      for (let i = 0; i < 3; i++) {
        const link = pkg.links[i] || '';
        if (link) {
          imgSlots[i].src = link;
          imgSlots[i].style.display = 'block';
        } else {
          imgSlots[i].src = placeholderImage;
          imgSlots[i].style.display = !valid && i === 1 ? 'block' : 'none';
        }
      }
    }

    function navigatePackage(dir) {
      if (dir === 'next' && currentPackageIndex < allPackagesData.length - 1) currentPackageIndex++;
      else if (dir === 'prev' && currentPackageIndex > 0) currentPackageIndex--;
      else return;
      updateGallery(currentPackageIndex);
      if (isZoomOpen) updateZoomDisplay();
    }

    function updateZoomDisplay() {
      const wrapper = document.getElementById('zoomedContentWrapper');
      const useridEl = document.getElementById('zoomedUserid');
      const pkg = allPackagesData[currentPackageIndex];
      wrapper.innerHTML = '';
      pkg.links.filter(l => l).forEach(link => {
        const img = document.createElement('img');
        img.src = link;
        wrapper.appendChild(img);
      });
      useridEl.textContent = pkg.userid;
    }

    function openZoom() {
      if (allPackagesData.length === 0) return;
      isZoomOpen = true;
      updateZoomDisplay();
      document.getElementById('zoomModal').style.display = 'flex';
    }

    function closeZoom(e) {
      if (e.target === document.getElementById('zoomModal') || e.target.classList.contains('close-btn')) {
        document.getElementById('zoomModal').style.display = 'none';
        isZoomOpen = false;
      }
    }

    // === TABS ===
    document.querySelectorAll('.tab-button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    // === SCATTER & CREDIT JS MINIMAL (tetap berfungsi) ===
    let scatterResults = [];
    const tsToggle = document.getElementById('tsToggle');
    const autoInput = document.getElementById('autoInput');
    const scatter6Results = document.getElementById('scatter6Results');

    autoInput.addEventListener('input', () => {
      const lines = autoInput.value.split('\n').filter(l => l.trim() && l.includes('http'));
      scatterResults = lines.map(line => {
        const tokens = line.split(/\s+/);
        let userid = 'N/A';
        const links = [];
        if (!tokens[0].startsWith('http')) userid = tokens[0];
        tokens.forEach(t => {
          if (t.startsWith('http')) links.push(t);
        });
        return { userid, links, hasImages: links.length > 0 };
      });
      renderScatter();
    });

    function renderScatter() {
      scatter6Results.innerHTML = '';
      const chunkSize = 6;
      for (let i = 0; i < scatterResults.length; i += chunkSize) {
        const row = document.createElement('div');
        row.className = i + chunkSize >= scatterResults.length && scatterResults.length % 6 !== 0 ? 'scatter-row' : 'scatter-row full-row';
        scatterResults.slice(i, i + chunkSize).forEach((res, j) => {
          const col = document.createElement('div');
          col.className = 'column-result';
          const idx = i + j + 1;
          const uid = tsToggle.checked ? `${res.userid} TS` : res.userid;
          col.innerHTML = `
            <h4>Kolom ${idx}</h4>
            <div>User ID: ${uid}</div>
            <button onclick="copyText('${uid}')">üìã</button>
            ${res.hasImages ? '<button onclick="showImagesForColumn(' + idx + ')">Lihat Gambar</button>' : ''}
            <button onclick="markDone(this)">‚úÖ Selesai</button>
            <button onclick="markCancel(this)">‚ùå Batal</button>
          `;
          row.appendChild(col);
        });
        scatter6Results.appendChild(row);
      }
    }

    function copyText(text) {
      navigator.clipboard.writeText(text).then(() => {
        document.getElementById('toast').style.display = 'block';
        setTimeout(() => document.getElementById('toast').style.display = 'none', 2000);
      });
    }

    function markDone(btn) {
      btn.closest('.column-result').style.border = '2px solid var(--success-color)';
      btn.textContent = '‚úì Selesai';
    }

    function markCancel(btn) {
      btn.closest('.column-result').style.border = '2px dashed var(--danger-color)';
      btn.textContent = 'üö´ Dibatalkan';
    }

    function showImagesForColumn(colIndex) {
      const modal = document.getElementById('imageModal');
      document.getElementById('colInfo').textContent = colIndex;
      const pkg = scatterResults[colIndex - 1];
      document.getElementById('userIdInfo').textContent = pkg?.userid || '-';
      const container = document.getElementById('imagesContainer');
      container.innerHTML = '';
      if (pkg?.links) {
        pkg.links.forEach(link => {
          const img = document.createElement('img');
          img.src = link;
          img.className = 'modal-img';
          container.appendChild(img);
        });
      }
      modal.style.display = 'flex';
    }

    document.querySelector('.close-btn').addEventListener('click', () => {
      document.getElementById('imageModal').style.display = 'none';
    });

    // === CREDIT CALCULATOR ===
    document.getElementById('creditData').addEventListener('input', () => {
      const text = document.getElementById('creditData').value;
      let total = 0;
      const lines = text.split('\n');
      for (let i = 0; i < lines.length; i++) {
        if (lines[i].trim() === 'Credit') {
          const match = lines[i + 1]?.match(/IDR\s*([\d,]+)/i);
          if (match) total += parseFloat(match[1].replace(/,/g, ''));
        }
      }
      document.getElementById('creditTotal').textContent = `IDR ${total.toLocaleString('id-ID')}`;
    });

    document.getElementById('copyCreditBtn').addEventListener('click', () => {
      const num = document.getElementById('creditTotal').textContent.replace(/IDR\s|,/g, '');
      copyText(num);
    });

    // === EVENT LISTENERS ===
    document.getElementById('linkInput').addEventListener('input', handleInput);
    document.getElementById('clearDataBtn').addEventListener('click', () => {
      document.getElementById('linkInput').value = '';
      handleInput();
    });
    document.getElementById('combinedImageSlot').addEventListener('click', openZoom);
    document.getElementById('zoomModal').addEventListener('click', closeZoom);
    document.getElementById('prevZoomBtn').addEventListener('click', () => navigatePackage('prev'));
    document.getElementById('nextZoomBtn').addEventListener('click', () => navigatePackage('next'));
    document.getElementById('clearScatter6Btn').addEventListener('click', () => {
      autoInput.value = '';
      scatter6Results.innerHTML = '';
      scatterResults = [];
    });
    document.getElementById('clearCreditBtn').addEventListener('click', () => {
      document.getElementById('creditData').value = '';
      document.getElementById('creditTotal').textContent = 'IDR 0';
    });

    // Init
    updateGallery(-1);
  </script>
</body>
</html>
