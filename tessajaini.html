<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link 
    rel="stylesheet" 
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" 
    integrity="sha512-Hy9U50u4g4i1KuGJ8+XbB7Mf6NjJ5J2VJ1e2nX3dZJ5K7v0J9yQ9vQe3uV6vJ4n1J5X7X9Q7J6Y1j3Q9v7J5J1e2nX3dZJ==" 
    crossorigin="anonymous" 
    referrerpolicy="no-referrer" 
  />
  <link 
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto:wght@400;500&display=swap" 
    rel="stylesheet"
  />
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@6.0.1/dist/tesseract.min.js"></script>
  <base target="_top" />
  <title>ðŸ’« LINE TOGEL - Aplikasi Catatan Neon</title>
  <style>
    /* ========================================
    GLOBAL RESET & VARIABEL CSS
    ======================================== */
    :root {
      --neon-blue: #00ffff;
      --neon-green: #00ff88;
      --neon-purple: #9d50ff;
      --neon-yellow: #ffcc00;
      --neon-pink: #ff00ff;
      --neon-cyan: #00ffff;
      --neon-red: #ff073a;
      --bg-dark: #001020;
      --bg-galaxy: rgba(0, 0, 50, 0.7);
      --panel-bg: rgba(0, 10, 30, 0.6);
      --panel-border: rgba(0, 229, 255, 0.4);
      --panel-shadow: rgba(0, 229, 255, 0.2);
      --text-main: #00ffff;
      --text-title: #66ffff;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      transition: background 0.8s ease-in-out, color 0.3s ease;
      background-attachment: fixed;
      background-size: cover;
      color: var(--text-main);
      min-height: 100vh;
      padding: 0;
      margin: 0;
      overflow-x: hidden;
      position: relative;
    }
    /* ========================================
    BACKGROUND GIF THEMES
    ======================================== */
    body.bg-default {
      background: linear-gradient(rgba(0, 10, 20, 0.88), rgba(0, 10, 20, 0.95)),
        url('https://wallpapercave.com/wp/wp9046775.jpg') center/cover fixed;
    }
    body.bg-deepspace {
      background: linear-gradient(rgba(0, 5, 20, 0.88), rgba(0, 10, 30, 0.95)),
        url('https://4kwallpapers.com/images/walls/thumbs_3t/19856.jpg') center/cover fixed;
    }
    body.bg-gradient {
      background: linear-gradient(rgba(0, 10, 20, 0.88), rgba(0, 10, 20, 0.95)),
        url('https://cdn.areabermain.club/assets/cdn/az6/2026/01/08/20260108/0e9b0ec9a88ad88a5935bc5802bc41a5/linetogel-background-07januari2026.jpg') center/cover fixed;
    }
    /* ========================================
    SCROLLBAR CUSTOM
    ======================================== */
    *::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    *::-webkit-scrollbar-track {
      background: rgba(0, 0, 20, 0.4);
      border-radius: 10px;
    }
    *::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, var(--neon-blue), #0044ff);
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
    }
    *::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(180deg, var(--neon-blue), #0055ff);
      box-shadow: 0 0 15px var(--neon-blue);
    }
    /* ========================================
    MAIN CONTAINER & SIDEBAR
    ======================================== */
    .main-container {
      display: flex;
      flex-direction: row;
      gap: 25px;
      padding: 20px;
      align-items: flex-start;
      justify-content: flex-start;
      flex-wrap: wrap;
      min-height: 100vh;
    }
    .sidebar-container {
      backdrop-filter: blur(20px);
      background: rgba(0, 10, 30, 0.75);
      border-radius: 22px;
      padding: 28px 22px;
      width: 100%;
      max-width: 290px;
      box-shadow: 0 0 45px rgba(0, 229, 255, 0.3);
      display: flex;
      flex-direction: column;
      gap: 22px;
      border: 1px solid rgba(0, 229, 255, 0.5);
      animation: fadeIn 0.8s ease-in;
      position: relative;
      overflow: hidden;
      height: fit-content;
      align-self: flex-start;
      top: 20px;
    }
    .sidebar-brand h2 {
      margin: 0;
      font-size: 24px;
      background: linear-gradient(90deg, #00ffff, #ff00ff, #00ffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-size: 200% 200%;
      animation: neonTitle 3s ease infinite;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
    }
    #clock {
      color: var(--neon-blue);
      text-align: center;
      margin: 15px 0 20px;
      font-weight: bold;
      font-size: 22px;
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 1.5px;
      text-shadow:
        0 0 8px var(--neon-blue),
        0 0 15px var(--neon-blue),
        0 0 25px rgba(0, 255, 255, 0.5);
      background: rgba(0, 20, 40, 0.6);
      padding: 10px;
      border-radius: 14px;
      border: 1px solid rgba(0, 229, 255, 0.6);
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.4);
      animation: pulseClock 2s infinite alternate;
    }
    .neon-button {
      background: linear-gradient(135deg, rgba(0, 229, 255, 0.2), rgba(100, 0, 255, 0.2));
      color: var(--text-main);
      border: 1px solid rgba(0, 229, 255, 0.5);
      padding: 14px 18px;
      font-size: 15px;
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.35s ease;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 14px;
      box-shadow: 0 0 12px rgba(0, 229, 255, 0.25);
      position: relative;
      overflow: hidden;
      font-weight: 500;
      letter-spacing: 0.5px;
      width: 100%;
      text-align: left;
      z-index: 2;
    }
    .neon-button::after {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 229, 255, 0.4), transparent);
      transition: 0.6s;
      z-index: -1;
    }
    .neon-button:hover::after {
      left: 100%;
    }
    .neon-button:hover {
      background: rgba(0, 229, 255, 0.3);
      transform: translateX(4px) scale(1.03);
      box-shadow:
        0 0 18px rgba(0, 229, 255, 0.8),
        0 0 30px rgba(100, 0, 255, 0.5);
      color: white;
    }
    .content-area {
      flex: 1;
      min-width: 300px;
      background: rgba(0, 15, 35, 0.65);
      backdrop-filter: blur(12px);
      padding: 28px;
      border-radius: 22px;
      color: var(--text-main);
      box-shadow:
        0 0 30px rgba(0, 229, 255, 0.3),
        0 0 50px rgba(100, 0, 255, 0.2);
      border: 1px solid rgba(0, 229, 255, 0.4);
      animation: fadeIn 0.8s ease-in;
      position: relative;
      overflow: hidden;
      min-height: calc(100vh - 40px);
    }
    .tab-content {
      display: none;
      animation: fadeIn 0.6s ease-out;
    }
    .tab-content.active {
      display: block;
    }
    .judul-glow {
      font-size: 32px;
      text-align: center;
      padding: 15px 25px;
      color: var(--neon-blue);
      text-shadow:
        0 0 10px var(--neon-blue),
        0 0 20px var(--neon-blue),
        0 0 35px rgba(0, 255, 255, 0.7);
      border: 2px solid rgba(0, 229, 255, 0.5);
      border-radius: 18px;
      background: rgba(0, 20, 45, 0.6);
      backdrop-filter: blur(10px);
      margin-bottom: 25px;
      position: relative;
      overflow: hidden;
      letter-spacing: 1.5px;
      font-family: 'Orbitron', sans-serif;
      font-weight: 800;
    }
    /* ========================================
    NOTE CARD STYLES â€” SESUAI PREFERENSI ANDA: LEBIH KECIL & JELAS
    ======================================== */
    .note-card {
      background: linear-gradient(145deg, rgba(0, 15, 40, 0.7), rgba(0, 25, 60, 0.85));
      padding: 22px;
      max-width: 800px;
      width: 95%;
      margin: 0 auto 22px;
      color: var(--text-main);
      border-radius: 18px;
      box-shadow:
        0 0 12px rgba(0, 229, 255, 0.4),
        0 0 25px rgba(0, 229, 255, 0.25);
      backdrop-filter: blur(10px) saturate(160%);
      word-break: break-word;
      font-weight: 500;
      transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(0, 229, 255, 0.4);
    }
    .note-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(
        to bottom,
        var(--neon-blue),
        var(--neon-purple),
        var(--neon-blue)
      );
      box-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-purple);
      border-radius: 0 10px 10px 0;
      animation: pulseGlow 2s infinite alternate;
    }
    .note-card:hover {
      transform: translateY(-5px) scale(1.015);
      box-shadow:
        0 0 20px rgba(0, 255, 255, 0.8),
        0 0 40px rgba(0, 229, 255, 0.4);
      background: linear-gradient(
        145deg,
        rgba(0, 20, 50, 0.95),
        rgba(0, 35, 80, 0.98)
      );
      cursor: pointer;
    }
    .note-title {
      font-size: 20px;
      font-weight: 800;
      color: var(--text-main);
      text-shadow:
        0 0 8px var(--neon-blue),
        0 0 16px rgba(0, 255, 255, 0.7),
        0 0 24px rgba(0, 229, 255, 0.5);
      margin: 0 0 16px 0;
      letter-spacing: 1px;
      text-align: center;
      padding-bottom: 10px;
      border-bottom: 2px solid rgba(0, 229, 255, 0.3);
    }
    .copy-button, .sticky-add-button {
      background: linear-gradient(145deg, rgba(0, 229, 255, 0.3), rgba(0, 100, 255, 0.3));
      color: var(--neon-blue);
      border: 1px solid rgba(0, 229, 255, 0.65);
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 700;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin: 4px 4px;
      box-shadow:
        0 0 8px rgba(0, 229, 255, 0.4),
        inset 0 0 6px rgba(0, 229, 255, 0.3);
      text-shadow: 0 0 3px rgba(0, 255, 255, 0.8);
    }
    .copy-button:hover, .sticky-add-button:hover {
      background: linear-gradient(145deg, rgba(0, 255, 255, 0.5), rgba(0, 150, 255, 0.5));
      transform: translateY(-2px) scale(1.05);
      box-shadow:
        0 0 16px rgba(0, 255, 255, 0.8),
        inset 0 0 10px rgba(0, 255, 255, 0.5);
    }
    /* ========================================
    FOTO GALLERY
    ======================================== */
    .foto-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 20px;
      padding: 10px;
    }
    .foto-card {
      background: rgba(0, 15, 35, 0.75);
      border-radius: 16px;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(0, 229, 255, 0.2);
      transition: all 0.35s ease;
      border: 1px solid rgba(0, 229, 255, 0.3);
      position: relative;
      display: flex;
      flex-direction: column;
    }
    .foto-card:hover {
      transform: translateY(-6px) scale(1.02);
      box-shadow: 0 10px 25px rgba(0, 255, 255, 0.3);
      border-color: var(--neon-blue);
    }
    .foto-card img {
      width: 100%;
      height: 220px;
      object-fit: contain;
      object-position: center;
      display: block;
      background-color: #000;
      transition: transform 0.4s ease;
      border-bottom: 1px solid rgba(0, 229, 255, 0.3);
    }
    .foto-card:hover img {
      transform: scale(1.04);
    }
    .foto-title {
      padding: 10px;
      text-align: center;
      font-weight: 700;
      font-size: 15px;
      color: var(--neon-blue);
      text-shadow: 0 0 5px var(--neon-blue), 0 0 10px rgba(0, 255, 255, 0.7);
      background: rgba(0, 10, 30, 0.7);
      border-top: 1px solid rgba(0, 229, 255, 0.3);
    }
    /* ========================================
    SEARCH & INPUT STYLES
    ======================================== */
    .search-bar {
      margin: 20px 0 25px;
      text-align: center;
    }
    #searchInput, .pasaran-search, .input-tanggal {
      width: 100%;
      max-width: 500px;
      padding: 12px 18px;
      margin: 0 auto;
      background: rgba(0, 20, 45, 0.75);
      border: 2px solid rgba(0, 229, 255, 0.6);
      border-radius: 14px;
      color: var(--neon-blue);
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 0 12px rgba(0, 229, 255, 0.4);
      transition: all 0.3s ease;
      font-family: 'Orbitron', sans-serif;
    }
    #searchInput:focus, .pasaran-search:focus, .input-tanggal:focus {
      outline: none;
      border-color: var(--neon-blue);
      box-shadow: 0 0 18px rgba(0, 255, 255, 0.7), 0 0 30px rgba(0, 229, 255, 0.5);
      background: rgba(0, 25, 55, 0.85);
    }
    /* ========================================
    TOAST NOTIFICATION â€” SESUAI PREFERENSI: LEBIH KECIL
    ======================================== */
    #toastNotif {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 9999;
      background: rgba(0, 255, 255, 0.92);
      color: #000;
      padding: 8px 14px;
      border-radius: 8px;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
      display: none;
      animation: toastSlideIn 0.4s ease-out, toastSlideOut 0.4s ease-in 2.6s;
      letter-spacing: 0.5px;
      border: 2px solid #000;
    }
    @keyframes toastSlideIn {
      from { transform: translateX(200px) scale(0.8); opacity: 0; }
      to { transform: translateX(0) scale(1); opacity: 1; }
    }
    @keyframes toastSlideOut {
      from { transform: translateX(0) scale(1); opacity: 1; }
      to { transform: translateX(200px) scale(0.8); opacity: 0; }
    }
    /* ========================================
    LIGHTBOX MODAL â€” DENGAN OVERLAY CLICK UNTUK TUTUP
    ======================================== */
    #lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 15, 0.96);
      z-index: 10000;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }
    #lightboxImg {
      max-width: 90%;
      max-height: 80vh;
      border-radius: 16px;
      box-shadow: 0 0 40px var(--neon-blue), 0 0 60px rgba(0, 255, 255, 0.7);
      transition: transform 0.4s ease;
      cursor: grab;
    }
    #lightboxImg:active {
      cursor: grabbing;
    }
    .lightbox-controls {
      margin-top: 20px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .nav-button, .action-button {
      background: rgba(0, 20, 45, 0.85);
      color: var(--neon-blue);
      border: 2px solid rgba(0, 229, 255, 0.7);
      padding: 8px 18px;
      border-radius: 12px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 15px;
      min-width: 110px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      box-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
    }
    .nav-button:hover, .action-button:hover {
      background: rgba(0, 30, 60, 0.95);
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 0 16px rgba(0, 255, 255, 0.8), 0 0 25px rgba(0, 229, 255, 0.6);
    }
    .zoom-slider-container {
      width: 280px;
      margin-top: 16px;
      background: rgba(0, 20, 45, 0.7);
      padding: 10px;
      border-radius: 12px;
      border: 1px solid rgba(0, 229, 255, 0.5);
      box-shadow: 0 0 12px rgba(0, 229, 255, 0.3);
    }
    #zoomSlider {
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: rgba(0, 40, 80, 0.8);
      outline: none;
      transition: all 0.3s ease;
    }
    #zoomSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--neon-blue);
      cursor: pointer;
      box-shadow: 0 0 12px var(--neon-blue);
    }
    /* ========================================
    CUSTOM SELECT DROPDOWN
    ======================================== */
    .custom-select {
      position: relative;
      display: block;
      width: 100%;
      max-width: 600px;
      margin: 15px auto 20px;
    }
    .custom-select select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 100%;
      padding: 12px 50px 12px 20px;
      font-size: 16px;
      font-weight: bold;
      color: var(--neon-blue);
      background: rgba(0, 20, 45, 0.82);
      border: 2px solid rgba(0, 229, 255, 0.65);
      border-radius: 14px;
      outline: none;
      cursor: pointer;
      transition: all 0.35s ease;
      box-shadow: 0 0 12px rgba(0, 229, 255, 0.45);
      backdrop-filter: blur(8px);
      font-family: 'Orbitron', sans-serif;
      text-align: center;
    }
    .custom-select::after {
      content: "â–¼";
      position: absolute;
      top: 50%;
      right: 16px;
      transform: translateY(-50%);
      color: var(--neon-blue);
      font-size: 16px;
      pointer-events: none;
      text-shadow: 0 0 6px var(--neon-blue);
      font-weight: bold;
    }
    .custom-select select:hover {
      background: rgba(0, 30, 60, 0.9);
      border-color: var(--neon-blue);
      box-shadow: 0 0 18px rgba(0, 255, 255, 0.7);
      transform: translateY(-2px);
    }
    .custom-select select:focus {
      border-color: var(--neon-blue);
      box-shadow: 0 0 22px rgba(0, 255, 255, 0.8), 0 0 35px rgba(0, 229, 255, 0.6);
      background: rgba(0, 35, 70, 0.92);
      animation: neonPulseSelect 1.8s infinite alternate;
    }
    @keyframes neonPulseSelect {
      0%, 100% { box-shadow: 0 0 12px rgba(0, 229, 255, 0.6), 0 0 20px rgba(0, 255, 255, 0.4); }
      50% { box-shadow: 0 0 20px rgba(0, 229, 255, 0.8), 0 0 35px rgba(0, 255, 255, 0.7); }
    }
    /* ========================================
    DEPO vs WD â€” SESUAI FOTO CONTOH
    ======================================== */
    .user-card-compact {
      background: rgba(0, 10, 30, 0.9);
      border: 2px solid var(--neon-blue);
      border-radius: 12px;
      margin-bottom: 20px;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      position: relative;
    }
    .depo-withdraw-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 14px 18px;
    }
    .depo-col, .with-col {
      background: rgba(0, 5, 20, 0.7);
      border: 1px solid rgba(0, 200, 255, 0.3);
      border-radius: 10px;
      padding: 14px;
      text-align: center;
    }
    .depo-col h3, .with-col h3 {
      font-size: 14px;
      margin: 0 0 10px 0;
      color: var(--neon-blue);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }
    .depo-col h3::before { content: "ðŸ“¥"; font-size: 16px; }
    .with-col h3::before { content: "ðŸ“¤"; font-size: 16px; }
    .amount-value {
      font-size: 18px;
      font-weight: bold;
      color: var(--neon-blue);
      font-family: 'Consolas', monospace;
      margin: 8px 0;
      text-shadow: 0 0 6px rgba(0, 255, 255, 0.7);
    }
    .status-badge {
      display: block;
      margin: 16px auto 0;
      padding: 8px 20px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.5);
      text-align: center;
    }
    .status-cocok { background: rgba(0, 150, 0, 0.2); color: var(--neon-green); border: 1px solid var(--neon-green); }
    .status-lebih { background: rgba(255, 200, 0, 0.2); color: var(--neon-yellow); border: 1px solid var(--neon-yellow); }
    .status-kurang { background: rgba(255, 100, 100, 0.2); color: var(--neon-red); border: 1px solid var(--neon-red); }
    .diff-value {
      font-size: 20px;
      font-weight: bold;
      color: currentColor;
      font-family: 'Orbitron', sans-serif;
      margin-top: 6px;
    }
    /* ========================================
    ANIMATIONS
    ======================================== */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes pulseClock {
      0%, 100% { box-shadow: 0 0 10px rgba(0, 229, 255, 0.5), 0 0 20px rgba(0, 255, 255, 0.3); }
      50% { box-shadow: 0 0 16px rgba(0, 229, 255, 0.8), 0 0 28px rgba(0, 255, 255, 0.6); }
    }
    @keyframes pulseGlow {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }
    @keyframes neonTitle {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    /* ========================================
    RESPONSIVE DESIGN
    ======================================== */
    @media (max-width: 900px) {
      .main-container {
        flex-direction: column;
        padding: 15px;
      }
      .sidebar-container {
        max-width: 100%;
        width: 100%;
        border-radius: 20px;
        padding: 20px 16px;
      }
      .content-area {
        min-height: auto;
        padding: 20px;
        border-radius: 20px;
      }
      .foto-gallery {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      }
    }
    @media (max-width: 480px) {
      .neon-button {
        padding: 10px 12px;
        font-size: 13px;
        gap: 8px;
      }
      .judul-glow {
        font-size: 24px;
        padding: 10px 16px;
      }
      .note-card {
        padding: 18px 16px;
        width: 98%;
      }
      .lightbox-controls {
        flex-direction: column;
        align-items: center;
      }
      .nav-button, .action-button {
        width: 100%;
        max-width: 220px;
      }
    }

    /* ========================================
    STICKY NOTES FAB & PANEL
    ======================================== */
    #stickyFab {
      position: fixed;
      bottom: 20px;
      right: 20px;
      font-size: 15px;
      font-weight: bold;
      background: #00ffff;
      color: #000;
      border-radius: 50%;
      padding: 16px;
      cursor: pointer;
      z-index: 1000;
      box-shadow:
        0 0 10px #00ffff,
        0 0 20px #00ffff,
        0 0 30px #00ffff;
      transition: all 0.3s ease;
      animation: pulseNeon 2.5s infinite ease-in-out;
    }
    #stickyFab:hover {
      transform: scale(1.1);
      background: #66ffff;
      box-shadow:
        0 0 15px #00ffff,
        0 0 30px #00ffff,
        0 0 45px #00ffff;
    }
    #stickyPanel {
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 650px;
      max-width: 90vw;
      min-width: 400px;
      min-height: 150px;
      background: rgba(0, 0, 50, 0.6);
      border: 2px solid #00ffff;
      border-radius: 12px;
      padding: 16px;
      display: none;
      z-index: 999;
      max-height: 90vh;
      overflow: auto;
      resize: both;
      animation: fadeInPanel 0.4s ease-in;
    }
    #stickyInput {
      white-space: pre-wrap;
      width: 100%;
      min-height: 50px;
      background: transparent;
      color: #00ffff;
      border: 1px solid #00ffff;
      border-radius: 8px;
      padding: 6px;
      resize: none;
      overflow: hidden;
      margin-bottom: 10px;
      font-family: inherit;
      font-size: 14px;
      font-weight: bold;
    }
    #stickyPanel button {
      width: 30%;
      background: #00ffff;
      color: #000000;
      border: none;
      padding: 6px;
      border-radius: 6px;
      margin-bottom: 10px;
      cursor: pointer;
      font-weight: bold;
    }
    #stickyList div {
      white-space: pre-wrap;
      background: rgba(0, 10, 40, 0.9);
      border: 1px solid #00ffff;
      color: #00ffff;
      border-radius: 6px;
      padding: 8px 12px;
      margin-bottom: 8px;
      position: relative;
      word-wrap: break-word;
      font-size: 14px;
      font-weight: bold;
      line-height: 1.4;
      cursor: pointer;
    }
    .sticky-add-button {
      background-color: #00ffff;
      color: #000;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin: 10px 0;
      transition: background-color 0.3s ease;
    }
    .sticky-add-button:hover {
      background-color: #00FFFF;
    }
    .sticky-delete {
      position: absolute;
      top: 4px;
      right: 8px;
      color: red;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
    }
    .sticky-edit {
      position: absolute;
      top: 4px;
      right: 30px;
      color: #00ff00;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
    }
    #stickyList img {
      display: block;
      margin: 6px auto;
      width: auto;
      max-width: 40%;
      max-height: 120px;
      height: auto;
      object-fit: contain;
      border-radius: 6px;
    }
    @keyframes pulseNeon {
      0%, 100% {
        box-shadow:
          0 0 10px #00ffff,
          0 0 20px #00ffff,
          0 0 30px #00ffff;
      }
      50% {
        box-shadow:
          0 0 20px #00ffff,
          0 0 35px #00ffff,
          0 0 50px #00ffff;
      }
    }

    /* ========================================
    BONUS EVENT STYLES
    ======================================== */
    .bonus-section {
      background: var(--bg-galaxy-section);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 0 25px var(--shadow-glow);
      max-width: 1200px;
      margin: 50px auto;
      border: 1px solid rgba(0, 255, 255, 0.2);
      backdrop-filter: blur(10px);
    }
    .bonus-title {
      font-family: 'Orbitron', sans-serif;
      color: var(--txt-main);
      font-size: 22px;
      text-align: center;
      text-shadow: 0 0 6px #00ffffaa;
      margin-bottom: 20px;
      font-weight: bold;
    }
    .bonus-input-group {
      display: flex;
      flex-direction: column;
      margin-bottom: 12px;
    }
    .bonus-label {
      color: var(--txt-main);
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 4px;
      text-shadow: 0 0 4px #00bcd4aa;
    }
    .bonus-input {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #00bcd4;
      background-color: var(--bg-input-dark);
      color: #e0ffff;
      font-weight: bold;
      font-size: 13px;
      box-shadow: inset 0 0 5px #00ffff55;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .bonus-button-group,
    .freespin-button-group,
    .action-buttons-group {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 18px;
      flex-wrap: wrap;
    }
    .bonus-btn,
    .freespin-btn,
    .btn-action,
    .btn-copy-large,
    .btn-copy-small,
    .btn-save,
    .btn-edit,
    .btn-cancel {
      padding: 10px 18px;
      border-radius: 8px;
      background-color: var(--txt-main);
      color: #000000;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: all 0.25s ease;
      font-size: 13px;
      box-shadow: 0 0 10px #00ffff88;
      padding: 8px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      background-color: #0e0e0e;
      color: #00ffff;
      border: 1px solid rgba(0, 255, 255, 0.6);
      box-shadow: 0 0 6px rgba(0, 255, 255, 0.4);
      position: relative;
      overflow: hidden;
    }
    .bonus-btn:hover,
    .freespin-btn:hover,
    .btn-action:hover,
    .btn-copy-large:hover,
    .btn-copy-small:hover,
    .btn-save:hover,
    .btn-edit:hover,
    .btn-cancel:hover {
      background-color: #00cccc;
      transform: scale(1.05);
      color: #001111;
      background-color: #00ffff;
      box-shadow: 0 0 16px rgba(0, 255, 255, 0.9), 0 2px 8px rgba(0, 100, 255, 0.5);
      transform: translateY(-2px);
    }
    .bonus-btn.danger,
    .freespin-btn.danger,
    .btn-action.btn-cancel {
      background-color: #ff4444;
      color: #000000;
      box-shadow: 0 0 10px #ff4444aa;
    }
    .bonus-btn.danger:hover,
    .freespin-btn.danger:hover,
    .btn-action.btn-cancel:hover {
      background-color: #cc0000;
    }
    .bonus-result {
      margin-top: 20px;
      padding: 18px;
      border-radius: 14px;
      background: radial-gradient(circle at top left, rgba(0, 255, 255, 0.1), rgba(0, 20, 40, 0.9));
      border: 2px solid var(--txt-main);
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.3),
        inset 0 0 10px rgba(0, 255, 255, 0.1);
      font-family: 'Courier New', monospace;
      color: #66ffff;
      font-size: 15px;
      font-weight: 600;
      white-space: pre-wrap;
      word-break: break-word;
      text-shadow: 0 0 4px #00bcd4aa;
    }
    .bonus-angka {
      font-size: 22px;
      font-weight: 900;
      color: var(--txt-highlight);
      text-shadow: 0 0 8px #00ffffcc, 0 0 20px #00ffff88;
      display: inline-block;
      margin-left: 6px;
      transition: color 0.3s ease;
    }

    /* ========================================
    REPORT LINE STYLES
    ======================================== */
    .report-card {
      border-radius: 12px;
      margin-bottom: 15px;
      overflow: hidden;
      border: 1px solid transparent;
      background: linear-gradient(145deg, #0a0a0a, #141414);
      position: relative;
      box-shadow: 0 0 8px rgba(0, 255, 255, 0.2);
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }
    .report-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 12px;
      padding: 1px;
      background: linear-gradient(45deg, #00ffff, #0077ff, #00ffff);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: destination-out;
      mask-composite: exclude;
      pointer-events: none;
      z-index: 1;
    }
    .report-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 150, 255, 0.5), 0 0 12px rgba(0, 255, 255, 0.6);
    }
    .card-accordion-title {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding: 15px 20px;
      margin: 0;
      font-size: 1.1em;
      font-weight: 600;
      color: #00ffff;
      cursor: pointer;
      background: #1a1a1a;
      border-bottom: 1px solid transparent;
      transition: all 0.2s ease;
      position: relative;
      z-index: 2;
    }
    .card-accordion-title:hover {
      background: #222;
      border-bottom-color: rgba(0, 255, 255, 0.5);
      color: #70ffff;
    }
    .card-content-panel {
      padding: 20px;
      background-color: #161616;
      border-top: none;
    }
    .report-field-group {
      margin-bottom: 15px;
      padding: 10px;
      border-radius: 8px;
      background-color: #141414;
      position: relative;
      overflow: hidden;
      transition: box-shadow 0.3s ease;
    }
    .report-field-group::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(to right, transparent, #00ffff, transparent);
      opacity: 0.6;
    }
    .report-field-group label {
      display: block;
      margin-bottom: 5px;
      font-size: 0.9em;
      font-weight: 400;
      color: #40f0ff;
    }
    .report-display-value {
      white-space: pre-wrap;
      word-break: break-word;
      min-height: 25px;
      padding: 8px 10px;
      background-color: #1a1a1a;
      border-radius: 5px;
      color: #00ffff;
      font-weight: bold;
      font-size: 0.95em;
      border: 1px solid rgba(0, 255, 255, 0.3);
      box-shadow: inset 0 0 4px rgba(0, 100, 150, 0.3);
    }
    .report-display-value.small-field {
      min-height: 15px;
      padding: 6px 10px;
      font-size: 0.9em;
    }
    .report-edit-input {
      width: 100%;
      box-sizing: border-box;
      padding: 10px;
      background-color: #1a1a1a;
      color: #00ffff;
      border: 1px solid rgba(0, 255, 255, 0.4);
      border-radius: 5px;
      resize: vertical;
      min-height: 50px;
      font-family: inherit;
      transition: all 0.3s ease;
    }
    .report-edit-input:focus {
      outline: none;
      border-color: #00ffff;
      box-shadow: 0 0 8px rgba(0, 255, 255, 0.6), inset 0 0 4px rgba(0, 100, 200, 0.4);
      background-color: #1e1e1e;
    }
    .report-edit-input.small-field {
      min-height: 35px;
      font-size: 0.9em;
      padding: 8px;
    }
    .neon-divider {
      border: none;
      height: 1px;
      background: linear-gradient(to right, transparent, #00ffff, transparent);
      box-shadow: 0 0 6px rgba(0, 255, 255, 0.5);
      margin: 20px 0;
    }

    /* ========================================
    CHAT AI STYLES
    ======================================== */
    #chatHistory {
      height: 75vh;
      overflow-y: auto;
      padding: 15px;
      background: rgba(0, 5, 15, 0.9);
      border: 1px solid #00ffff33;
      border-radius: 15px;
      margin-bottom: 15px;
      display: flex;
      flex-direction: column;
      scrollbar-width: thin;
      scrollbar-color: #00ffff #000a1e;
    }
    .message {
      margin-bottom: 20px;
      display: flex;
      flex-direction: column;
      animation: fadeIn 0.3s ease;
    }
    .user-message {
      align-items: flex-end;
    }
    .ai-message {
      align-items: flex-start;
    }
    .message-bubble {
      max-width: 70%;
      padding: 12px 18px;
      border-radius: 15px;
      font-weight: 500;
      line-height: 1.5;
      white-space: pre-wrap;
      word-wrap: break-word;
      position: relative;
      font-family: 'Segoe UI', Roboto, sans-serif;
      font-size: 15px;
      font-weight: bold;
    }
    .user-message .message-bubble {
      background: rgba(0, 74, 124, 0.4);
      color: #00ffff;
      border: 1px solid #00ffff;
      border-bottom-right-radius: 2px;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
    }
    .ai-message .message-bubble {
      background: rgba(0, 20, 40, 0.9);
      color: #00ffff;
      border: 1px solid #00ffff;
      border-bottom-left-radius: 2px;
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.2);
    }
    .typing-indicator {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      background: rgba(0, 30, 60, 0.8);
      border-radius: 18px;
      border-bottom-left-radius: 5px;
      max-width: 100px;
    }
    .typing-indicator span {
      height: 8px; width: 8px; background: #00ffff;
      border-radius: 50%; display: inline-block; margin: 0 2px;
      animation: typing 1.4s infinite;
    }
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
      30% { transform: translateY(-10px); opacity: 1; }
    }

    /* ========================================
    NEON TOGGLE SWITCH
    ======================================== */
    .neon-toggle {
      position: relative;
      display: inline-block;
      width: 56px;
      height: 28px;
    }
    .neon-toggle input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .neon-toggle-switch {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0;
      right: 0; bottom: 0;
      background-color: #222;
      border: 1px solid #444;
      transition: .4s;
      border-radius: 14px;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.8);
    }
    .neon-toggle-knob {
      position: absolute;
      height: 22px;
      width: 22px;
      left: 2px;
      bottom: 3px;
      background-color: #444;
      border-radius: 50%;
      transition: .4s;
      box-shadow: 0 0 4px rgba(0,0,0,0.8);
    }
    .neon-toggle input:checked + .neon-toggle-switch {
      background: linear-gradient(135deg, #00bfff, #0077ff);
      border-color: #00ffff;
      box-shadow: 0 0 12px rgba(0,255,255,0.6);
    }
    .neon-toggle input:checked + .neon-toggle-switch .neon-toggle-knob {
      background: #00ffff;
      transform: translateX(28px);
      box-shadow: 0 0 8px #00ffff, 0 0 16px rgba(0,255,255,0.5);
    }

    /* ========================================
    TRY CARI & DEPO-WD ANALYZER
    ======================================== */
    .input-section {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      background: #0d1b2a;
      border-radius: 12px;
      border: 1px solid #0288d1;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }
    .input-section h2 {
      color: #4fc3f7;
      text-align: center;
      margin-bottom: 20px;
      font-size: 22px;
      font-weight: bold;
      padding-bottom: 10px;
      border-bottom: 1px solid #1e3a5f;
    }
    .input-group label {
      display: block;
      color: #81d4fa;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 14px;
    }
    .input-group textarea {
      width: 100%;
      min-height: 150px;
      padding: 14px;
      border: 1px solid #1e3a5f;
      border-radius: 8px;
      background: #0a1929;
      color: #e0f7fa;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      font-weight: bold;
      resize: vertical;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .input-group textarea:focus {
      outline: none;
      border-color: #0288d1;
      box-shadow: 0 0 0 2px rgba(2, 136, 209, 0.3);
    }
    #btnCocokkan {
      width: 100%;
      padding: 14px 20px;
      background: linear-gradient(135deg, #0288d1, #01579b);
      color: white;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
      margin-top: 10px;
    }
    #btnCocokkan:hover {
      background: linear-gradient(135deg, #029ed1, #0168b3);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.5);
    }
    #btnCocokkan:active {
      transform: translateY(0);
    }
    .btn-clear {
      margin-top: 8px;
      padding: 6px 12px;
      background: #b71c1c;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 13px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn-clear:hover {
      background: #d32f2f;
    }
    .neon-switch-btn {
      background: rgba(0, 255, 255, 0.2);
      color: #ffffff;
      border: 1px solid #00ffff;
      border-radius: 8px;
      padding: 10px 20px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.6);
      backdrop-filter: blur(2px);
      -webkit-backdrop-filter: blur(2px);
      font-size: 14px;
    }
    .neon-switch-btn:hover {
      background: rgba(0, 255, 255, 0.35);
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.9);
      transform: scale(1.05);
    }
    .neon-switch-btn:active {
      transform: scale(0.98);
    }
    .neon-switch-btn.active {
      background: rgba(0, 255, 255, 0.4);
      box-shadow: 0 0 20px rgba(0, 255, 255, 1);
      color: #000;
    }
    .depo-wd-container {
      max-width: 1200px;
      margin: 20px auto;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .depo-wd-title {
      text-align: center;
      color: #4fc3f7;
      margin-bottom: 20px;
      font-size: 24px;
      font-weight: 600;
    }
    .summary-box {
      background: #0f2a4d;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 25px;
      color: #bbdefb;
      font-size: 14px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    .user-card {
      background: rgba(0, 12, 30, 0.9);
      border-radius: 12px;
      margin-bottom: 20px;
      overflow: hidden;
      box-shadow: 0 6px 12px rgba(0,0,0,0.4);
      border-left: 5px solid;
      background: rgba(0, 12, 30, 0.9);
      border-radius: 14px;
      margin-bottom: 20px;
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.25);
      border: 2px solid var(--neon-blue);
      position: relative;
      min-width: 320px;
      overflow: visible;
      transition: transform 0.3s ease;
      background: rgba(0, 10, 30, 0.9);
      border: 2px solid var(--neon-blue);
      border-radius: 12px;
      margin-bottom: 20px;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      position: relative;
    }
    .user-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 30px rgba(0, 255, 255, 0.4);
    }
    .user-card::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; height: 4px;
      background: linear-gradient(90deg, transparent, var(--neon-blue), transparent);
    }
    .user-header {
      padding: 14px 20px;
      font-weight: bold;
      font-size: 16px;
      color: white;
    }
    .user-header-compact {
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      color: var(--neon-blue);
      background: rgba(0, 20, 50, 0.7);
      text-align: center;
      letter-spacing: 1px;
    }
    .user-body {
      display: flex;
      flex-wrap: wrap;
      padding: 16px;
      gap: 20px;
    }
    .col {
      flex: 1;
      min-width: 250px;
      display: flex;
      flex-direction: column;
      min-width: 260px;
      min-width: 100%;
    }
    .col-title {
      font-size: 14px;
      color: #4fc3f7;
      margin-bottom: 8px;
      font-weight: 600;
      padding-bottom: 4px;
      border-bottom: 1px solid #3498db;
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      margin-bottom: 12px;
      padding-bottom: 6px;
      border-bottom: 2px solid var(--neon-blue);
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 14px;
      margin-bottom: 8px;
      font-weight: 600;
      padding-bottom: 4px;
      border-bottom: 1px solid #3498db;
    }
    .entry-list {
      list-style: none;
      padding: 0;
      margin: 0;
      flex: 1;
      max-height: 180px;
      overflow-y: auto;
      max-height: 140px;
      overflow-y: auto;
      font-size: 13px;
      padding-right: 8px;
    }
    .entry-list::-webkit-scrollbar {
      width: 6px;
    }
    .entry-list::-webkit-scrollbar-track {
      background: #0d1b2a;
      border-radius: 3px;
    }
    .entry-list::-webkit-scrollbar-thumb {
      background: #4fc3f7;
      border-radius: 3px;
      background: var(--neon-blue);
      border-radius: 3px;
    }
    .entry-list::-webkit-scrollbar-thumb:hover {
      background: #29b6f6;
    }
    .entry-item {
      background: #1e3a5f;
      padding: 8px 12px;
      margin-bottom: 6px;
      border-radius: 6px;
      font-family: monospace;
      color: #bbdefb;
      font-size: 13px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      background: rgba(0, 25, 50, 0.6);
      padding: 10px 14px;
      margin-bottom: 8px;
      border-radius: 8px;
      border: 1px solid rgba(0, 180, 255, 0.3);
      font-family: 'Consolas', monospace;
      color: var(--text-main);
      transition: all 0.2s;
    }
    .entry-item:hover {
      background: rgba(0, 40, 80, 0.7);
      border-color: var(--neon-blue);
    }
    .entry-item.empty {
      color: #666;
      font-style: italic;
      text-align: center;
      font-size: 11px;
    }
    .total-row {
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px dashed #3498db;
      font-weight: bold;
      font-family: monospace;
      color: white;
      flex-shrink: 0;
      display: flex;
      justify-content: space-between;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 2px dashed var(--neon-blue);
      font-weight: bold;
      font-family: 'Consolas', monospace;
      color: var(--neon-yellow);
      font-size: 15px;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px dashed rgba(0, 200, 255, 0.4);
      font-weight: bold;
      font-family: 'Consolas', monospace;
      color: var(--neon-yellow);
      font-size: 16px;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px dashed rgba(0, 200, 255, 0.4);
      font-weight: bold;
      font-family: 'Consolas', monospace;
      color: var(--neon-yellow);
      font-size: 16px;
    }
    .total-label {
      font-size: 13px;
      color: var(--neon-blue);
      font-size: 13px;
      color: var(--neon-blue);
    }
    .total-value {
      font-family: 'Consolas', monospace;
      font-size: 15px;
      font-family: 'Consolas', monospace;
      font-size: 15px;
    }
    .status-badge {
      display: inline-block;
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: bold;
      margin-top: 12px;
      font-size: 13px;
      display: block;
      margin: 20px auto;
      padding: 12px 24px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 18px;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
      display: inline-block;
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: bold;
      margin-top: 12px;
      font-size: 13px;
    }
    .status-cocok {
      background: rgba(0, 150, 0, 0.2);
      color: var(--neon-green);
      border: 1px solid var(--neon-green);
    }
    .status-lebih {
      background: rgba(255, 200, 0, 0.2);
      color: var(--neon-yellow);
      border: 1px solid var(--neon-yellow);
    }
    .status-kurang {
      background: rgba(255, 100, 100, 0.2);
      color: var(--neon-red);
      border: 1px solid var(--neon-red);
    }
    .diff-cocok { color: #66bb6a; }
    .diff-lebih { color: #ff8f00; }
    .diff-kurang { color: #ef5350; }

    /* ========================================
    COMMON PANEL STYLES
    ======================================== */
    .common-panel,
    .input-section {
      max-width: 1200px;
      margin: 0 auto 24px;
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 20px var(--panel-shadow);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: visible;
    }
    .common-panel::before {
      content: "";
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: 14px;
      background: linear-gradient(45deg, transparent, var(--neon-blue), transparent);
      z-index: -1;
      opacity: 0.3;
    }
    .section {
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 0 12px var(--panel-shadow);
    }
    .bank-card {
      background: rgba(0, 12, 30, 0.9);
      border-radius: 14px;
      margin-bottom: 20px;
      box-shadow: 0 8px 24px rgba(0, 255, 255, 0.25);
      border: 2px solid var(--neon-blue);
      position: relative;
      min-width: 320px;
      overflow: visible;
      transition: transform 0.3s ease;
    }
    .bank-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 30px rgba(0, 255, 255, 0.4);
    }
    .neon-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px 20px;
      border: 2px solid var(--neon-blue);
      background: transparent;
      color: var(--neon-blue);
      border-radius: 14px;
      font-weight: bold;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      text-shadow: 0 0 8px rgba(0, 255, 255, 0.9);
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.5);
      min-height: 42px;
      position: relative;
      overflow: hidden;
    }
    .neon-btn::after {
      content: "";
      position: absolute;
      top: -50%;
      left: -60%;
      width: 20px;
      height: 200%;
      background: rgba(0, 255, 255, 0.4);
      transform: rotate(25deg);
      transition: all 0.6s;
    }
    .neon-btn:hover {
      background: rgba(0, 255, 255, 0.15);
      box-shadow: 0 0 24px rgba(0, 255, 255, 0.9);
      transform: translateY(-3px) scale(1.02);
    }
    .neon-btn:hover::after {
      left: 120%;
    }
    .buttons {
      display: flex;
      gap: 14px;
      margin-top: 16px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .selisih-besar {
      font-size: 18px;
      font-weight: bold;
      text-align: center;
      padding: 10px 0;
      margin: 16px 0 12px;
      animation: neonPulse 2s infinite;
      text-shadow: 0 0 14px currentColor;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.3);
    }
    .selisih-jumlah {
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 14px;
      text-shadow: 0 0 12px currentColor;
      font-family: 'Orbitron', monospace;
    }
    .mode-toggle {
      text-align: center;
      background: var(--panel-bg);
      padding: 16px;
      border-radius: 12px;
      border: 1px solid var(--panel-border);
      margin-bottom: 20px;
      box-shadow: 0 0 12px var(--panel-shadow);
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 64px;
      height: 32px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #001122;
      transition: .4s;
      border-radius: 34px;
      border: 2px solid var(--neon-blue);
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 24px;
      width: 24px;
      left: 3px;
      bottom: 3px;
      background-color: var(--neon-blue);
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: transparent;
    }
    input:checked + .slider:before {
      transform: translateX(30px);
      background-color: var(--neon-green);
    }
    .tab-switch {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      gap: 8px;
      position: static;
      justify-content: center;
      margin-bottom: 16px;
    }
    .tab-btn {
      padding: 8px 16px;
      background: rgba(0, 15, 35, 0.8);
      border: 2px solid var(--neon-blue);
      color: var(--neon-blue);
      border-radius: 24px;
      font-size: 12px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.25s ease;
      text-shadow: 0 0 6px rgba(0, 255, 255, 0.8);
    }
    .tab-btn.active {
      background: rgba(0, 255, 255, 0.2);
      box-shadow: 0 0 16px rgba(0, 255, 255, 0.8);
      transform: scale(1.05);
    }
    .tab-btn:not(.active):hover {
      background: rgba(0, 50, 100, 0.7);
      transform: translateY(-2px);
    }
    .tab-btn[data-tab="trycari"] {
      color: var(--neon-yellow);
      border-color: var(--neon-yellow);
      text-shadow: 0 0 6px rgba(255, 255, 0, 0.8);
    }
    .tab-btn[data-tab="trycari"].active {
      background: rgba(255, 255, 0, 0.15);
      box-shadow: 0 0 16px rgba(255, 255, 0, 0.7);
    }
    .extract-h-container {
      display: flex;
      gap: 16px;
      overflow-x: auto;
      padding: 12px 0;
      max-height: 160px;
      background: rgba(0, 8, 25, 0.4);
      border-radius: 10px;
      padding: 14px;
      scrollbar-width: thin;
      scrollbar-color: var(--neon-blue) rgba(0,0,0,0.3);
    }
    .extract-h-container::-webkit-scrollbar {
      height: 10px;
    }
    .extract-h-container::-webkit-scrollbar-thumb {
      background: var(--neon-blue);
      border-radius: 5px;
    }
    .extract-h-card {
      min-width: 280px;
      background: rgba(0, 20, 45, 0.85);
      border: 1px solid rgba(0, 200, 255, 0.5);
      border-radius: 10px;
      padding: 12px;
      flex-shrink: 0;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      box-shadow: 0 4px 12px rgba(0, 255, 255, 0.2);
    }
    .extract-h-card .label {
      font-size: 10px;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--neon-blue);
      font-weight: bold;
    }
    .extract-h-card .value {
      font-family: 'Consolas', monospace;
      font-size: 13px;
      word-break: break-all;
      line-height: 1.4;
      color: var(--text-main);
    }
    .error-msg {
      color: var(--neon-red);
      text-align: center;
      padding: 16px;
      font-weight: bold;
      font-size: 16px;
      background: rgba(100, 0, 0, 0.2);
      border-radius: 10px;
      border-left: 4px solid var(--neon-red);
    }
    .card-body {
      flex-direction: column;
      gap: 16px;
    }
    .user-card, .bank-card {
      min-width: 100%;
    }
    .diff-value {
      font-size: 24px;
      font-weight: bold;
      color: currentColor;
      font-family: 'Orbitron', sans-serif;
      margin-top: 8px;
    }

    /* ========================================
    PENGATURAN TOGEL STYLES
    ======================================== */
    #pengaturanTab {
      background: rgba(0, 0, 50, 0.85);
      color: #00ffff;
      border: 2px solid #00ffff33;
      border-radius: 16px;
      box-shadow: 0 0 30px #00ffff44, 0 0 60px #00ccff22;
      padding: 20px;
      max-width: 1100px;
      margin: 30px auto;
      overflow-x: auto;
      font-weight: bold;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      transition: all 0.3s ease;
    }
    #pengaturanTab h3 {
      margin-top: 0;
      font-size: 26px;
      font-weight: bold;
      color: #00FFFF;
      text-shadow: 0 0 6px #00ffff, 0 0 20px #00ccff;
      font-weight: bold;
      text-align: center;
      animation: neonPulse 2.5s infinite alternate;
    }
    #pengaturanTab h4 {
      margin: 15px 0 5px 0;
      color: #80ffff;
      font-size: 20px;
      text-shadow: 0 0 6px #00ffff, 0 0 15px #00ccff;
      cursor: pointer;
      transition: all 0.3s ease;
      padding-left: 10px;
      border-left: 3px solid #00ffff44;
      border-radius: 6px;
    }
    #pengaturanTab h4:hover {
      color: #00ffff;
      text-shadow: 0 0 12px #00ffff, 0 0 28px #00ccff;
      border-left: 3px solid #00ffff;
      transform: translateX(2px);
      animation: neonPulse 1.5s infinite alternate;
    }
    #pengaturanTab h5.kendala-accordion {
      margin: 10px 0;
      padding: 10px 15px;
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid #00ffff33;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }
    #pengaturanTab h5.kendala-accordion:hover {
      background: rgba(0, 0, 0, 0.4);
      transform: translateX(2px);
      box-shadow: 0 0 10px #00ffff22;
    }
    #pengaturanTab table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 6px;
      margin-bottom: 10px;
      background: rgba(0, 0, 50, 0.15);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 0 6px #00ffff22 inset;
      transition: all 0.3s ease;
    }
    #pengaturanTab table th,
    #pengaturanTab table td {
      padding: 10px;
      text-align: left;
      font-weight: bold;
      font-size: 14px;
      background: rgba(0, 0, 0, 0.2);
      white-space: pre-line;
    }
    #pengaturanTab table th {
      color: #00ffff;
      text-shadow: 0 0 5px #00ccff;
      background: rgba(0, 0, 70, 0.25);
    }
    #pengaturanTab table td input {
      padding: 5px 8px;
      border: 1px solid #00ffff33;
      border-radius: 6px;
      background: rgba(0, 0, 50, 0.65);
      color: #00ffff;
      font-weight: bold;
      box-shadow: 0 0 4px #00ffff33 inset;
      word-wrap: break-word;
      white-space: normal;
      transition: all 0.3s ease;
      width: 100%;
      box-sizing: border-box;
      min-width: 100px;
      max-width: 200px;
      width: auto;
      font-weight: bold;
      white-space: normal;
      overflow: visible;
      text-overflow: clip;
    }
    #pengaturanTab table td input:focus {
      outline: none;
      box-shadow: 0 0 12px #00ffff88 inset, 0 0 8px #00ccff55;
      background: rgba(0, 0, 60, 0.85);
      animation: neonPulse 1.2s infinite alternate;
    }
    #pengaturanTab table tr td:nth-child(2) input {
      min-width: 300px;
      max-width: 500px;
      width: auto;
      font-weight: bold;
      white-space: normal;
      overflow: visible;
      text-overflow: clip;
      white-space: pre-wrap;
    }
    .kendala-panel .editable-cell,
    .editable-cell,
    .link-live-item {
      width: 100%;
      min-height: 40px;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #00ffff33;
      border-radius: 6px;
      background: rgba(0, 0, 50, 0.65);
      color: #00ffff;
      font-weight: bold;
      box-shadow: 0 0 4px #00ffff33 inset;
      cursor: text;
      word-wrap: break-word;
      white-space: pre-wrap;
      transition: all 0.3s ease;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 36px;
      white-space: pre-line;
    }
    .kendala-panel .editable-cell:focus,
    .editable-cell:focus,
    .link-live-item:focus {
      outline: none;
      box-shadow: 0 0 12px #00ffff88 inset, 0 0 8px #00ccff55;
      background: rgba(0, 0, 60, 0.85);
      animation: neonPulse 1.2s infinite alternate;
    }
    #pengaturanTab table tr td:nth-child(4) .editable-cell,
    #pengaturanTab table tr td:nth-child(5) .editable-cell {
      min-height: 40px;
      min-width: 100px;
      max-width: 200px;
      font-weight: bold;
      white-space: pre-line;
      word-wrap: break-word;
      padding: 8px;
      border: 1px solid #00ffff33;
      border-radius: 6px;
      background: rgba(0, 0, 50, 0.65);
      color: #00ffff;
    }
    .row-save-btn {
      padding: 5px 12px;
      border-radius: 6px;
      border: none;
      background: linear-gradient(145deg, rgba(0, 255, 255, 0.4), rgba(0, 150, 255, 0.3));
      color: #00ffff;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 6px #00ffff66, 0 0 12px #00ccff44;
      transition: all 0.3s ease;
    }
    .row-save-btn:hover {
      background: rgba(0, 255, 255, 0.25);
      transform: scale(1.08);
      box-shadow: 0 0 18px #00ffffaa, 0 0 24px #00ccff88;
      animation: neonPulse 1.5s infinite alternate;
    }
    .settings-neon-btn {
      padding: 6px 14px;
      border: none;
      border-radius: 6px;
      background: linear-gradient(145deg, rgba(0, 255, 255, 0.35), rgba(0, 150, 255, 0.25));
      color: #00ffff;
      font-weight: bold;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow:
        0 0 6px rgba(0, 255, 255, 0.6),
        0 0 12px rgba(0, 229, 255, 0.3);
      text-shadow: 0 0 3px rgba(0, 255, 255, 0.8);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .settings-neon-btn:hover {
      background: linear-gradient(145deg, rgba(0, 255, 255, 0.5), rgba(0, 200, 255, 0.4));
      transform: scale(1.08);
      box-shadow:
        0 0 12px rgba(0, 255, 255, 0.9),
        0 0 20px rgba(0, 229, 255, 0.6);
    }
    .settings-neon-btn:active {
      transform: scale(1.02);
    }
    .settings-neon-btn i {
      font-size: 14px;
    }
    .panel {
      display: none;
      padding: 6px 0;
      border-left: 2px solid #00ffff33;
      border-right: 2px solid #00ffff33;
      border-bottom: 2px solid #00ffff33;
      border-radius: 0 0 10px 10px;
      box-shadow: inset 0 0 6px #00ffff22;
      transition: all 0.3s ease;
      flex-wrap: nowrap;
    }
    .panel table tr {
      flex-wrap: nowrap;
    }
    .kendala-panel {
      display: none;
      padding: 6px 0;
      margin-top: -10px;
      background: rgba(0, 0, 0, 0.1);
      border: 1px solid #00ffff1a;
      border-radius: 0 0 10px 10px;
      border-top: none;
      box-shadow: inset 0 0 6px #00ffff11;
      transition: all 0.3s ease;
    }
    @keyframes neonPulse {
      0% { text-shadow: 0 0 4px #00ffff, 0 0 10px #00ccff; }
      50% { text-shadow: 0 0 12px #00ffff, 0 0 20px #00ccff; }
      100% { text-shadow: 0 0 8px #00ffff, 0 0 18px #00ccff; }
    }
    .sidebar-container .neon-button:first-child:hover {
      background: rgba(0, 255, 255, 0.2);
      transform: scale(1.1);
      box-shadow: 0 0 15px #0ff, 0 0 30px #0cc;
    }
    .tooltip-text {
      visibility: hidden;
      width: 100px;
      background-color: rgba(0, 0, 50, 0.9);
      color: #0ff;
      text-align: center;
      border-radius: 6px;
      padding: 4px;
      font-size: 10px;
      font-weight: bold;
      text-shadow: 0 0 3px #0ff;
      position: absolute;
      left: 50px;
      top: 50%;
      transform: translateY(-50%);
      box-shadow: 0 0 8px #0ff77;
      z-index: 1000;
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .sidebar-container .neon-button:first-child:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    .sidebar-container .neon-button:first-child {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 10px 0;
      border: 2px solid #0ff;
      background: rgba(0, 0, 50, 0.7);
      color: #0ff;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 8px #0ff88, 0 0 15px #0ff44;
      transition: all 0.3s ease;
      position: relative;
    }
    .hadiah-container {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 20px;
    }
    .hadiah-box {
      background: rgba(0, 10, 30, 0.85);
      border: 1px solid #33ffff;
      border-radius: 12px;
      box-shadow: 0 0 20px #33ffff;
      padding: 16px;
      width: 100%;
      transition: all 0.3s ease;
    }
    .hadiah-box:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 0 35px #66ffff;
    }
    .hadiah-box details {
      border: 1px solid #33ffff;
      border-radius: 10px;
      margin-bottom: 8px;
      background: rgba(0,10,30,0.8);
      box-shadow: 0 0 15px #33ffff50;
      overflow: hidden;
      font-weight: bold;
      font-size: 16px;
    }
    .hadiah-box summary {
      list-style: none;
      cursor: pointer;
      padding: 12px 16px;
      color: #aaffff;
      text-align: center;
      text-shadow: 0 0 6px #33ffff;
      font-weight: bold;
      font-size: 18px;
    }
    .hadiah-box summary::-webkit-details-marker {
      display: none;
    }
    .hadiah-box table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
    }
    .hadiah-box th, .hadiah-box td {
      border: 1px solid rgba(255,255,255,0.1);
      padding: 8px 12px;
      font-size: 15px;
      font-weight: bold;
      color: #e0f7ff;
      text-align: center;
    }
    .hadiah-box th {
      background: rgba(0, 50, 100, 0.6);
      text-shadow: 0 0 4px #66ffff;
    }
    .hadiah-box td {
      background: rgba(0, 50, 100, 0.25);
    }
    .diskon {
      text-align: center;
      font-weight: bold;
      color: #66ffff;
      text-shadow: 0 0 2px #33ffff;
      font-size: 13px;
      font-weight: bold;
      margin-top: 4px;
    }
    .tabel-dua-kolom {
      display: flex;
      gap: 12px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    .tabel-dua-kolom table {
      flex: 1;
      min-width: 280px;
    }
    .tabel-dua-kolom th,
    .tabel-dua-kolom td {
      padding: 6px 8px;
      font-weight: bold;
      font-size: 14px;
    }
    @media (max-width: 600px) {
      .tabel-dua-kolom {
        flex-direction: column;
      }
    }
    .btn-add-new {
      background-color: #17a2b8;
      color: #00FFFF;
    }
    .btn-add-new:hover {
      background-color: #138496;
      box-shadow: 0 0 10px rgba(23, 162, 184, 0.7);
    }
    .btn-tambah-baris-bottom {
      background: linear-gradient(145deg, rgba(72, 61, 139, 0.6), rgba(0, 0, 139, 0.4));
      color: #00ffff;
      font-weight: bold;
      font-size: 1.1em;
      padding: 8px 18px;
      border: 2px solid #00ffff55;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 0 10px #8a2be288, 0 0 20px #00ffff44;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    .btn-tambah-baris-bottom:hover {
      background: linear-gradient(145deg, rgba(72, 61, 139, 0.8), rgba(0, 0, 139, 0.6));
      border-color: #00ffff;
      transform: scale(1.05);
      box-shadow: 0 0 15px #8a2be2, 0 0 30px #00ffffaa;
    }
    .btn-tambah-baris-bottom::before {
      color: #ff00ff;
      margin-right: 8px;
      font-size: 1.2em;
      font-weight: bolder;
      text-shadow: 0 0 5px #ff00ff;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    #reportSearch {
      flex-grow: 1;
      padding: 10px 15px;
      margin-right: 15px;
      background-color: #1a1a1a;
      color: #00ffff;
      border: 1px solid transparent;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
      outline: none;
      box-shadow: 0 0 6px rgba(0, 255, 255, 0.3);
      backdrop-filter: blur(2px);
    }
    #reportSearch:focus {
      border-color: #00ffff;
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.7), inset 0 0 4px rgba(0, 150, 255, 0.4);
      background-color: #1e1e1e;
    }

    /* ========================================
    MODAL ZOOM GALERI
    ======================================== */
    #bonusZoomModal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.95);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
    }
    #bonusZoomModal .zoomed-content-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      gap: 12px;
      max-width: 90vw;
    }
    #bonusZoomModal .zoomed-content-wrapper img {
      flex: 1;
      max-width: none;
      height: auto;
      max-height: 85vh;
      object-fit: contain;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.8), 0 0 25px rgba(0, 255, 255, 0.5);
      min-width: 0;
    }
    #bonusZoomModal .zoomed-userid {
      display: block;
      text-align: center;
      font-size: 2.2em;
      font-weight: bold;
      margin-bottom: 15px;
      text-shadow: 0 0 10px #ffcc00;
      color: #fff;
    }
    #bonusZoomModal #bonusCaption {
      color: #aaa;
      margin-top: 20px;
      text-align: center;
      font-weight: bold;
      font-size: 14px;
    }
    .zoom-nav-button {
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      width: 48px;
      height: 48px;
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.25s ease;
      flex-shrink: 0;
      margin: 0 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }
    .zoom-nav-button:hover,
    .zoom-nav-button:focus {
      background: rgba(0, 200, 255, 0.8);
      border-color: rgba(0, 255, 255, 0.7);
      color: #000;
      outline: none;
      transform: scale(1.05);
    }
    .zoom-nav-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }
    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      width: 40px;
      height: 40px;
      border: none;
      border-radius: 50%;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
    .close-btn:hover {
      background: rgba(255, 0, 0, 0.7);
    }

    /* ========================================
    OCR MODAL STYLES
    ======================================== */
    #membacaIsiFoto_modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 20, 0.9);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      flex-direction: row;
      gap: 20px;
      padding: 20px;
      box-sizing: border-box;
      overflow-y: auto;
      flex-wrap: wrap;
    }
    #membacaIsiFoto_modal div[onclick*="tutup"] {
      position: absolute;
      top: 15px;
      right: 25px;
      font-size: 32px;
      color: #00ffff;
      cursor: pointer;
      user-select: none;
      font-weight: bold;
      text-shadow: 0 0 10px cyan;
      transition: 0.2s;
    }
    #membacaIsiFoto_modal div[onclick*="tutup"]:hover {
      transform: scale(1.2);
      color: #ff0066;
      text-shadow: 0 0 10px #ff0099;
    }
    #membacaIsiFoto_gambar {
      max-width: 100%;
      max-height: 80vh;
      border-radius: 12px;
      box-shadow: 0 0 30px cyan;
      transition: transform 0.3s ease-in-out;
    }
    #membacaIsiFoto_gambar:hover {
      transform: scale(1.02);
    }
    #membacaIsiFoto_hasil {
      color: #00ffff;
      font-family: 'Courier New', monospace;
      font-weight: bold;
      white-space: pre-wrap;
      background: rgba(0, 40, 60, 0.7);
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 0 25px #00ffff88;
      max-height: 80vh;
      overflow-y: auto;
      font-size: 15px;
      flex: 1;
      min-width: 300px;
    }
    @media (max-width: 768px) {
      #membacaIsiFoto_modal {
        flex-direction: column;
        gap: 10px;
        padding: 10px;
      }
      #membacaIsiFoto_hasil {
        font-size: 15px;
        font-weight: bold;
        max-height: 40vh;
      }
      #membacaIsiFoto_gambar {
        max-height: 40vh;
      }
    }
    .zoomable-image {
      width: 100%;
      max-width: 300px;
      height: auto;
      cursor: zoom-in;
      border-radius: 8px;
      transition: transform 0.2s ease-in-out;
      box-shadow: 0 0 10px cyan;
    }
    .zoomable-image:hover {
      transform: scale(1.05);
    }
    #scatterLightbox {
      display: none;
      position: fixed;
      z-index: 9999;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.9);
      align-items: center;
      justify-content: center;
    }
    #scatterLightbox img {
      max-width: 90%;
      max-height: 90%;
      border-radius: 12px;
      box-shadow: 0 0 30px cyan;
    }

    /* ========================================
    SCAN SCATTER MODAL
    ======================================== */
    #scanScatter2Modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.95);
      z-index: 10001;
      padding: 10px;
      box-sizing: border-box;
    }
    #scanScatter2Modal button {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 32px;
      color: #00ffff;
      background: none;
      border: none;
      cursor: pointer;
      z-index: 10002;
    }
    #scanScatter2Image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 8px;
      box-shadow: 0 0 20px cyan;
    }
    #scanScatter2Result {
      color: #00ffff;
      font-family: monospace;
      font-size: 16px;
      line-height: 1.6;
    }

    /* ========================================
    ZOOM MODAL TRANSAKSI
    ======================================== */
    #zoomModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.95);
      z-index: 9999;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }
    #closeZoomBtn {
      position: absolute;
      top: 20px;
      right: 30px;
      font-size: 28px;
      color: #00ffff;
      cursor: pointer;
      user-select: none;
      font-weight: bold;
      text-shadow: 0 0 6px cyan;
    }
    #zoomedImage {
      max-width: 90%;
      max-height: 80vh;
      border-radius: 10px;
      box-shadow: 0 0 20px cyan;
    }
    #kodeHasilZoom {
      flex: 1;
      color: #00ffff;
      font-family: monospace;
      font-weight: bold;
      white-space: pre-wrap;
      background: rgba(0,20,40,0.8);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 0 15px cyan;
      max-height: 80vh;
      overflow-y: auto;
      font-size: 14px;
    }
    #imageUrlZoom {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid cyan;
      background: rgba(0,20,40,0.9);
      color: #00ffff;
      font-size: 14px;
      text-align: center;
    }

    /* ========================================
    LIGHTBOX MODAL
    ======================================== */
    #lightboxModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.95);
      z-index: 9998;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    #lightboxModal span {
      position: absolute;
      top: 20px;
      right: 30px;
      font-size: 28px;
      color: #00FFFF;
      cursor: pointer;
      user-select: none;
    }
    #lightboxImage {
      max-width: 90%;
      max-height: 90%;
      border-radius: 10px;
      box-shadow: 0 0 20px #00FFFF;
    }
    #lightboxModal button {
      font-size: 16px;
      padding: 10px 20px;
      border: 1px solid #00FFFF;
      background: rgba(255,255,255,0.1);
      color: #00FFFF;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 20px;
    }
    #lightboxModal button + button {
      margin-left: 10px;
    }
  </style>
</head>
<body class="bg-default">

<!-- Toggle Sidebar Button -->
<button id="toggleSidebarBtn" style="
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 1001;
  background: rgba(0, 20, 40, 0.7);
  color: #00ffff;
  border: 1px solid #00ffff;
  border-radius: 6px;
  padding: 6px 10px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 0 8px rgba(0,255,255,0.5);
">ðŸ’€</button>

<!-- Main Container -->
<div class="main-container">
  <!-- Sidebar -->
  <div class="sidebar-container">
    <!-- Settings Button -->
    <button class="neon-button" onclick="showTab('pengaturanTab', this)">
      âš™ï¸
      <span class="tooltip-text">Pengaturan Togel</span>
    </button>
    <!-- Logo / Judul -->
    <div class="sidebar-brand">
      <div class="planet-icon">
        <svg viewBox="0 0 64 64" width="52" height="52">
          <circle cx="32" cy="32" r="14" fill="none" stroke="#0ff" stroke-width="2">
            <animate attributeName="r" values="10;14;10" dur="2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="32" cy="32" r="8" fill="#0ff">
            <animate attributeName="fill" values="#0ff;#00f;#0ff" dur="3s" repeatCount="indefinite"/>
          </circle>
          <ellipse cx="32" cy="32" rx="24" ry="10" fill="none" stroke="#0ff" stroke-width="1.5" stroke-dasharray="5,5">
            <animateTransform attributeName="transform" attributeType="XML" type="rotate" from="0 32 32" to="360 32 32" dur="10s" repeatCount="indefinite"/>
          </ellipse>
        </svg>
      </div>
      <h2>LINE<span style="color:#ff00ff; text-shadow: 0 0 10px #ff00ff;">TOGEL</span></h2>
    </div>
    <!-- Jam Digital -->
    <div id="clock">00:00:00</div>

    <!-- Tombol Navigasi Folder -->
    <button class="neon-button" onclick="loadNotes('KENDALA ALL'); showTab('catatanTab', this)">
      <i class="fas fa-headset"></i>
      <span>KENDALA ALL</span>
    </button>
    <button class="neon-button" onclick="loadNotes('FOTO'); showTab('catatanTab', this)">
      <i class="fas fa-camera"></i>
      <span>FOTO</span>
    </button>
    <button class="neon-button" onclick="loadNotes('CARA BERMAIN'); showTab('catatanTab', this)">
      <i class="fas fa-book-open"></i>
      <span>CARA BERMAIN</span>
    </button>
    <button class="neon-button" onclick="loadNotes('PROMO'); showTab('catatanTab', this)">
      <i class="fas fa-gift"></i>
      <span>PROMO</span>
    </button>
    <button class="neon-button" onclick="showTab('tryCariTab', this)">
      <i class="fas fa-folder"></i>
      <span>TRY CARI SELISIH</span>
    </button>
    <button class="neon-button" onclick="loadPasaranTogel(); loadCaraHitungTogel(); showTab('prediksiGabungTab', this)">
      <i class="fas fa-bullseye"></i>
      <span>PREDIKSI & HITUNG TOGEL</span>
    </button>
    <button class="neon-button" onclick="showTab('cekBonusEventTab', this)">
      <i class="fas fa-gem"></i>
      <span>CEK BONUS EVENT</span>
    </button>
    <button class="neon-button" onclick="showHadiahTab(); showTab('cekhadiahTab', this)">
      <i class="fas fa-medal"></i>
      <span>HADIAH TOGEL</span>
    </button>
    <button class="neon-button" onclick="loadReportLineData(); showTab('reportLineTab', this)">
      <i class="fas fa-file-alt"></i>
      <span>REPORT LINE</span>
    </button>
    <button class="neon-button" onclick="showTab('tanyaZTab', this)">
      <i class="fas fa-comments"></i>
      <span>TANYA Z</span>
    </button>
  </div>

  <!-- Content Area -->
  <div class="content-area">
    <!-- Tab: Catatan Utama -->
    <div id="catatanTab" class="tab-content active">
      <h3 id="judulCatatan" class="judul-glow">ðŸ’« LINE TOGEL ðŸ’«</h3>
      <div id="notesHeader" style="margin-bottom: 50px; font-weight: bold; font-size: 16px; color: #00ffff;">
        ðŸ’« <span style="text-shadow: 0 0 5px #00ffff;">Daftar Catatan:</span>
      </div>
      <!-- Pencarian -->
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="ðŸ” Cari catatan..." oninput="searchNotes()" />
      </div>
      <div id="notesList"><strong>LINE TOGEL</strong></div>
    </div>

    <!-- Tab: Prediksi & Hitung Togel -->
    <div id="prediksiGabungTab" class="tab-content" style="display: none;">
      <!-- Input Link Gambar -->
      <div style="margin-top: 30px; background-color: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px;">
        <label for="membacaIsiFoto_input" style="color:#00ffff;">ðŸ”— Link Gambar:</label>
        <input type="text" id="membacaIsiFoto_input" placeholder="Tempel link gambar di sini..."
          oninput="membacaIsiFoto_prosesLink()"
          style="width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 8px;">
      </div>

      <!-- Modal OCR -->
      <div id="membacaIsiFoto_modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.95); z-index:9999; justify-content:center; align-items:center; flex-direction:row; gap:20px; padding:20px; box-sizing: border-box;">
        <div id="membacaIsiFoto_tombolTutup" onclick="membacaIsiFoto_tutup()"
          style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
          font-size: 28px; color: #00ffff; cursor: pointer; user-select: none;
          font-weight: bold; text-shadow: 0 0 6px cyan; z-index: 10000;">
          âœ–
        </div>
        <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
          <img id="membacaIsiFoto_gambar" src="" style="max-width: 90%; max-height: 90vh; border-radius: 10px; box-shadow: 0 0 20px cyan;">
        </div>
        <div id="membacaIsiFoto_hasil" style="flex: 1; color:#00ffff; font-family:monospace; font-weight:bold; white-space:pre-wrap; background:rgba(0,20,40,0.8); border-radius:12px; padding:16px; box-shadow:0 0 15px cyan; max-height:90vh; overflow-y:auto; font-size:14px;">
          <i>Menunggu gambar...</i>
        </div>
      </div>

      <!-- Bagian Hitungan -->
      <h2>ðŸ§® Hitung Togel</h2>

      <div class="nominal-group">
        <label>Nominal Bettingan:</label>
        <input type="number" id="nominalInput" />
        <button onclick="updateNominalTogel()">Simpan</button>
      </div>

      <div class="custom-select">
        <select id="kelompokDropdown" class="hitung-dropdown" onchange="isiDropdownLabel()">
          <option value="">-- Pilih Tipe Hitungan --</option>
        </select>
      </div>
      <div class="custom-select">
        <select id="labelDropdown" class="hitung-dropdown" onchange="tampilkanValueHitungan()">
          <option value="">-- Pilih Label --</option>
        </select>
      </div>

      <div id="detailHitunganDropdown"></div>
      <hr style="margin: 30px 0; border-color: #00ffff;">

      <!-- Bagian Prediksi -->
      <div class="pasaran-container">
        <h2 class="pasaran-title">ðŸŒ  PREDIKSI TOGEL</h2>
        <input type="text" id="searchPasaran" class="pasaran-search" placeholder="Cari prediksi atau jadwal..." oninput="searchDropdowns()" />
        <button id="btnToggleTanggal" class="btn-toggle-tanggal" onclick="toggleTanggalPasaran()">Ganti Tanggal</button>
        <div id="formTanggal" class="form-tanggal">
          <input type="date" id="tanggalPasaran" class="input-tanggal" />
          <button onclick="simpanTanggalPasaran()" class="btn-simpan-tanggal">Simpan</button>
        </div>

        <div style="display: flex; justify-content: space-between; gap: 20px; margin-top: 20px;">
          <div style="flex: 1;">
            <label class="pasaran-title" style="color: #00ffff;">ðŸŒŒ PREDIKSI TOGEL</label>
            <div class="custom-select">
              <select id="dropdownPrediksi" class="pasaran-dropdown" onchange="showDetail('prediksi')"></select>
            </div>
            <div id="detailPrediksi" class="dropdown-detail" onclick="copyToClipboardDetail(this)"></div>
          </div>
          <div style="flex: 1;">
            <label class="pasaran-title" style="color: #00ffff;">ðŸª JADWAL TOGEL</label>
            <div class="custom-select">
              <select id="dropdownJadwal" class="pasaran-dropdown" onchange="showDetail('jadwal')"></select>
            </div>
            <div id="detailJadwal" class="dropdown-detail" onclick="copyToClipboardDetail(this)"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Cek Bonus Event -->
    <div id="cekBonusEventTab" class="tab-content" style="display: none;">
      <div class="bonus-section">
        <h3 class="judul-glow">ðŸ’« LINE TOGEL ðŸ’«</h3>
        <h2 class="bonus-title">ðŸ’Ž BONUS EVENT ðŸ’Ž</h2>

        <!-- ============ 3 SWITCH MODE BUTTON (NEON TRANSPARAN) ============ -->
        <div style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin: 15px 0;">
          <button class="neon-switch-btn" onclick="switchBonusMode('bonusAsli')" id="btn-bonusAsli">
            ðŸ’Ž Cek Bonus Asli
          </button>
          <button class="neon-switch-btn" onclick="switchBonusMode('galeri')" id="btn-galeri">
            ðŸ“¸ Galeri Gambar
          </button>
          <button class="neon-switch-btn" onclick="switchBonusMode('inputScatter')" id="btn-inputScatter">
            ðŸ“‹ Input Scatter (2 Data)
          </button>
        </div>

        <!-- ============ MODE 1: CEK BONUS ASLI ============ -->
        <div id="modeBonusAsli" class="bonus-mode">
          <textarea id="bonusTextarea" class="bonus-textarea" placeholder="Tempelkan data transaksi di sini..."></textarea>
          <div class="bonus-input-group">
            <label for="bonusPatokan" class="bonus-label">Nilai Patokan:</label>
            <input type="text" id="bonusPatokan" class="bonus-input" placeholder="Contoh: 5000000">
          </div>
          <div class="bonus-input-group">
            <label for="bonusSurplus" class="bonus-label">Nilai Surplus:</label>
            <input type="text" id="bonusSurplus" class="bonus-input" placeholder="Contoh: 1500000">
          </div>
          <div class="bonus-button-group">
            <button onclick="hitungBonusEvent()" class="bonus-btn">ðŸ” Hitung Bonus</button>
            <button onclick="hapusBonusEvent()" class="bonus-btn danger">ðŸ§¹ Bersihkan</button>
          </div>
          <div id="bonusHasil" class="bonus-result"></div>
          <label for="imageUrl" style="color:#00ffff; margin-top:10px;">ðŸ”— Link Gambar Transaksi:</label>
          <input type="text" id="imageUrl" class="bonus-input" placeholder="Tempel link gambar di sini..." style="width: 100%;">
        </div>

        <!-- ============ MODE 2: GALERI GAMBAR ============ -->
        <div id="modeGaleri" class="bonus-mode" style="display: none;">
          <h2 class="bonus-title">ðŸ“¸ GALERI GAMBAR</h2>
          <p style="text-align: center; color: #3498db; margin-bottom: 12px;">
            **Tempel/Ketik** data. Format: <strong>USERID link1 link2 link3</strong>
          </p>
          <textarea id="bonusLinkInput" 
                    placeholder="Tempelkan data paket di sini. Setiap baris = satu paket."
                    rows="6"
                    oninput="handleBonusInput()"
                    onpaste="handleBonusInput()"></textarea>
          <div class="bonus-button-group">
            <button onclick="clearBonusAllData()" class="bonus-btn danger">ðŸ—‘ï¸ Hapus Semua</button>
          </div>
          <hr style="margin: 20px 0; border-color: #00ffff44;">
          <div class="gallery-container" style="display: flex; justify-content: center; margin: 20px 0;">
            <div class="combined-image-slot" id="bonusCombinedImageSlot" onclick="openBonusZoom()">
              <p class="caption-userid" id="bonusCombinedSlotUserid" style="color: #00ffff; text-align: center; margin: 0 0 10px; font-weight: bold;">USER ID</p>
              <img id="bonusImgSlot1" src="https://via.placeholder.com/180x160/0a1a2f/ffffff?text=1" style="width:110px; height:100px; object-fit:cover; border-radius:8px; margin:0 4px;">
              <img id="bonusImgSlot2" src="https://via.placeholder.com/180x160/0a1a2f/ffffff?text=2" style="width:110px; height:100px; object-fit:cover; border-radius:8px; margin:0 4px;">
              <img id="bonusImgSlot3" src="https://via.placeholder.com/180x160/0a1a2f/ffffff?text=3" style="width:110px; height:100px; object-fit:cover; border-radius:8px; margin:0 4px;">
            </div>
          </div>
          <p class="package-info" style="text-align: center; color: #00ffff; margin-top: 10px;">
            Paket: <span id="bonusCurrentPackageNum">0</span> / <span id="bonusMaxPackageNum">0</span>
          </p>
        </div>

        <!-- ============ MODE 3: INPUT SCATTER (2 DATA) ============ -->
        <div id="modeInputScatter" class="bonus-mode" style="display: none;">
          <!-- WRAPPER FLEX UNTUK SUSUN KIRI-KANAN -->
          <div style="display: flex; gap: 16px; justify-content: space-between; flex-wrap: wrap;">
            
            <!-- DATA 1 -->
            <div style="flex: 1; min-width: 280px; background: rgba(0,15,30,0.5); padding: 10px; border-radius: 8px; border: 1px solid #00ffff33;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <h4 style="color: #00ffff; margin: 0; font-size: 15px;">DATA SCATTER 1</h4>
                <button onclick="copyData1()" class="neon-switch-btn" style="padding: 4px 10px; font-size: 12px;">ðŸ“‹ Copy</button>
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">1. UID:</label>
                <input type="text" id="bonusUserid1" class="bonus-input" placeholder="San221" style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">2. S1:</label>
                <input type="text" id="bonusScatter1_1" class="bonus-input" placeholder="Link..." style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">3. S2:</label>
                <div style="display: flex; gap: 6px; align-items: center;">
                  <input type="text" id="bonusScatter2_1" class="bonus-input" placeholder="Link..." style="flex:1; padding: 5px; font-size: 13px; height: 28px;">
                  <button type="button" onclick="scanScatter2(1)" class="bonus-btn" style="padding: 4px 8px; font-size: 12px; white-space: nowrap;">ðŸ“¸</button>
                </div>
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">4. S3:</label>
                <input type="text" id="bonusScatter3_1" class="bonus-input" placeholder="Link..." style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">5. Rek:</label>
                <input type="text" id="bonusRekening1" class="bonus-input" placeholder="A SUWARSAN,085882449440" style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">6. Kode:</label>
                <input type="text" id="bonusKodeTransaksi1" class="bonus-input" placeholder="Kode..." style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
            </div>

            <!-- DATA 2 -->
            <div style="flex: 1; min-width: 280px; background: rgba(0,15,30,0.5); padding: 10px; border-radius: 8px; border: 1px solid #00ffff33;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <h4 style="color: #00ffff; margin: 0; font-size: 15px;">DATA SCATTER 2</h4>
                <button onclick="copyData2()" class="neon-switch-btn" style="padding: 4px 10px; font-size: 12px;">ðŸ“‹ Copy</button>
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">1. UID:</label>
                <input type="text" id="bonusUserid2" class="bonus-input" placeholder="Budi123" style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">2. S1:</label>
                <input type="text" id="bonusScatter1_2" class="bonus-input" placeholder="Link..." style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">3. S2:</label>
                <div style="display: flex; gap: 6px; align-items: center;">
                  <input type="text" id="bonusScatter2_2" class="bonus-input" placeholder="Link..." style="flex:1; padding: 5px; font-size: 13px; height: 28px;">
                  <button type="button" onclick="scanScatter2(2)" class="bonus-btn" style="padding: 4px 8px; font-size: 12px; white-space: nowrap;">ðŸ“¸</button>
                </div>
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">4. S3:</label>
                <input type="text" id="bonusScatter3_2" class="bonus-input" placeholder="Link..." style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">5. Rek:</label>
                <input type="text" id="bonusRekening2" class="bonus-input" placeholder="BUDI,1234567890" style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
              <div class="bonus-input-group" style="margin: 4px 0;">
                <label class="bonus-label" style="font-size: 12px;">6. Kode:</label>
                <input type="text" id="bonusKodeTransaksi2" class="bonus-input" placeholder="Kode..." style="padding: 5px; font-size: 13px; height: 28px; width: 100%;">
              </div>
            </div>
          </div>
          <!-- MENU AKSI (tetap di bawah) -->
          <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 20px;">
            <button onclick="copySemuaData()" class="neon-switch-btn" style="padding: 6px 12px; font-size: 13px;">
              ðŸ“‹ Copy Semua (2 Baris)
            </button>
            <button onclick="hapusSemuaData()" class="neon-switch-btn danger" style="padding: 6px 12px; font-size: 13px;">
              ðŸ§¹ Hapus Semua
            </button>
          </div>
        </div> <!-- tutup #modeInputScatter -->
      </div> <!-- tutup .bonus-section -->
    </div> <!-- âœ… TUTUP TAB -->

    <!-- Tab: Tanya Z (AI Chat) -->
    <div id="tanyaZTab" class="tab-content" style="display: none;">
      <h3 class="judul-glow">ðŸ¤– Z</h3>
      <div id="chatHistory" class="chat-container"></div>
      <div class="chat-input-container">
        <div id="chatInput" contenteditable="true" class="chat-input-div" 
             placeholder="Ketik pesan atau /gambar: ..."></div>
        <button id="sendButton" onclick="sendMessage()" class="neon-button">SEND</button>
      </div>
    </div>

    <!-- Tab: Try Cari Selisih -->
    <div id="tryCariTab" class="tab-content" style="display: none;">
      <h2 style="color: var(--neon-blue); text-align: center; text-shadow: 0 0 10px rgba(0,255,255,0.9); margin: 20px 0;">
        ðŸ” TRY CARI & ðŸ’° DEPOSIT-WD ANALYZER
      </h2>

      <!-- SUB-MODE SWITCH -->
      <div style="display: flex; justify-content: center; gap: 12px; margin: 15px 0; flex-wrap: wrap;">
        <button class="neon-button sub-mode-btn active" data-mode="tryCari">ðŸ” TRY CARI MANUAL</button>
        <button class="neon-button sub-mode-btn" data-mode="depoWd">ðŸ’° DEPO vs WD</button>
        <button class="neon-button sub-mode-btn" data-mode="extractor">ðŸ“¤ EXTRACT WITHDRAW</button>
      </div>

      <!-- === SUB-MODE 1: TRY CARI (DOCS vs ADMIN) === -->
      <div id="sub-tryCari" class="sub-mode-content" style="display: block; padding: 0 20px;">
        <div style="display: flex; gap: 20px; margin: 20px 0; flex-wrap: wrap;">
          <div style="flex: 1; min-width: 300px;">
            <div style="display: flex; gap: 6px; margin-bottom: 10px; flex-wrap: wrap;">
              <button onclick="clearField('dataDocs'); prosesData_TRYCARI()" class="neon-btn" style="padding:5px 10px; font-size:12px;">ðŸ—‘ï¸ Hapus</button>
              <button onclick="prosesData_TRYCARI()" class="neon-btn" style="padding:5px 10px; font-size:12px;">ðŸ”„ Refresh</button>
            </div>
            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: var(--neon-blue);">ðŸ“„ Data dari DOCS</label>
            <textarea id="dataDocs" placeholder="Paste data DOCS (4 kolom dipisah TAB)..." style="width:100%; height:150px; padding:10px; font-family:monospace; background:rgba(0,10,30,0.8); color:var(--text-main); border:1px solid var(--neon-blue); border-radius:6px; resize:vertical;"></textarea>
          </div>
          <div style="flex: 1; min-width: 300px;">
            <div style="display: flex; gap: 6px; margin-bottom: 10px; flex-wrap: wrap;">
              <button onclick="clearField('dataAdmin'); prosesData_TRYCARI()" class="neon-btn" style="padding:5px 10px; font-size:12px;">ðŸ—‘ï¸ Hapus</button>
              <button onclick="prosesData_TRYCARI()" class="neon-btn" style="padding:5px 10px; font-size:12px;">ðŸ”„ Refresh</button>
            </div>
            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: var(--neon-blue);">ðŸ“Š Data dari ADMIN</label>
            <textarea id="dataAdmin" placeholder="Paste data ADMIN (4 kolom dipisah TAB)..." style="width:100%; height:150px; padding:10px; font-family:monospace; background:rgba(0,10,30,0.8); color:var(--text-main); border:1px solid var(--neon-blue); border-radius:6px; resize:vertical;"></textarea>
          </div>
        </div>
        <button onclick="prosesData_TRYCARI()" style="background:linear-gradient(145deg, #0288d1, #0277bd); color:white; border:none; padding:12px 24px; font-size:16px; border-radius:6px; cursor:pointer; display:block; margin:20px auto; font-weight:bold; box-shadow:0 0 8px #00b0ff; transition:all 0.3s;">
          ðŸ” BANDINGKAN DATA
        </button>
        <div id="hasil_TRYCARI"></div>
      </div>

      <!-- === SUB-MODE 2: DEPOSIT vs WITHDRAW === -->
      <div id="sub-depoWd" class="sub-mode-content" style="display: none; padding: 0 20px;">
        <h3 style="color: var(--neon-blue); text-align: center; margin: 20px 0;">ðŸ’° Analisis DEPOSIT vs WITHDRAW</h3>
        
        <div class="input-section">
          <div class="section">
            <div class="section-title">ðŸ“¥ DATA DEPOSIT</div>
            <textarea id="dataDeposit" placeholder="Contoh: DEPO BCA / NAMA	10000000"></textarea>
            <div class="buttons">
              <button class="neon-btn" onclick="clearDeposit()">ðŸ—‘ï¸ Hapus</button>
              <button class="neon-btn" onclick="loadDeposit()">ðŸ“¥ Ambil Data</button>
            </div>
          </div>
          <div class="section">
            <div class="section-title">ðŸ“¤ DATA WITHDRAW</div>
            <textarea id="dataWithdraw" placeholder="Contoh: KIRIM DANA	10000000	DEPO BCA / NAMA"></textarea>
            <div class="buttons">
              <button class="neon-btn" onclick="clearWithdraw()">ðŸ—‘ï¸ Hapus</button>
              <button class="neon-btn" onclick="loadWithdraw()">ðŸ“¤ Ambil Data</button>
            </div>
          </div>
        </div>
        <div style="text-align: center; margin: 20px 0;">
          <button class="neon-btn" onclick="prosesDepositWithdraw()">âš¡ PROSES ANALISIS</button>
        </div>
        <div id="hasilDepoWd"></div>
      </div>

      <!-- === SUB-MODE 3: EXTRACTOR === -->
      <div id="sub-extractor" class="sub-mode-content" style="display: none; padding: 0 20px;">
        <div class="common-panel">
          <div class="extract-h-title">ðŸ“¤ EXTRACT 100 DATA WITHDRAW (HORIZONTAL)</div>
          <textarea id="bulkExtractInput" class="extract-h-input" placeholder="Tempel data..."></textarea>
          <div class="extract-h-buttons">
            <button class="neon-btn" onclick="clearBulkExtract()">ðŸ—‘ï¸ Hapus Semua</button>
            <button class="neon-btn" onclick="processBulkExtract()">ðŸ” Ambil Data</button>
            <button class="neon-btn" onclick="copyBulkExtracted()">ðŸ“‹ Copy Semua</button>
          </div>
          <div class="extract-h-container" id="bulkResultsContainer"></div>
        </div>
      </div>
    </div>

    <!-- Tab: Pengaturan -->
    <div id="pengaturanTab" class="tab-content" style="display: none;">
      <h3>Pengaturan Line</h3>
      <!-- ðŸŽ¨ TEMA BACKGROUND (3 pilihan) -->
      <div class="neon-toggle-container" style="margin: 15px 0; padding: 15px; background: rgba(0,15,30,0.6); border-radius: 14px; border: 1px solid rgba(0,229,255,0.5);">
        <h4 style="color:#00ffff; margin:0 0 12px; text-align:center; font-size:18px;">ðŸ’€ TEMA BACKGROUND</h4>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:8px 0;">
          <span style="color:#66ffff; font-weight:bold;">ðŸ’€ Darkgray</span>
          <label class="neon-toggle">
            <input type="radio" name="bgTheme" value="bg-default" onchange="setBgTheme('bg-default')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:8px 0;">
          <span style="color:#00ffff; font-weight:bold;">ðŸŒŒ LINE TOGEL</span>
          <label class="neon-toggle">
            <input type="radio" name="bgTheme" value="bg-gradient" onchange="setBgTheme('bg-gradient')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:8px 0;">
          <span style="color:#ffcc00; font-weight:bold;">ðŸª GOKU</span>
          <label class="neon-toggle">
            <input type="radio" name="bgTheme" value="bg-deepspace" onchange="setBgTheme('bg-deepspace')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
      </div>

      <!-- ðŸŽ¨ WARNA TEKS GLOBAL (8 pilihan) -->
      <div class="neon-toggle-container" style="margin: 15px 0; padding: 15px; background: rgba(0,15,30,0.6); border-radius: 14px; border: 1px solid rgba(0,229,255,0.5);">
        <h4 style="color:#00ffff; margin:0 0 12px; text-align:center; font-size:18px;">ðŸ’€ WARNA TEKS</h4>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#00ffff; font-weight:bold;">ðŸ’€ Cyan Neon</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#00ffff" onchange="setTextColor('#00ffff')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#9D00FF; font-weight:bold;">ðŸ’€ Cyber Purple</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#9D00FF" onchange="setTextColor('#9D00FF')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#39FF14; font-weight:bold;">ðŸ’€ Plasma Green</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#39FF14" onchange="setTextColor('#39FF14')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#00ff88; font-weight:bold;">ðŸ’€ Matrix Green</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#00ff88" onchange="setTextColor('#00ff88')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#ffcc00; font-weight:bold;">ðŸ’€ Golden Amber</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#ffcc00" onchange="setTextColor('#ffcc00')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#66ffff; font-weight:bold;">ðŸ’€ Sky Glow</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#66ffff" onchange="setTextColor('#66ffff')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#FF073A; font-weight:bold;">ðŸ’€ Laser Ruby</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#FF073A" onchange="setTextColor('#FF073A')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:6px 0;">
          <span style="color:#ffffff; font-weight:bold;">ðŸ’€ Pure White</span>
          <label class="neon-toggle">
            <input type="radio" name="textColor" value="#ffffff" onchange="setTextColor('#ffffff')">
            <span class="neon-toggle-switch">
              <span class="neon-toggle-knob"></span>
            </span>
          </label>
        </div>
      </div>

      <div id="contentPengaturan"></div>
    </div>

    <!-- Tab: Hadiah Togel -->
    <div id="cekhadiahTab" class="tab-content" style="display:none;">
      <h3>ðŸ’Ž HADIAH TOGEL</h3>
      <div id="hadiahContainer" class="hadiah-container"></div>
    </div>

    <!-- Tab: Report Line -->
    <div id="reportLineTab" class="tab-content" style="display: none;">
      <h3 class="judul-glow">ðŸ’« LINE TOGEL ðŸ’«</h3>
      <div class="report-controls-top">
        <input type="text" id="reportSearch" class="search-input-report" placeholder="ðŸ” Cari di semua kolom..." oninput="searchReportLine()" />
      </div>
      <div class="report-controls-bottom">
        <button onclick="addNewReportRow()" class="btn-tambah-baris-bottom">âž• Tambah Baris Kosong</button>
        <div class="report-card-container" id="reportLineCardContainer">
          <p style="text-align:center; color:#00ffff;">â³ Memuat data...</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Lightbox -->
<div id="lightbox" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); z-index: 10000; flex-direction: column; justify-content: center; align-items: center;">
  <div onclick="hideLightbox()" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer;"></div>
  <div style="position: relative; display: flex; flex-direction: column; align-items: center; max-width: 95%; max-height: 95%;">
    <span onclick="hideLightbox()" style="position: absolute; top: -30px; right: -20px; font-size: 40px; color: #00FFFF; cursor: pointer; text-shadow: 0 0 10px #00ffff;">&times;</span>
    <img id="lightboxImg" src="" alt="Preview Zoom" style="max-width: 100%; max-height: 80vh; transition: transform 0.3s ease; cursor: grab;">
    <div style="margin-top: 20px; display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 15px;">
      <button onclick="changeLightbox(-1)" class="nav-button">Prev</button>
      <button onclick="copyPhotoFromLightbox()" class="action-button">Copy Foto</button>
      <button onclick="changeLightbox(1)" class="nav-button">Next</button>
    </div>
    <div class="zoom-slider-container" style="width: 250px; margin-top: 15px;">
      <input id="zoomSlider" type="range" min="0.5" max="3" step="0.1" value="1" style="width: 100%;">
    </div>
  </div>
</div>

<!-- Toast -->
<div id="toastNotif"></div>

<!-- Sticky Notes FAB & Panel -->
<div id="stickyFab" onclick="toggleStickyPanel()">ðŸ’€</div>
<div id="stickyPanel" style="display: none;">
  <textarea id="stickyInput" placeholder="Tulis Sticky Note..." oninput="autoResize(this)"></textarea>
  <button id="addStickyBtn" onclick="addSticky()">âž• Tambah Sticky</button>
  <div id="stickyList"></div>
</div>

<!-- Scan Scatter Modal -->
<div id="scanScatter2Modal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); z-index: 10001; padding: 10px; box-sizing: border-box;">
  <button onclick="closeScanScatter2Modal()" style="position: absolute; top: 10px; right: 20px; font-size: 32px; color: #00ffff; background: none; border: none; cursor: pointer; z-index: 10002;">&times;</button>
  <h3 style="color: #00ffff; text-align: center; margin-bottom: 15px; font-size: 18px;">ðŸ” Scan Scatter 2</h3>
  <div style="display: flex; gap: 15px; max-width: 100%; width: 95vw; margin: 0 auto; height: 90vh; padding: 0 10px;">
    <div style="flex: 1; display: flex; justify-content: center; align-items: center; min-width: 500px;">
      <img id="scanScatter2Image" src="" style="max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 0 20px cyan;">
    </div>
    <div style="flex: 1; min-width: 400px; max-width: 700px; overflow-y: auto; padding: 20px; background: #001a2d; border-radius: 10px; border: 1px solid #00ffff; box-shadow: 0 0 8px rgba(0,255,255,0.2);">
      <div id="scanScatter2Result" style="color: #00ffff; font-family: monospace; font-size: 16px; line-height: 1.6;"></div>
    </div>
  </div>
</div>

<!-- Bonus Zoom Modal -->
<div id="bonusZoomModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); z-index: 10000; color: #00ffff; padding: 20px; box-sizing: border-box;">
  <button class="close-btn" aria-label="Tutup zoom" onclick="closeBonusZoom()" style="position: absolute; top: 15px; right: 25px; font-size: 32px; background: none; border: none; color: #00ffff; cursor: pointer;">&times;</button>
  <span id="bonusZoomedUserid" class="zoomed-userid" style="display: block; text-align: center; font-size: 20px; margin-bottom: 15px; color: #00ffff;"></span> 
  <div class="zoomed-content-area" style="display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap;">
    <button class="zoom-nav-button" id="bonusPrevZoomBtn" onclick="navigateBonusPackage('prev')" style="background: rgba(0,255,255,0.2); border: 1px solid #00ffff; color: #00ffff; padding: 8px 16px; border-radius: 6px; cursor: pointer;">â†</button>
    <div class="zoomed-content-wrapper" id="bonusZoomedContentWrapper" style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;"></div>
    <button class="zoom-nav-button" id="bonusNextZoomBtn" onclick="navigateBonusPackage('next')" style="background: rgba(0,255,255,0.2); border: 1px solid #00ffff; color: #00ffff; padding: 8px 16px; border-radius: 6px; cursor: pointer;">â†’</button>
  </div>
  <div id="bonusCaption" style="text-align: center; margin-top: 20px; color: #00ffff;">Gunakan tombol navigasi atau panah kiri/kanan pada keyboard.</div>
</div>

<!-- Zoom Transaksi Modal -->
<div id="zoomModal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); z-index: 9999; flex-direction: column; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box;">
  <div id="closeZoomBtn" onclick="closeZoom()" style="position: absolute; top: 20px; right: 30px; font-size: 28px; color: #00ffff; cursor: pointer; user-select: none; font-weight: bold; text-shadow: 0 0 6px cyan;">&times;</div>
  <div style="display: flex; flex: 1; width: 100%; gap: 20px; align-items: center; justify-content: center;">
    <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
      <img id="zoomedImage" src="" style="max-width: 90%; max-height: 80vh; border-radius: 10px; box-shadow: 0 0 20px cyan;">
    </div>
    <div id="kodeHasilZoom" style="flex: 1; color: #00ffff; font-family: monospace; font-weight: bold; white-space: pre-wrap; background: rgba(0,20,40,0.8); border-radius: 12px; padding: 16px; box-shadow: 0 0 15px cyan; max-height: 80vh; overflow-y: auto; font-size: 14px;"></div>
  </div>
  <div style="margin-top: 15px; width: 80%;">
    <input type="text" id="imageUrlZoom" placeholder="Tempel link gambar di sini..."
      style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid cyan; background: rgba(0,20,40,0.9); color: #00ffff; font-size: 14px; text-align: center;">
  </div>
</div>

<!-- Lightbox Modal -->
<div id="lightboxModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9998; flex-direction: column; justify-content: center; align-items: center;">
  <span onclick="closeLightbox()" style="position: absolute; top: 20px; right: 30px; font-size: 28px; color: #00FFFF; cursor: pointer; user-select: none;">&times;</span>
  <img id="lightboxImage" src="" style="max-width: 90%; max-height: 90%; border-radius: 10px; box-shadow: 0 0 20px #00FFFF;">
  <div>
    <button onclick="prevImage()" style="font-size: 16px; padding: 10px 20px; border: 1px solid #00FFFF; background: rgba(255,255,255,0.1); color: #00FFFF; cursor: pointer; border-radius: 5px; margin-top: 20px;">Prev</button>
    <button onclick="nextImage()" style="font-size: 16px; padding: 10px 20px; border: 1px solid #00FFFF; background: rgba(255,255,255,0.1); color: #00FFFF; cursor: pointer; border-radius: 5px; margin-left: 10px; margin-top: 20px;">Next</button>
  </div>
</div>

<script>
// ========================================
// GLOBAL VARIABLES
// ========================================
let currentFolder = 'KENDALA ALL';
let allNotes = [];
let allPasaranList = [];
let lastPrediksiIndex = "";
let lastJadwalIndex = "";
let kelompokData = {};
let lastKelompok = "";
let lastLabel = "";
let lightboxImages = [];
let lightboxIndex = 0;
let zoomLevel = 1;
let offsetX = 0, offsetY = 0;
let isDragging = false;
let startX = 0, startY = 0;
let editIndex = null;
let imageList = [];
let currentImageIndex = 0;
let reportData = [];
let focusRowIndex = null;
window.gambarLinks = [];

// ========================================
// DOM LOADED
// ========================================
document.addEventListener('DOMContentLoaded', () => {
  // Force hide panels that should not appear automatically
  const tanyaZTab = document.getElementById('tanyaZTab');
  if (tanyaZTab) tanyaZTab.style.display = 'none';
  
  const stickyPanel = document.getElementById('stickyPanel');
  if (stickyPanel) stickyPanel.style.display = 'none';

  // Sidebar toggle
  const toggleSidebarBtn = document.getElementById('toggleSidebarBtn');
  const sidebarContainer = document.querySelector('.sidebar-container');
  if (toggleSidebarBtn && sidebarContainer) {
    let sidebarVisible = localStorage.getItem('sidebarVisible') !== 'false';
    sidebarContainer.style.display = sidebarVisible ? 'flex' : 'none';
    toggleSidebarBtn.textContent = sidebarVisible ? 'ðŸ’€' : 'ðŸ’€';
    toggleSidebarBtn.addEventListener('click', () => {
      sidebarVisible = !sidebarVisible;
      sidebarContainer.style.display = sidebarVisible ? 'flex' : 'none';
      toggleSidebarBtn.textContent = sidebarVisible ? 'ðŸ’€' : 'ðŸ’€';
      localStorage.setItem('sidebarVisible', sidebarVisible);
    });
  }

  // Sync saved themes and colors
  const bgSaved = localStorage.getItem('backgroundTheme') || 'bg-default';
  const bgRadio = document.querySelector(`input[name="bgTheme"][value="${bgSaved}"]`);
  if (bgRadio) bgRadio.checked = true;
  setBgTheme(bgSaved);

  const colorSaved = localStorage.getItem('globalTextColor') || '#00ffff';
  const colorRadio = document.querySelector(`input[name="textColor"][value="${colorSaved}"]`);
  if (colorRadio) colorRadio.checked = true;
  setTextColor(colorSaved);

  // Initialize clock
  updateClock();
  setInterval(updateClock, 1000);

  // Setup event listeners
  setupEventListeners();

  // Initialize bonus gallery
  const bonusLinkInput = document.getElementById('bonusLinkInput');
  if (bonusLinkInput) {
    bonusLinkInput.addEventListener('input', handleBonusInput);
  }

  // Initialize tanggal pasaran
  initTanggalPasaran();
});

// ========================================
// THEME & COLOR FUNCTIONS
// ========================================
function setBgTheme(theme) {
  document.body.className = theme;
  localStorage.setItem('backgroundTheme', theme);
}

function setTextColor(color) {
  localStorage.setItem('globalTextColor', color);
  document.documentElement.style.setProperty('--txt-main', color);
  document.documentElement.style.setProperty('--txt-highlight', color);
  
  // Update all relevant elements
  const updatable = document.querySelectorAll(`
    .note-title, .note-content-preview, .judul-glow, h3, h4, label,
    .neon-button, .copy-button, .btn-action, #clock,
    input, textarea, select, .pasaran-dropdown, .hitung-dropdown,
    .report-display-value, .report-edit-input, .chat-input-div,
    .bonus-title, .foto-title, .message-bubble
  `);
  updatable.forEach(el => el.style.color = color);
}

// ========================================
// CLOCK FUNCTION
// ========================================
function updateClock() {
  const now = new Date();
  const dateStr = now.toLocaleDateString('id-ID', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' });
  const timeStr = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
  document.getElementById('clock').innerHTML = `<span>${dateStr}</span><br><span>${timeStr}</span>`;
}

// ========================================
// TAB MANAGEMENT
// ========================================
function showTab(tabId, button) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.neon-button').forEach(b => b.classList.remove('active'));
  document.getElementById(tabId)?.classList.add('active');
  button?.classList.add('active');
  
  // Special actions for certain tabs
  if (tabId === 'prediksiGabungTab') {
    loadPasaranTogel();
    loadCaraHitungTogel();
  }
}

// ========================================
// LIGHTBOX FUNCTIONS
// ========================================
function hideLightbox() {
  document.getElementById('lightbox').style.display = 'none';
}

function showLightbox(src) {
  document.getElementById('lightboxImg').src = src;
  document.getElementById('lightbox').style.display = 'flex';
}

function changeLightbox(dir) {
  lightboxIndex += dir;
  if (lightboxIndex < 0) lightboxIndex = lightboxImages.length - 1;
  if (lightboxIndex >= lightboxImages.length) lightboxIndex = 0;
  const imgEl = document.getElementById('lightboxImg');
  if (imgEl) imgEl.src = lightboxImages[lightboxIndex];
  resetZoomAndPosition();
}

function resetZoomAndPosition() {
  zoomLevel = 1;
  offsetX = 0;
  offsetY = 0;
  applyTransform();
  const zoomSlider = document.getElementById('zoomSlider');
  if (zoomSlider) zoomSlider.value = zoomLevel;
}

function applyTransform() {
  const imgEl = document.getElementById('lightboxImg');
  if (!imgEl) return;
  imgEl.style.transform = `scale(${zoomLevel}) translate(${offsetX}px, ${offsetY}px)`;
}

function zoomLightbox(factor) {
  zoomLevel *= factor;
  zoomLevel = Math.min(Math.max(zoomLevel, 0.5), 5);
  applyTransform();
  const zoomSlider = document.getElementById('zoomSlider');
  if (zoomSlider) zoomSlider.value = zoomLevel;
}

function startDrag(clientX, clientY) {
  if (zoomLevel <= 1) return;
  isDragging = true;
  startX = clientX - offsetX;
  startY = clientY - offsetY;
  const imgEl = document.getElementById('lightboxImg');
  if (imgEl) imgEl.style.cursor = 'grabbing';
}

function moveDrag(clientX, clientY) {
  if (!isDragging) return;
  offsetX = clientX - startX;
  offsetY = clientY - startY;
  applyTransform();
}

function endDrag() {
  isDragging = false;
  const imgEl = document.getElementById('lightboxImg');
  if (imgEl) imgEl.style.cursor = 'grab';
}

// ========================================
// EVENT LISTENERS
// ========================================
function setupEventListeners() {
  // Sub-mode buttons
  document.querySelectorAll('.sub-mode-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      document.querySelectorAll('.sub-mode-btn').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      document.querySelectorAll('.sub-mode-content').forEach(el => el.style.display = 'none');
      document.getElementById('sub-' + this.dataset.mode).style.display = 'block';
    });
  });

  // Lightbox event listeners
  const lightboxEl = document.getElementById('lightbox');
  const imgEl = document.getElementById('lightboxImg');
  const zoomSlider = document.getElementById('zoomSlider');
  if (lightboxEl && imgEl) {
    if (zoomSlider) {
      zoomSlider.addEventListener('input', () => {
        zoomLevel = parseFloat(zoomSlider.value);
        applyTransform();
      });
    }
    lightboxEl.addEventListener('wheel', e => {
      e.preventDefault();
      zoomLightbox(e.deltaY < 0 ? 1.1 : 0.9);
    });
    imgEl.addEventListener('mousedown', e => {
      startDrag(e.clientX, e.clientY);
      e.preventDefault();
    });
    imgEl.addEventListener('touchstart', e => {
      startDrag(e.touches[0].clientX, e.touches[0].clientY);
    });
    imgEl.addEventListener('touchmove', e => {
      moveDrag(e.touches[0].clientX, e.touches[0].clientY);
      e.preventDefault();
    });
    imgEl.addEventListener('touchend', endDrag);
    imgEl.addEventListener('dblclick', () => zoomLightbox(1.5));
    lightboxEl.addEventListener('click', e => {
      if (e.target === lightboxEl) hideLightbox();
    });
  }

  // Mouse and touch event listeners
  window.addEventListener('mousemove', e => moveDrag(e.clientX, e.clientY));
  window.addEventListener('mouseup', endDrag);

  // Keyboard event listener
  document.addEventListener('keydown', e => {
    if (lightboxEl && lightboxEl.style.display === 'flex') {
      switch (e.key) {
        case 'ArrowLeft': changeLightbox(-1); break;
        case 'ArrowRight': changeLightbox(1); break;
        case 'Escape': hideLightbox(); break;
        case '+': zoomLightbox(1.2); break;
        case '-': zoomLightbox(0.8); break;
      }
    }
  });

  // Scan Scatter button event listeners
  document.querySelectorAll('[id^="bonusScatter2_"]').forEach(input => {
    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        const index = input.id.split('_')[1];
        scanScatter2(index);
      }
    });
  });
}

// ========================================
// TOAST NOTIFICATION
// ========================================
function showToast(message) {
  const toast = document.getElementById('toastNotif');
  if (toast) {
    toast.textContent = message;
    toast.style.display = 'block';
    setTimeout(() => toast.style.display = 'none', 3000);
  }
}

// ========================================
// STICKY NOTES
// ========================================
function toggleStickyPanel() {
  const panel = document.getElementById("stickyPanel");
  panel.style.display = panel.style.display === "block" ? "none" : "block";
  loadStickyNotes();
}

function autoResize(el) {
  el.style.height = "auto";
  el.style.height = el.scrollHeight + "px";
}

async function addSticky() {
  const input = document.getElementById("stickyInput");
  const text = input.value.trim();
  const image = input.dataset.image || null;
  if (!text && !image) return;
  let stickies = JSON.parse(localStorage.getItem("stickies") || "[]");
  if (editIndex !== null) {
    stickies[editIndex] = { text, image };
    editIndex = null;
    document.querySelector("#stickyPanel button").textContent = "âž• Tambah Sticky";
  } else {
    stickies.push({ text, image });
  }
  localStorage.setItem("stickies", JSON.stringify(stickies));
  input.value = "";
  input.dataset.image = "";
  autoResize(input);
  loadStickyNotes();
}

function loadStickyNotes() {
  const list = document.getElementById("stickyList");
  if (!list) return;
  list.innerHTML = "";
  const stickies = JSON.parse(localStorage.getItem("stickies") || "[]");
  stickies.forEach((note, i) => {
    const div = document.createElement("div");
    div.className = "sticky-card";
    div.dataset.index = i;
    if (note.text) {
      const p = document.createElement("p");
      p.textContent = note.text;
      div.appendChild(p);
    }
    if (note.image) {
      const img = document.createElement("img");
      img.src = note.image;
      div.appendChild(img);
    }
    div.onclick = async() => {
      try {
        const items = {};
        if (note.text) items["text/plain"] = new Blob([note.text], { type: "text/plain" });
        if (note.image) {
          const resp = await fetch(note.image);
          const blob = await resp.blob();
          items[blob.type] = blob;
        }
        await navigator.clipboard.write([new ClipboardItem(items)]);
        showToast("âœ… Teks + Gambar disalin!");
      } catch {
        showToast("âš  Gagal menyalin");
      }
    };
    const del = document.createElement("span");
    del.textContent = "âœ–";
    del.className = "sticky-delete";
    del.onclick = e => {
      e.stopPropagation();
      deleteSticky(i);
    };
    const edit = document.createElement("span");
    edit.textContent = "âœï¸";
    edit.className = "sticky-edit";
    edit.onclick = e => {
      e.stopPropagation();
      editSticky(i);
    };
    div.appendChild(del);
    div.appendChild(edit);
    div.setAttribute("draggable", true);
    div.ondragstart = e => e.dataTransfer.setData("text/plain", i);
    div.ondragover = e => {
      e.preventDefault();
      div.style.border = "2px dashed #00ffff";
    };
    div.ondragleave = () => div.style.border = "1px solid #00ffff";
    div.ondrop = e => {
      e.preventDefault();
      div.style.border = "1px solid #00ffff";
      reorderSticky(e.dataTransfer.getData("text/plain"), i);
    };
    list.appendChild(div);
  });
}

function reorderSticky(from, to) {
  let stickies = JSON.parse(localStorage.getItem("stickies") || "[]");
  const moved = stickies.splice(from, 1)[0];
  stickies.splice(to, 0, moved);
  localStorage.setItem("stickies", JSON.stringify(stickies));
  loadStickyNotes();
}

function deleteSticky(i) {
  let stickies = JSON.parse(localStorage.getItem("stickies") || "[]");
  stickies.splice(i, 1);
  localStorage.setItem("stickies", JSON.stringify(stickies));
  loadStickyNotes();
}

function editSticky(i) {
  const stickies = JSON.parse(localStorage.getItem("stickies") || "[]");
  const input = document.getElementById("stickyInput");
  input.value = stickies[i].text || "";
  input.dataset.image = stickies[i].image || "";
  autoResize(input);
  editIndex = i;
  document.querySelector("#stickyPanel button").textContent = "Simpan Perubahan";
}

// ========================================
// COPY FUNCTIONS
// ========================================
function copyToClipboard(text) {
  if (typeof text !== 'string') {
    showToast("âŒ Input tidak valid untuk disalin");
    return;
  }
  navigator.clipboard.writeText(text).then(() => {
    showToast("âœ… Teks berhasil disalin!");
  }).catch(err => {
    console.error("Gagal menyalin:", err);
    // Fallback method
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.left = '-9999px';
    document.body.appendChild(textarea);
    textarea.select();
    try {
      document.execCommand('copy');
      showToast("âœ… Teks berhasil disalin (fallback)!");
    } catch (err) {
      showToast("âŒ Gagal menyalin teks");
    }
    document.body.removeChild(textarea);
  });
}

function copyPhotoFromLightbox() {
  const lightboxImg = document.getElementById('lightboxImg');
  if (!lightboxImg || !lightboxImg.src) {
    showToast('â— Gambar tidak ditemukan.');
    return;
  }
  // In a real app, this would use the Clipboard API with image data
  showToast('âœ… Foto berhasil disalin! (Fitur penuh memerlukan HTTPS)');
}

// ========================================
// BONUS EVENT FUNCTIONS
// ========================================
function switchBonusMode(mode) {
  document.getElementById('modeBonusAsli').style.display = 'none';
  document.getElementById('modeGaleri').style.display = 'none';
  document.getElementById('modeInputScatter').style.display = 'none';
  
  if (mode === 'bonusAsli') {
    document.getElementById('modeBonusAsli').style.display = 'block';
  } else if (mode === 'galeri') {
    document.getElementById('modeGaleri').style.display = 'block';
    loadBonusImages();
  } else if (mode === 'inputScatter') {
    document.getElementById('modeInputScatter').style.display = 'block';
  }
  
  document.querySelectorAll('.neon-switch-btn').forEach(btn => btn.classList.remove('active'));
  const activeBtn = Array.from(document.querySelectorAll('.neon-switch-btn')).find(btn =>
    btn.textContent.includes(mode === 'bonusAsli' ? 'Cek Bonus' : mode === 'galeri' ? 'Galeri' : 'Input Scatter')
  );
  if (activeBtn) activeBtn.classList.add('active');
}

function hitungBonusEvent() {
  const textarea = document.getElementById("bonusTextarea");
  const patokanInput = document.getElementById("bonusPatokan");
  const surplusInput = document.getElementById("bonusSurplus");
  const hasilDiv = document.getElementById("bonusHasil");
  if (!textarea.value.trim()) {
    showToast("â— Tempelkan data transaksi terlebih dahulu.");
    return;
  }
  const patokan = parseInt(patokanInput.value.replace(/[^\d]/g, '')) || 0;
  const surplus = parseInt(surplusInput.value.replace(/[^\d]/g, '')) || 0;
  const total = 12500000; // Simulated total
  const totalPengurang = patokan + surplus;
  const selisih = total - totalPengurang;
  let output = `ðŸ’° <span style="color: var(--neon-yellow);">Total Hitungan:</span> <span class="bonus-angka">IDR ${total.toLocaleString("id-ID")}</span>`;
  if (patokan || surplus) {
    output += `<br>ðŸ“¦ <span style="color: var(--neon-yellow);">Patokan:</span> <span class="bonus-angka">IDR ${patokan.toLocaleString("id-ID")}</span>`;
    output += `<br>ðŸ“Œ <span style="color: var(--neon-yellow);">Surplus:</span> <span class="bonus-angka">IDR ${surplus.toLocaleString("id-ID")}</span>`;
    output += `<br>âž– <span style="color: var(--neon-yellow);">Total Dikurang:</span> <span class="bonus-angka">IDR ${totalPengurang.toLocaleString("id-ID")}</span>`;
    output += `<br>ðŸ“ <span style="color: var(--neon-yellow);">Selisih:</span> <span class="bonus-angka" style="color: ${selisih === 0 ? '#00ff88' : selisih > 0 ? '#ffcc00' : '#ff6666'}">IDR ${Math.abs(selisih).toLocaleString("id-ID")}</span>`;
  }
  hasilDiv.innerHTML = output;
  showToast("âœ… Perhitungan bonus berhasil!");
}

function hapusBonusEvent() {
  document.getElementById("bonusTextarea").value = "";
  document.getElementById("bonusPatokan").value = "";
  document.getElementById("bonusSurplus").value = "";
  document.getElementById("bonusHasil").innerHTML = "Hasil perhitungan akan muncul di sini";
  showToast("ðŸ§¹ Form berhasil dibersihkan!");
}

// ========================================
// BONUS GALLERY FUNCTIONS
// ========================================
function handleBonusInput() {
  const inputEl = document.getElementById('bonusLinkInput');
  if (!inputEl) return;
  const input = inputEl.value || '';
  const lines = input.split('\n').map(l => l.trim()).filter(l => l.length > 0);
  bonusAllPackagesData = [];
  lines.forEach(line => {
    const words = line.split(/\s+/).filter(w => w.length > 0);
    const urls = words.filter(w => /^https?:\/\//.test(w));
    const userid = words.length > 0 && !/^https?:\/\//.test(words[0]) ? words[0] : 'N/A';
    if (urls.length >= 1) {
      const links = [...urls.slice(0, 3)];
      while (links.length < 3) links.push('');
      bonusAllPackagesData.push({ userid, links });
    }
  });
  document.getElementById('bonusMaxPackageNum').textContent = bonusAllPackagesData.length;
  if (bonusAllPackagesData.length > 0) {
    bonusCurrentPackageIndex = Math.max(0, Math.min(bonusCurrentPackageIndex, bonusAllPackagesData.length - 1));
    updateBonusGallery(bonusCurrentPackageIndex);
  } else {
    updateBonusGallery(-1);
    document.getElementById('bonusCurrentPackageNum').textContent = '0';
  }
}

function updateBonusGallery(index) {
  const slots = ['bonusImgSlot1', 'bonusImgSlot2', 'bonusImgSlot3'].map(id => document.getElementById(id));
  const useridEl = document.getElementById('bonusCombinedSlotUserid');
  const currentNumEl = document.getElementById('bonusCurrentPackageNum');
  if (index >= 0 && index < bonusAllPackagesData.length) {
    const { userid, links } = bonusAllPackagesData[index];
    if (useridEl) useridEl.textContent = `USER ID: ${userid}`;
    slots.forEach((img, i) => {
      if (!img) return;
      const src = links[i] || "https://via.placeholder.com/180x160/0a1a2f/555?text=-";
      img.src = src;
      img.style.opacity = links[i] ? '1' : '0.4';
    });
    if (currentNumEl) currentNumEl.textContent = index + 1;
  } else {
    if (useridEl) useridEl.textContent = 'Belum Ada Data';
    slots.forEach((img, i) => {
      if (!img) return;
      img.src = "https://via.placeholder.com/180x160/0a1a2f/555?text=-";
      img.style.opacity = '0.4';
    });
    if (currentNumEl) currentNumEl.textContent = '0';
  }
}

function openBonusZoom() {
  if (bonusAllPackagesData.length === 0) return;
  const current = bonusAllPackagesData[bonusCurrentPackageIndex];
  if (!current.links.some(l => l)) return;
  showToast(`ðŸ–¼ï¸ Membuka galeri untuk ${current.userid}`);
}

function clearBonusAllData() {
  bonusAllPackagesData = [];
  document.getElementById('bonusLinkInput').value = '';
  updateBonusGallery(-1);
  document.getElementById('bonusMaxPackageNum').textContent = '0';
  showToast("âœ… Semua data galeri telah dihapus!");
}

// ========================================
// SCAN SCATTER FUNCTIONS
// ========================================
function scanScatter2(index) {
  const link = document.getElementById(`bonusScatter2_${index}`).value.trim();
  if (!link) {
    showToast("âŒ Masukkan link Scatter 2 terlebih dahulu!");
    return;
  }
  showToast(`ðŸ” Memproses gambar dari link: ${link.substring(0, 30)}...`);
  // Simulate OCR result after delay
  setTimeout(() => {
    const randomCode = `KODE${Math.floor(100000 + Math.random() * 900000)}`;
    document.getElementById(`bonusKodeTransaksi${index}`).value = randomCode;
    showToast(`âœ… Kode transaksi untuk Data ${index} ditemukan: ${randomCode}`);
  }, 1500);
}

// ========================================
// DEPO-WD ANALYSIS
// ========================================
const BANK_LIST = ['BCA','BRI','BNI','CIMB','DANAMON','BSI','DANA','OVO','LINKAJA','GOPAY','JAGO','MAYBANK','SEABANK','MANDIRI','QRIS'];
let modePerBank = false;

function formatRupiah(n) {
  if (!n) return '0';
  return new Intl.NumberFormat('id-ID').format(n);
}

function detectBank(t) {
  const u = (t || '').toUpperCase();
  return BANK_LIST.find(b => u.includes(b)) || 'LAINNYA';
}

function extractName(t) {
  let c = t.trim(), i = c.toUpperCase().indexOf('DEPO ');
  if (i !== -1) c = c.substring(i + 5).trim();
  const s = c.lastIndexOf('/');
  return s !== -1 ? c.substring(s + 1).trim() : c;
}

function parseLine(l, isWd = false) {
  l = l.trim();
  if (!l) return null;
  const p = l.split('\t').map(x => x.trim()).filter(x => x);
  if (p.length < 2) return null;
  if (isWd) {
    const [k, nRaw, src] = p;
    const num = parseInt(nRaw.replace(/[^0-9]/g, '')) || 0;
    return { nama: extractName(src || k), bank: detectBank(src || k), nominalRaw: formatRupiah(num), nominalClean: num, asli: l, note: k };
  } else {
    const [desc, nRaw] = p;
    const num = parseInt(nRaw.replace(/[^0-9]/g, '')) || 0;
    return { nama: extractName(desc), bank: detectBank(desc), nominalRaw: formatRupiah(num), nominalClean: num, asli: l, note: '' };
  }
}

function prosesDepositWithdraw() {
  const dEl = document.getElementById('dataDeposit');
  const wEl = document.getElementById('dataWithdraw');
  if (!dEl || !wEl) return;
  const d = dEl.value.trim();
  const w = wEl.value.trim();
  if (!d || !w) {
    showToast("âš ï¸ Harap isi kedua kolom!", "warning");
    return;
  }
  const depo = d.split('\n').map(l => parseLine(l, false)).filter(Boolean);
  const wd = w.split('\n').map(l => parseLine(l, true)).filter(Boolean);
  if (!depo.length || !wd.length) {
    showToast("âŒ Format data tidak valid!", "error");
    return;
  }
  modePerBank ? analisisPerBank(depo, wd) : analisisPerPengguna(depo, wd);
}

function analisisPerPengguna(depo, wd) {
  const dTot = {}, wTot = {}, dDet = {}, wDet = {};
  depo.forEach(i => {
    const k = i.nama.toLowerCase().trim();
    dTot[k] = (dTot[k] || 0) + i.nominalClean;
    (dDet[k] = dDet[k] || []).push(i);
  });
  wd.forEach(i => {
    const k = i.nama.toLowerCase().trim();
    wTot[k] = (wTot[k] || 0) + i.nominalClean;
    (wDet[k] = wDet[k] || []).push(i);
  });
  const names = [...new Set([...Object.keys(dTot), ...Object.keys(wTot)])];
  const results = names.map(k => {
    const n = dDet[k] ? depo.find(x => x.nama.toLowerCase() === k)?.nama : wd.find(x => x.nama.toLowerCase() === k)?.nama || k;
    const d = dTot[k] || 0, w = wTot[k] || 0, diff = d - w;
    let selisihKet, selisihClass;
    if (d > 0 && w > 0) {
      if (diff === 0) { selisihKet = "âœ… COCOK"; selisihClass = "selisih-cocok"; }
      else if (diff > 0) { selisihKet = "âš ï¸ KELEBIHAN DEPOSIT"; selisihClass = "selisih-lebih"; }
      else { selisihKet = "âš ï¸ KEKURANGAN DEPOSIT"; selisihClass = "selisih-kurang"; }
    } else {
      selisihKet = "âŒ TIDAK LENGKAP"; selisihClass = "selisih-kurang";
    }
    return { nama: n, depo: d, wd: w, diff, selisihKet, selisihClass, dEntries: dDet[k] || [], wEntries: wDet[k] || [] };
  });
  renderPerPengguna(results);
}

function analisisPerBank(depo, wd) {
  const dByBank = {}, wByBank = {}, dEntries = {}, wEntries = {};
  [...BANK_LIST, 'LAINNYA'].forEach(b => {
    dByBank[b] = 0; wByBank[b] = 0; dEntries[b] = []; wEntries[b] = [];
  });
  depo.forEach(i => { dByBank[i.bank] += i.nominalClean; dEntries[i.bank].push(i); });
  wd.forEach(i => { wByBank[i.bank] += i.nominalClean; wEntries[i.bank].push(i); });
  const results = [...BANK_LIST, 'LAINNYA']
    .map(bank => {
      const d = dByBank[bank], w = wByBank[bank], diff = d - w;
      if (d === 0 && w === 0) return null;
      let selisihKet, selisihClass;
      if (d > 0 && w > 0) {
        if (diff === 0) { selisihKet = "âœ… COCOK"; selisihClass = "selisih-cocok"; }
        else if (diff > 0) { selisihKet = "âš ï¸ KELEBIHAN DEPOSIT"; selisihClass = "selisih-lebih"; }
        else { selisihKet = "âš ï¸ KEKURANGAN DEPOSIT"; selisihClass = "selisih-kurang"; }
      } else {
        selisihKet = "âŒ TIDAK LENGKAP"; selisihClass = "selisih-kurang";
      }
      return { bank, depo: d, wd: w, diff, selisihKet, selisihClass, dEntries: dEntries[bank], wEntries: wEntries[bank] };
    })
    .filter(Boolean);
  renderPerBank(results);
}

function renderPerPengguna(results) {
  const container = document.getElementById('hasilDepoWd');
  if (!container) return;
  let html = `<div class="depo-wd-container">`;
  results.forEach(r => {
    const depoFmt = r.depo > 0 ? formatRupiah(r.depo) : 'â€“';
    const wdFmt = r.wd > 0 ? formatRupiah(r.wd) : 'â€“';
    const diff = r.diff;
    const diffFmt = diff === 0 ? '0' : (diff > 0 ? `+${formatRupiah(diff)}` : `-${formatRupiah(Math.abs(diff))}`);
    // Status badge
    let statusClass = 'status-cocok';
    let statusText = 'âœ… COCOK';
    if (diff !== 0 && r.depo > 0 && r.wd > 0) {
      statusClass = diff > 0 ? 'status-lebih' : 'status-kurang';
      statusText = diff > 0 ? 'âš ï¸ KELEBIHAN' : 'âš ï¸ KEKURANGAN';
    } else if (r.depo === 0 || r.wd === 0) {
      statusClass = 'status-kurang';
      statusText = 'âŒ TIDAK LENGKAP';
    }
    // Deskripsi deposit (ambil dari entri pertama)
    const depoDesc = r.dEntries.length ? r.dEntries[0].asli.split('\t')[0] || '' : '';
    const withDesc = r.wEntries.length ? r.wEntries[0].asli.split('\t')[0] || '' : '';
    html += `
    <div class="user-card-compact">
      <div class="user-header-compact">${r.nama}</div>
      <div class="depo-withdraw-grid">
        <div class="depo-col">
          <h3>DEPOSIT</h3>
          <div class="amount-value">${depoFmt}</div>
          <div class="desc-text">${depoDesc}</div>
          <div class="total-row">TOTAL: <span>${depoFmt}</span></div>
        </div>
        <div class="with-col">
          <h3>WITHDRAW</h3>
          <div class="amount-value">${wdFmt}</div>
          <div class="desc-text">${withDesc}</div>
          <div class="total-row">TOTAL: <span>${wdFmt}</span></div>
        </div>
      </div>
      <div class="status-badge ${statusClass}">
        ${statusText}
        <div class="diff-value">${diffFmt}</div>
      </div>
    </div>`;
  });
  html += '</div>';
  container.innerHTML = html;
}

function renderPerBank(results) {
  const container = document.getElementById('hasilDepoWd');
  if (!container) return;
  let html = `<div class="depo-wd-container"><div class="summary-box"><strong>ðŸ“Š Total Bank/Sumber:</strong> ${results.length}</div>`;
  results.forEach(r => {
    const depoFmt = r.depo > 0 ? formatRupiah(r.depo) : 'â€“';
    const wdFmt = r.wd > 0 ? formatRupiah(r.wd) : 'â€“';
    const selisihNum = r.diff === 0 ? '0' : (r.diff > 0 ? `+${formatRupiah(r.diff)}` : `-${formatRupiah(Math.abs(r.diff))}`);
    html += `
    <div class="bank-card">
      <div class="card-header">ðŸ¦ ${r.bank}</div>
      <div class="card-body">
        <div class="col">
          <div class="col-title"><span>ðŸ“¥ DEPOSIT</span></div>
          <ul class="entry-list">
            ${r.dEntries.length ? r.dEntries.map(e => `<li class="entry-item">${e.nominalRaw}</li>`).join('') : '<li class="entry-item">â€“</li>'}
          </ul>
          <div class="total-row">
            <span class="total-label">TOTAL:</span>
            <span class="total-value deposit-color">${depoFmt}</span>
          </div>
        </div>
        <div class="col">
          <div class="col-title"><span>ðŸ“¤ WITHDRAW</span></div>
          <ul class="entry-list">
            ${r.wEntries.length ? r.wEntries.map(e => `
            <li class="entry-item">
              <span class="nominal">${e.nominalRaw}</span>
              ${e.note ? `<div class="withdraw-note">${e.note}</div>` : ''}
            </li>
            `).join('') : '<li class="entry-item">â€“</li>'}
          </ul>
          <div class="total-row">
            <span class="total-label">TOTAL:</span>
            <span class="total-value withdraw-color">${wdFmt}</span>
          </div>
        </div>
      </div>
      <div class="selisih-besar ${r.selisihClass}">${r.selisihKet}</div>
      <div class="selisih-jumlah ${r.selisihClass}">${selisihNum}</div>
    </div>`;
  });
  html += '</div>';
  container.innerHTML = html;
}

// ========================================
// TRY CARI FUNCTIONS
// ========================================
function parseData_TRYCARI(raw) {
  return raw
    .split('\n')
    .map(line => line.trim())
    .filter(line => line)
    .map(line => {
      const parts = line.split('\t').map(p => p.trim());
      if (parts.length >= 4) {
        return {
          jam: parts[0],
          userID: parts[1],
          nama: parts[2],
          nominal: parts[3]
        };
      }
      return null;
    })
    .filter(row => row !== null);
}

function prosesData_TRYCARI() {
  const docsEl = document.getElementById('dataDocs');
  const adminEl = document.getElementById('dataAdmin');
  if (!docsEl || !adminEl) return;
  const rawDataDocs = docsEl.value;
  const rawDataAdmin = adminEl.value;
  if (!rawDataDocs.trim() || !rawDataAdmin.trim()) {
    const hasil = document.getElementById('hasil_TRYCARI');
    if (hasil) hasil.innerHTML = '';
    showToast("âš ï¸ Harap paste data di kedua kolom!", "warning");
    return;
  }
  const dataDocs = parseData_TRYCARI(rawDataDocs);
  const dataAdmin = parseData_TRYCARI(rawDataAdmin);
  if (dataDocs.length === 0 || dataAdmin.length === 0) {
    const hasil = document.getElementById('hasil_TRYCARI');
    if (hasil) hasil.innerHTML = '';
    showToast("âŒ Format data tidak valid! Pastikan tiap baris punya 4 kolom (dipisah TAB).", "error");
    return;
  }
  const adminKeyList = dataAdmin.map(row => {
    const userIDClean = String(row.userID).toLowerCase().trim();
    const nominalClean = String(row.nominal).replace(/[^0-9]/g, '');
    return `${userIDClean}|${nominalClean}`;
  });
  const adminCountMap = {};
  adminKeyList.forEach(key => {
    adminCountMap[key] = (adminCountMap[key] || 0) + 1;
  });
  const adminNominalMap = {};
  dataAdmin.forEach(row => {
    const userIDClean = String(row.userID).toLowerCase().trim();
    const nominalClean = String(row.nominal).replace(/[^0-9]/g, '');
    const key = `${userIDClean}|${nominalClean}`;
    if (!adminNominalMap[key]) {
      adminNominalMap[key] = row.nominal;
    }
  });
  const results = [];
  dataDocs.forEach(row => {
    const { jam, userID, nama, nominal } = row;
    const userIDClean = String(userID).toLowerCase().trim();
    const nominalClean = String(nominal).replace(/[^0-9]/g, '');
    const key = `${userIDClean}|${nominalClean}`;
    let status, kelas, nominalDiAdmin = 'â€“';
    if (adminCountMap[key] > 0) {
      adminCountMap[key]--;
      status = 'âœ… COCOK';
      kelas = 'background-color:#2e7d32;color:white;';
      nominalDiAdmin = adminNominalMap[key] || nominal;
    } else {
      status = 'âŒ TIDAK COCOK';
      kelas = 'background-color:#b71c1c;color:white;';
    }
    results.push({ jam, userID, nama, nominal, nominalDiAdmin, status, kelas });
  });
  const usageCount = {};
  adminKeyList.forEach(key => {
    usageCount[key] = (usageCount[key] || 0) + 1;
  });
  for (const key in adminCountMap) {
    const used = (usageCount[key] || 0) - adminCountMap[key];
    usageCount[key] = used;
  }
  const adminRowsWithStatus = dataAdmin.map(row => {
    const userIDClean = String(row.userID).toLowerCase().trim();
    const nominalClean = String(row.nominal).replace(/[^0-9]/g, '');
    const key = `${userIDClean}|${nominalClean}`;
    const isUsed = usageCount[key] > 0;
    if (isUsed) usageCount[key]--;
    return { ...row, isUsed };
  });
  const unusedNotesAdmin = [];
  for (const key in adminCountMap) {
    if (adminCountMap[key] > 0) {
      const [userID, cleanNom] = key.split('|');
      const nominalAsli = adminNominalMap[key] || new Intl.NumberFormat('id-ID').format(parseInt(cleanNom));
      unusedNotesAdmin.push(`User <strong>${userID}</strong> dengan nominal <strong>${nominalAsli}</strong> â†’ ${adminCountMap[key]} entri tidak digunakan.`);
    }
  }
  const unusedNotesDocs = results
    .filter(row => row.status === 'âŒ TIDAK COCOK')
    .map(row => `User <strong>${row.userID}</strong> dengan nominal <strong>${row.nominal}</strong> (${row.jam})`);
  const totalDocs = dataDocs.length;
  const totalAdmin = dataAdmin.length;
  const totalCocok = results.filter(r => r.status === 'âœ… COCOK').length;
  const totalTidakCocok = totalDocs - totalCocok;
  let html = `<div style="display:flex; gap:20px; flex-wrap:wrap;">`;
  html += `
  <div style="flex:1; min-width:300px; background:var(--panel-bg); padding:15px; border-radius:8px; border:1px solid var(--panel-border); box-shadow:0 0 8px var(--panel-shadow);">
    <h3 style="color:var(--neon-blue); text-align:center; margin-top:0; padding-bottom:8px; border-bottom:1px solid var(--panel-border); text-shadow:0 0 10px rgba(0,255,255,0.9);">
      ðŸ“„ DATA DOCS (Dengan Analisis)
    </h3>
    <table style="width:100%; border-collapse:collapse; font-size:13px;">
      <thead>
        <tr>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">JAM</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">USER ID</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">NOMINAL</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">NOMINAL DI ADMIN</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">STATUS</th>
        </tr>
      </thead>
      <tbody>`;
  results.forEach(row => {
    html += `
    <tr style="${row.kelas}">
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-family:monospace; color:var(--text-main);">${row.jam}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-weight:bold;">${row.userID}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-family:monospace;">${row.nominal}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-family:monospace;">${row.nominalDiAdmin}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border);">${row.status}</td>
    </tr>`;
  });
  html += `</tbody></table>`;
  html += `
  <div style="margin-top:14px; padding:12px; background:rgba(0,15,30,0.7); border-radius:6px; color:var(--text-main); font-size:13px; line-height:1.5;">
    <strong>ðŸ“Š Ringkasan:</strong><br>
    â€¢ Total entri DOCS: <strong>${totalDocs}</strong><br>
    â€¢ Total entri ADMIN: <strong>${totalAdmin}</strong><br>
    â€¢ <span style="color:var(--neon-green);">âœ… COCOK: ${totalCocok}</span><br>
    â€¢ <span style="color:var(--neon-red);">âŒ TIDAK COCOK: ${totalTidakCocok}</span>
  </div>`;
  if (unusedNotesDocs.length > 0) {
    html += `
    <div style="margin-top:12px; padding:12px; background:rgba(0,20,40,0.7); border-left:4px solid var(--neon-red); border-radius:4px; color:#ffebee; font-size:13px; line-height:1.5;">
      <strong>âš ï¸ Entri DOCS yang Tidak Terpakai:</strong><br>
      ${unusedNotesDocs.map(n => `â€¢ ${n}`).join('<br>')}
    </div>`;
  }
  if (unusedNotesAdmin.length > 0) {
    html += `
    <div style="margin-top:12px; padding:12px; background:rgba(0,20,40,0.7); border-left:4px solid var(--neon-yellow); border-radius:4px; color:var(--text-main); font-size:13px; line-height:1.5;">
      <strong>â„¹ï¸ Entri ADMIN yang Tidak Terpakai:</strong><br>
      ${unusedNotesAdmin.map(n => `â€¢ ${n}`).join('<br>')}
    </div>`;
  }
  html += `</div>`;
  html += `
  <div style="flex:1; min-width:300px; background:var(--panel-bg); padding:15px; border-radius:8px; border:1px solid var(--panel-border); box-shadow:0 0 8px var(--panel-shadow);">
    <h3 style="color:var(--neon-blue); text-align:center; margin-top:0; padding-bottom:8px; border-bottom:1px solid var(--panel-border); text-shadow:0 0 10px rgba(0,255,255,0.9);">
      ðŸ“Š DATA ADMIN (Referensi)
    </h3>
    <table style="width:100%; border-collapse:collapse; font-size:13px;">
      <thead>
        <tr>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">JAM</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">USER ID</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">NAMA</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">NOMINAL</th>
          <th style="padding:8px; text-align:left; border:1px solid var(--panel-border); background:rgba(0,30,60,0.6); color:var(--text-title);">STATUS</th>
        </tr>
      </thead>
      <tbody>`;
  adminRowsWithStatus.forEach(row => {
    const bgColor = row.isUsed
      ? 'rgba(46, 125, 50, 0.2)'
      : 'rgba(227, 242, 253, 0.2)';
    const textColor = row.isUsed ? 'var(--text-title)' : '#81d4fa';
    const statusText = row.isUsed ? 'âœ… Dipakai' : 'âšª Tidak terpakai';
    html += `
    <tr style="background-color:${bgColor}; color:${textColor};">
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-family:monospace;">${row.jam}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-weight:bold;">${row.userID}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border);">${row.nama}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border); font-family:monospace;">${row.nominal}</td>
      <td style="padding:8px; text-align:left; border:1px solid var(--panel-border);">${statusText}</td>
    </tr>`;
  });
  html += `</tbody></table></div></div>`;
  const hasil = document.getElementById('hasil_TRYCARI');
  if (hasil) hasil.innerHTML = html;
  showToast(`âœ… Analisis selesai: ${totalCocok} cocok dari ${totalDocs} entri.`, "success");
}

// ========================================
// PASARAN TOGEL FUNCTIONS
// ========================================
function loadPasaranTogel() {
  google.script.run.withSuccessHandler(renderPasaranList).getPasaranList();
}

function renderPasaranList(list) {
  allPasaranList = list;
  const dropdownPrediksi = document.getElementById("dropdownPrediksi");
  const dropdownJadwal = document.getElementById("dropdownJadwal");
  if (!dropdownPrediksi || !dropdownJadwal) return;
  dropdownPrediksi.innerHTML = '<option value="">Pilih Prediksi...</option>';
  dropdownJadwal.innerHTML = '<option value="">Pilih Jadwal...</option>';
  list.forEach(([prediksi, jadwal], index) => {
    dropdownPrediksi.add(new Option(prediksi.split('\n')[0], index));
    dropdownJadwal.add(new Option(jadwal.split('\n')[0], index));
  });
  if (lastPrediksiIndex !== "" && dropdownPrediksi.options[lastPrediksiIndex]) {
    dropdownPrediksi.value = lastPrediksiIndex;
    showDetailWithAnimation('prediksi');
  }
  if (lastJadwalIndex !== "" && dropdownJadwal.options[lastJadwalIndex]) {
    dropdownJadwal.value = lastJadwalIndex;
    showDetailWithAnimation('jadwal');
  }
}

function showDetailWithAnimation(type) {
  const selectId = (type === 'prediksi') ? "dropdownPrediksi" : "dropdownJadwal";
  const detailId = "detail" + (type === 'prediksi' ? 'Prediksi' : 'Jadwal');
  const selectElement = document.getElementById(selectId);
  const detailElement = document.getElementById(detailId);
  if (!selectElement || !detailElement) return;
  const index = selectElement.value;
  if (index === "") {
    detailElement.innerText = "Pilih " + (type === 'prediksi' ? 'prediksi' : 'jadwal') + " untuk melihat detail";
    detailElement.style.opacity = 0.6;
    return;
  }
  const data = allPasaranList[parseInt(index)][type === 'prediksi' ? 0 : 1];
  detailElement.style.transition = "opacity 0.5s, transform 0.5s";
  detailElement.style.opacity = 0;
  detailElement.style.transform = "translateY(10px)";
  setTimeout(() => {
    detailElement.innerText = data;
    detailElement.style.opacity = 1;
    detailElement.style.transform = "translateY(0)";
  }, 300);
  if (type === 'prediksi') lastPrediksiIndex = index;
  else lastJadwalIndex = index;
}

function showDetail(type) {
  showDetailWithAnimation(type);
}

function searchDropdowns() {
  const searchInput = document.getElementById("searchPasaran");
  if (!searchInput) return;
  const query = searchInput.value.toLowerCase();
  const dropdownPrediksi = document.getElementById("dropdownPrediksi");
  const dropdownJadwal = document.getElementById("dropdownJadwal");
  if (!dropdownPrediksi || !dropdownJadwal) return;
  // Save current selections
  const currentPrediksi = dropdownPrediksi.value;
  const currentJadwal = dropdownJadwal.value;
  // Clear and repopulate dropdowns
  dropdownPrediksi.innerHTML = '<option value="">Pilih Prediksi...</option>';
  dropdownJadwal.innerHTML = '<option value="">Pilih Jadwal...</option>';
  allPasaranList.forEach(([prediksi, jadwal], index) => {
    if (prediksi.toLowerCase().includes(query) || jadwal.toLowerCase().includes(query)) {
      dropdownPrediksi.add(new Option(prediksi.split('\n')[0], index));
      dropdownJadwal.add(new Option(jadwal.split('\n')[0], index));
    }
  });
  // Restore selections if possible
  if (currentPrediksi && dropdownPrediksi.options[currentPrediksi]) {
    dropdownPrediksi.value = currentPrediksi;
  }
  if (currentJadwal && dropdownJadwal.options[currentJadwal]) {
    dropdownJadwal.value = currentJadwal;
  }
}

function toggleTanggalPasaran() {
  const formTanggal = document.getElementById("formTanggal");
  if (formTanggal) {
    formTanggal.style.display = formTanggal.style.display === "none" ? "block" : "none";
  }
}

function simpanTanggalPasaran() {
  const tanggalInput = document.getElementById("tanggalPasaran");
  if (!tanggalInput || !tanggalInput.value) {
    showToast("â— Silakan pilih tanggal terlebih dahulu.");
    return;
  }
  showToast("âœ… Tanggal berhasil disimpan!");
  toggleTanggalPasaran();
}

// ========================================
// HITUNGAN TOGEL FUNCTIONS
// ========================================
function loadCaraHitungTogel() {
  lastKelompok = document.getElementById("kelompokDropdown")?.value || "";
  lastLabel = document.getElementById("labelDropdown")?.value || "";
}

function isiDropdownLabel() {
  const selectedKelompok = document.getElementById("kelompokDropdown")?.value;
  const labelDropdown = document.getElementById("labelDropdown");
  const detail = document.getElementById("detailHitunganDropdown");
  if (!labelDropdown || !detail) return;
  labelDropdown.innerHTML = `<option value="">-- Pilih Label --</option>`;
  detail.innerHTML = "Pilih label untuk melihat hasil";
  detail.style.opacity = 0.6;
  if (!selectedKelompok || !kelompokData[selectedKelompok]) return;
  kelompokData[selectedKelompok].forEach(item => {
    const opt = document.createElement("option");
    opt.value = item.label;
    opt.textContent = item.label;
    labelDropdown.appendChild(opt);
  });
  // Restore last selection if available
  if (lastLabel && [...labelDropdown.options].some(opt => opt.value === lastLabel)) {
    labelDropdown.value = lastLabel;
    tampilkanValueHitungan(true);
  }
}

function tampilkanValueHitungan(withAnimation = false) {
  const kelompok = document.getElementById("kelompokDropdown")?.value;
  const label = document.getElementById("labelDropdown")?.value;
  const detail = document.getElementById("detailHitunganDropdown");
  if (!detail) return;
  if (!kelompok || !label || !kelompokData[kelompok]) {
    detail.innerHTML = "Pilih label untuk melihat hasil";
    detail.style.opacity = 0.6;
    return;
  }
  const item = kelompokData[kelompok].find(i => i.label === label);
  if (!item) {
    detail.innerHTML = "Data tidak ditemukan";
    detail.style.opacity = 0.6;
    return;
  }
  if (withAnimation) {
    detail.style.opacity = "0";
    detail.style.transform = "scale(0.95)";
    setTimeout(() => {
      detail.style.transition = "all 0.4s ease";
      detail.innerHTML = `<span style="font-size: 24px; font-weight: bold; color: var(--neon-yellow);">${item.value}</span>`;
      detail.style.opacity = "1";
      detail.style.transform = "scale(1)";
    }, 200);
  } else {
    detail.innerHTML = `<span style="font-size: 24px; font-weight: bold; color: var(--neon-yellow);">${item.value}</span>`;
    detail.style.opacity = "1";
    detail.style.transform = "scale(1)";
  }
  lastLabel = label;
}

// ========================================
// HADIAH TOGEL FUNCTIONS
// ========================================
function loadHadiahTogel() {
  google.script.run.withSuccessHandler(res => {
    const container = document.getElementById("hadiahContainer");
    if (!container) return;
    container.innerHTML = "";
    if (!res?.data || !Array.isArray(res.data)) {
      container.innerHTML = "<p style='color:#ff6666;'>Tidak ada data hadiah.</p>";
      return;
    }
    res.data.forEach(group => {
      if (!group?.judul || !Array.isArray(group.items)) return;
      const validItems = group.items.filter(it =>
        it && it.hadiah && it.hadiah.trim() !== ""
      );
      if (validItems.length === 0) return;
      const box = document.createElement("div");
      box.className = "hadiah-box";
      const mid = Math.ceil(validItems.length / 2);
      const col1 = validItems.slice(0, mid);
      const col2 = validItems.slice(mid);
      const renderTable = (items) => {
        if (items.length === 0) return "";
        let html = `<table><thead><tr>
        <th>Nama</th>
        <th>Hadiah</th>
        <th>Diskon</th>
        </tr></thead><tbody>`;
        items.forEach(it => {
          let diskonVal = "NO DISCOUNT BET";
          let diskonClass = "no-discount";
          // Hanya terima string yang mengandung '%'
          if (typeof it.diskon === "string") {
            const trimmed = it.diskon.trim();
            if (trimmed !== "" && trimmed.includes("%")) {
              diskonVal = trimmed;
              diskonClass = "";
            }
          }
          // Semua bentuk lain (angka, null, undefined, string tanpa %) â†’ NO DISCOUNT BET
          html += `<tr>
          <td>${it.nama || "â€”"}</td>
          <td>${it.hadiah}</td>
          <td class="${diskonClass}">${diskonVal}</td>
          </tr>`;
        });
        html += `</tbody></table>`;
        return html;
      };
      const html = `
      <details>
      <summary>${group.judul}</summary>
      <div class="tabel-dua-kolom">
      ${renderTable(col1)}
      ${renderTable(col2)}
      </div>
      </details>
      `;
      box.innerHTML = html;
      container.appendChild(box);
    });
  }).getPengaturanTogelLengkap();
}

function showHadiahTab() {
  showTab('cekhadiahTab');
  loadHadiahTogel();
}

// ========================================
// REPORT LINE FUNCTIONS
// ========================================
function autoResizeTextarea(element) {
  if (element) {
    element.style.height = 'auto';
    element.style.height = (element.scrollHeight + 5) + 'px';
  }
}

async function loadReportLineData() {
  const container = document.getElementById('reportLineCardContainer');
  if (container) {
    container.innerHTML = `<p style="text-align:center; color:#00ffff;">â³ Sedang memuat data dari Google Sheet...</p>`;
  }
  google.script.run
    .withSuccessHandler((response) => {
      if (response.status === "error") {
        if (container) {
          container.innerHTML = `<p style="text-align:center; color:#ff4d4d;">â— Gagal memuat data: ${response.message}</p>`;
        }
        showToast("Gagal memuat data: " + response.message);
        return;
      }
      reportData = response.data;
      displayReportLineData(reportData);
      if (focusRowIndex !== null) {
        setTimeout(() => {
          restoreFocusAndScroll(focusRowIndex);
          focusRowIndex = null;
        }, 100);
      }
    })
    .withFailureHandler((error) => {
      if (container) {
        container.innerHTML = `<p style="text-align:center; color:#ff4d4d;">âŒ Error koneksi: ${error.message || 'Unknown error'}</p>`;
      }
      showToast("Error koneksi: " + error);
    })
    .getReportLineData();
}

function displayReportLineData(data) {
  const container = document.getElementById('reportLineCardContainer');
  if (!container) return;
  container.innerHTML = '';
  if (data.length === 0) {
    container.innerHTML = `<p style="text-align:center; color:#ffc107;">Tidak ada catatan yang ditemukan.</p>`;
    return;
  }
  data.forEach((item) => {
    const rowIndex = item.rowIndex;
    const isNewRow = item.isNew || false;
    const urlPattern = /^(http|https):\/\/[^ "]+$/;
    const isLink = urlPattern.test(item.colB);
    const card = document.createElement('div');
    card.id = `report-row-${rowIndex}`;
    card.className = 'report-card';
    // --- JUDUL ACCORDION (Kolom A) ---
    const accordionTitle = document.createElement('h4');
    accordionTitle.className = 'card-accordion-title';
    const titleTextSpan = document.createElement('span');
    titleTextSpan.id = `title-text-${rowIndex}`;
    titleTextSpan.textContent = item.colA || `[Baris Kosong ${rowIndex}]`;
    accordionTitle.appendChild(titleTextSpan);
    accordionTitle.onclick = function() {
      const content = document.getElementById(`content-${rowIndex}`);
      const isVisible = content.style.display === "block";
      document.querySelectorAll('.card-content-panel').forEach(panel => {
        panel.style.display = "none";
      });
      content.style.display = isVisible ? "none" : "block";
      if (!isVisible) {
        card.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    };
    card.appendChild(accordionTitle);
    // --- KONTEN DETAIL CARD (A, B, C, D) ---
    const contentDiv = document.createElement('div');
    contentDiv.id = `content-${rowIndex}`;
    contentDiv.className = 'card-content-panel';
    contentDiv.style.display = isNewRow ? 'block' : 'none';
    contentDiv.innerHTML = `
    <div class="report-field-group field-colA">
      <label>ALL KENDALA REPORT (Judul)</label>
      <div class="field-controls">
        <div class="report-display-value wide-input" id="display-colA-${rowIndex}">${item.colA}</div>
        <textarea class="report-edit-input wide-input" id="input-colA-${rowIndex}" style="display:none;">${item.colA}</textarea>
        <button class="btn-action btn-copy-small"
          onclick="copyReportCell('${rowIndex}', 'colA')"
          style="margin-right: 5px; margin-top: 5px;">
          ðŸ’« Copy Judul
        </button>
      </div>
    </div>
    <hr class="neon-divider">
    <div class="report-field-group">
      <label>MEMO/REPORT</label>
      <div class="field-controls">
        <div class="report-display-value wide-input" id="display-colB-${rowIndex}">${item.colB}</div>
        <textarea class="report-edit-input wide-input" id="input-colB-${rowIndex}" style="display:none;">${item.colB}</textarea>
        <div class="action-buttons-group">
          <button class="btn-action btn-copy-large"
            onclick="copyReportCell('${rowIndex}', 'colB')"
            style="margin-right: 5px;">
            ðŸ’« Copy Catatan
          </button>
          ${isLink ? `
          <button class="btn-action btn-link"
            onclick="window.open('${item.colB}', '_blank')">
            ðŸ”— Buka Link
          </button>
          ` : ''}
        </div>
      </div>
    </div>
    <hr class="neon-divider">
    <div class="report-field-group">
      <label>POST/MEMO KE ADMIN,WA,FB</label>
      <div class="field-controls">
        <div class="report-display-value wide-input small-field" id="display-colC-${rowIndex}">${item.colC}</div>
        <textarea class="report-edit-input wide-input small-field" id="input-colC-${rowIndex}" style="display:none;">${item.colC}</textarea>
      </div>
    </div>
    <hr class="neon-divider">
    <div class="report-field-group">
      <label>REPORT KE LINE/TELE</label>
      <div class="field-controls">
        <div class="report-display-value wide-input small-field" id="display-colD-${rowIndex}">${item.colD}</div>
        <textarea class="report-edit-input wide-input small-field" id="input-colD-${rowIndex}" style="display:none;">${item.colD}</textarea>
      </div>
    </div>
    <hr class="neon-divider">
    <div class="card-actions-bottom">
      <button class="btn-action btn-cancel"
        onclick="toggleCancelEdit(${rowIndex}, ${isNewRow})"
        style="display:${isNewRow ? 'inline-block' : 'none'};">âŒ Batal</button>
      <button class="btn-action btn-edit" onclick="toggleEditMode(${rowIndex}, true)" style="display:${isNewRow ? 'none' : 'inline-block'};">âœï¸ Edit</button>
      <button class="btn-action btn-save" onclick="saveReportRow(${rowIndex})" style="display:${isNewRow ? 'inline-block' : 'none'};">ðŸ’¾ Simpan</button>
    </div>
    `;
    card.appendChild(contentDiv);
    container.appendChild(card);
    // --- AUTO RESIZE INTEGRATION (untuk A, B, C, D) ---
    const inputColA = document.getElementById(`input-colA-${rowIndex}`);
    const inputColB = document.getElementById(`input-colB-${rowIndex}`);
    const inputColC = document.getElementById(`input-colC-${rowIndex}`);
    const inputColD = document.getElementById(`input-colD-${rowIndex}`);
    if (inputColA) {
      autoResizeTextarea(inputColA);
      inputColA.addEventListener('input', () => autoResizeTextarea(inputColA));
    }
    if (inputColB) {
      autoResizeTextarea(inputColB);
      inputColB.addEventListener('input', () => autoResizeTextarea(inputColB));
    }
    if (inputColC) {
      autoResizeTextarea(inputColC);
      inputColC.addEventListener('input', () => autoResizeTextarea(inputColC));
    }
    if (inputColD) {
      autoResizeTextarea(inputColD);
      inputColD.addEventListener('input', () => autoResizeTextarea(inputColD));
    }
  });
}

function restoreFocusAndScroll(rowIndex) {
  const card = document.getElementById(`report-row-${rowIndex}`);
  const content = document.getElementById(`content-${rowIndex}`);
  if (card && content) {
    card.style.display = 'block';
    content.style.display = 'block';
    card.scrollIntoView({ behavior: 'smooth', block: 'start' });
    toggleEditMode(rowIndex, false);
  }
}

function toggleEditMode(rowIndex, isEditMode) {
  const card = document.getElementById(`report-row-${rowIndex}`);
  const content = document.getElementById(`content-${rowIndex}`);
  const saveBtn = card.querySelector('.btn-save');
  const editBtn = card.querySelector('.btn-edit');
  const cancelBtn = card.querySelector('.btn-cancel');
  const title = card.querySelector('.card-accordion-title');
  // Hanya mencari tombol copy yang tersisa (di A dan B)
  const copyBtns = card.querySelectorAll('.btn-copy-large, .btn-copy-small');
  content.style.display = 'block';
  // Daftar Kolom yang Dapat Diedit (A, B, C, D)
  const editableCols = ['colA', 'colB', 'colC', 'colD'];
  editableCols.forEach(colKey => {
    const display = document.getElementById(`display-${colKey}-${rowIndex}`);
    const input = document.getElementById(`input-${colKey}-${rowIndex}`);
    if (display && input) {
      if (isEditMode) {
        display.style.display = 'none';
        input.style.display = 'block';
        input.value = display.textContent.trim();
        autoResizeTextarea(input);
      } else {
        display.textContent = input.value.trim();
        display.style.display = 'block';
        input.style.display = 'none';
      }
    }
  });
  if (isEditMode) {
    editBtn.style.display = 'none';
    saveBtn.style.display = 'inline-block';
    cancelBtn.style.display = 'inline-block';
    title.style.display = 'none';
    // Sembunyikan tombol copy di dalam detail saat edit
    copyBtns.forEach(btn => btn.style.display = 'none');
    document.getElementById(`input-colA-${rowIndex}`).focus();
  } else {
    editBtn.style.display = 'inline-block';
    saveBtn.style.display = 'none';
    cancelBtn.style.display = 'none';
    // Tampilkan tombol copy di dalam detail saat mode tampilan
    copyBtns.forEach(btn => btn.style.display = 'inline-block');
    title.style.display = 'flex';
    const newTitle = document.getElementById(`input-colA-${rowIndex}`).value.trim();
    const titleTextElement = document.getElementById(`title-text-${rowIndex}`);
    if (titleTextElement) {
      titleTextElement.textContent = newTitle || `[Baris Kosong ${rowIndex}]`;
    }
  }
}

async function saveReportRow(rowIndex) {
  const card = document.getElementById(`report-row-${rowIndex}`);
  const saveBtn = card.querySelector('.btn-save');
  // Payload LENGKAP dengan Kolom C dan D
  const payload = {
    rowIndex: rowIndex,
    colA: document.getElementById(`input-colA-${rowIndex}`).value.trim(),
    colB: document.getElementById(`input-colB-${rowIndex}`).value.trim(),
    colC: document.getElementById(`input-colC-${rowIndex}`).value.trim(),
    colD: document.getElementById(`input-colD-${rowIndex}`).value.trim()
  };
  focusRowIndex = rowIndex;
  saveBtn.innerHTML = '...';
  saveBtn.disabled = true;
  google.script.run
    .withSuccessHandler((result) => {
      if (result.status === "success") {
        loadReportLineData();
        showToast(result.message);
      } else {
        showToast(result.message);
        loadReportLineData();
      }
    })
    .withFailureHandler((error) => {
      showToast("Gagal menyimpan: " + error);
      loadReportLineData();
    })
    .updateReportLineData(payload);
}

function toggleCancelEdit(rowIndex, isNewRow) {
  if (isNewRow) {
    focusRowIndex = null;
    loadReportLineData();
    showToast("âŒ Pembuatan baris dibatalkan.", false);
  } else {
    focusRowIndex = rowIndex;
    loadReportLineData();
    showToast("âŒ Perubahan dibatalkan, kembali ke versi tersimpan.", false);
  }
}

function searchReportLine() {
  const input = document.getElementById('reportSearch')?.value.toLowerCase();
  const allCards = document.querySelectorAll('#reportLineCardContainer .report-card');
  allCards.forEach(card => {
    const textContent = card.textContent.toLowerCase();
    card.style.display = textContent.includes(input) ? 'block' : 'none';
  });
}

function addNewReportRow() {
  const lastItem = reportData[reportData.length - 1];
  const newIndex = lastItem ? lastItem.rowIndex + 1 : 2;
  if (newIndex > 450) {
    showToast("Batas maksimum baris (200) telah tercapai.");
    return;
  }
  const newRowItem = {
    rowIndex: newIndex,
    colA: '', colB: '', colC: '', colD: '',
    isNew: true
  };
  reportData.push(newRowItem);
  displayReportLineData(reportData);
  const row = document.getElementById(`report-row-${newIndex}`);
  if (row) {
    row.scrollIntoView({ behavior: 'smooth', block: 'end' });
    toggleEditMode(newIndex, true);
    document.getElementById(`input-colA-${newIndex}`).focus();
  }
  showToast(`Baris kosong di baris ${newIndex} ditambahkan. Silakan isi dan Simpan.`);
}

function copyReportTitle(rowIndex) {
  const textToCopy = document.getElementById(`title-text-${rowIndex}`)?.textContent.trim();
  navigator.clipboard.writeText(textToCopy).then(() => {
    showToast("Judul berhasil disalin (ðŸ’«)!");
  }).catch(err => {
    showToast("Gagal menyalin teks.");
  });
}

function copyReportCell(rowIndex, colKey) {
  const textToCopy = document.getElementById(`display-${colKey}-${rowIndex}`)?.textContent.trim();
  navigator.clipboard.writeText(textToCopy).then(() => {
    showToast("Konten berhasil disalin (ðŸ’«)!");
  }).catch(err => {
    showToast("Gagal menyalin teks.");
  });
}

// ========================================
// OCR & IMAGE FUNCTIONS
// ========================================
function membacaIsiFoto_ocr(src) {
  Tesseract.recognize(
    src, 'eng', {
      logger: m => console.log(m)
    }
  ).then(({
    data: {
      text
    }
  }) => {
    const hasilElement = document.getElementById("membacaIsiFoto_hasil");
    if (hasilElement) {
      hasilElement.innerText = text.trim() || "Teks tidak terbaca.";
    }
  }).catch(err => {
    const hasilElement = document.getElementById("membacaIsiFoto_hasil");
    if (hasilElement) {
      hasilElement.innerText = "Gagal membaca gambar.";
    }
  });
}

function membacaIsiFoto_prosesLink() {
  const link = document.getElementById("membacaIsiFoto_input").value.trim();
  if (link) {
    const modal = document.getElementById("membacaIsiFoto_modal");
    if (modal) modal.style.display = "flex";
    const gambar = document.getElementById("membacaIsiFoto_gambar");
    if (gambar) gambar.src = link;
    const hasil = document.getElementById("membacaIsiFoto_hasil");
    if (hasil) hasil.innerHTML = "<i>Memproses gambar...</i>";
    membacaIsiFoto_ocr(link);
  }
}

function membacaIsiFoto_tutup() {
  const modal = document.getElementById("membacaIsiFoto_modal");
  if (modal) modal.style.display = "none";
  const gambar = document.getElementById("membacaIsiFoto_gambar");
  if (gambar) gambar.src = "";
  const hasil = document.getElementById("membacaIsiFoto_hasil");
  if (hasil) hasil.innerText = "";
  const input = document.getElementById("membacaIsiFoto_input");
  if (input) input.value = "";
}

// ========================================
// EXTRACTOR FUNCTIONS
// ========================================
function clearBulkExtract() {
  const input = document.getElementById('bulkExtractInput');
  const container = document.getElementById('bulkResultsContainer');
  if (input) input.value = '';
  if (container) container.innerHTML = '';
}

function copyBulkExtracted() {
  const container = document.getElementById('bulkResultsContainer');
  if (!container || !container.children.length) {
    showToast("âš ï¸ Tidak ada data untuk disalin!", "warning");
    return;
  }
  const items = Array.from(container.querySelectorAll('.extract-h-card'));
  let text = '';
  items.forEach(card => {
    const vals = card.querySelectorAll('.value');
    if (vals.length >= 4) {
      text += `${vals[0].textContent.trim()}\t${vals[1].textContent.trim()}\t${vals[2].textContent.trim()}\t${vals[3].textContent.trim()}\n`;
    }
  });
  navigator.clipboard.writeText(text.trim()).then(() => {
    showToast("âœ… Data berhasil disalin!", "success");
  }, () => {
    showToast("âŒ Gagal menyalin ke clipboard.", "error");
  });
}

function splitIntoBlocks(text) {
  const lines = text.split('\n').map(l => l.trim()).filter(l => l !== '');
  const blocks = [];
  let currentBlock = [];
  for (const line of lines) {
    if (/^\d+(\s|\t|$)/.test(line)) {
      if (currentBlock.length > 0) {
        blocks.push(currentBlock);
      }
      currentBlock = [line];
    } else {
      currentBlock.push(line);
    }
  }
  if (currentBlock.length > 0) {
    blocks.push(currentBlock);
  }
  return blocks;
}

function parseSingleWithdrawBlock(lines) {
  lines = lines.map(l => l.trim()).filter(l => l !== '');
  let account = 'â€“';
  let username = 'â€“';
  let name = 'â€“';
  let nominal = 'â€“';
  // Ambil USER ID
  if (lines.length > 0) {
    const firstLine = lines[0];
    if (firstLine.includes('\t')) {
      const parts = firstLine.split('\t').filter(p => p.trim() !== '');
      if (parts.length >= 2) username = parts[1].trim();
    } else {
      const parts = firstLine.split(/\s+/);
      if (parts.length >= 2) username = parts[1].trim();
    }
  }
  // Ambil NOMINAL
  for (let i = 0; i < lines.length; i++) {
    if (lines[i].toUpperCase().includes('WITHDRAW')) {
      const parts = lines[i].split('\t').filter(p => p.trim() !== '');
      if (parts.length >= 3) {
        nominal = parts[2].trim().replace(/\s+/g, '');
      }
      break;
    }
  }
  // Ambil REKENING & NAMA
  for (let i = lines.length - 1; i >= 0; i--) {
    const line = lines[i];
    if (line.includes(',')) {
      const parts = line.split(',').map(p => p.trim());
      name = (parts.length >= 3 ? parts[2] : parts[1] || '').toUpperCase();
      const bankType = parts[0].toUpperCase();
      let accountNumber = parts.length >= 2 ? parts[1].replace(/\D/g, '') : '';
      if (E_WALLET_CODES.hasOwnProperty(bankType)) {
        account = E_WALLET_CODES[bankType] + accountNumber;
      } else {
        account = accountNumber || 'â€“';
      }
      break;
    }
  }
  // Fallback cari nomor telepon
  if (account === 'â€“') {
    for (let i = 0; i < lines.length; i++) {
      const phoneMatch = lines[i].match(/\b\d{10,13}\b/);
      if (phoneMatch) {
        account = phoneMatch[0];
        break;
      }
    }
  }
  // Validasi nominal
  if (nominal !== 'â€“') {
    nominal = nominal.replace(/[^\d,.]/g, '');
    if (!nominal.includes(',') && !nominal.includes('.')) {
      const num = parseInt(nominal.replace(/\D/g, ''));
      if (!isNaN(num) && num > 0) {
        nominal = formatRupiah(num);
      }
    }
  }
  return {
    account: account || 'â€“',
    username: username || 'â€“',
    name: name || 'â€“',
    nominal: nominal || 'â€“'
  };
}

function processBulkExtract() {
  const input = document.getElementById('bulkExtractInput');
  if (!input || !input.value.trim()) {
    clearBulkExtract();
    return;
  }
  const blocks = splitIntoBlocks(input.value);
  const container = document.getElementById('bulkResultsContainer');
  if (!container) return;
  container.innerHTML = '';
  const limitedBlocks = blocks.slice(0, 100);
  limitedBlocks.forEach(block => {
    const data = parseSingleWithdrawBlock(block);
    const card = document.createElement('div');
    card.className = 'extract-h-card';
    card.innerHTML = `
    <div class="label">Kolom 1 (Rekening)</div>
    <div class="value">${data.account}</div>
    <div class="label">Kolom 2 (User ID)</div>
    <div class="value">${data.username}</div>
    <div class="label">Kolom 3 (Nama)</div>
    <div class="value">${data.name}</div>
    <div class="label">Kolom 4 (Nominal)</div>
    <div class="value">${data.nominal}</div>
    `;
    container.appendChild(card);
  });
  showToast(`âœ… ${limitedBlocks.length} data berhasil diekstraksi.`, "success");
}

// ========================================
// PENGATURAN TOGEL FUNCTIONS
// ========================================
function attachAccordionListeners() {
  document.querySelectorAll("#contentPengaturan .accordion").forEach(a => {
    a.onclick = function() {
      const panel = this.nextElementSibling;
      panel.style.display = (panel.style.display === "block") ? "none" : "block";
    };
  });
}

function openPengaturanAfterSave(panelKey, groupIndex) {
  google.script.run
    .withSuccessHandler(res => {
      if (res.status === "error") {
        const contentPengaturan = document.getElementById("contentPengaturan");
        if (contentPengaturan) {
          contentPengaturan.innerHTML = `<p>${res.message}</p>`;
        }
        return;
      }
      let html = "";
      // === Bagian 1: Pengaturan Hadiah dan Diskon ===
      res.data.forEach((k, currentGroupIndex) => {
        const isPanelOpen = panelKey === 'normal' && groupIndex === currentGroupIndex;
        html += `
        <h4 class="accordion"
        data-col-nama="${k.colNama}"
        data-col-hadiah="${k.colHadiah}"
        data-col-diskon="${k.colDiskon}">
        ${k.judul}
        </h4>
        <div class="panel" style="display:${isPanelOpen ? "block" : "none"};">
        <table border="0" cellpadding="4">
        <thead>
        <tr>
        <th>Jenis Bet</th>
        <th>Hadiah</th>
        <th>Diskon</th>
        <th>Aksi</th>
        </tr>
        </thead>
        <tbody>
        `;
        k.items.forEach((it, i) => {
          const diskonVal = (it.diskon && String(it.diskon).includes("%")) ? it.diskon : "NO DISCOUNT";
          const barisSheet = k.startRow + i;
          html += `
          <tr>
          <td>${it.nama}</td>
          <td><div contenteditable="true" class="editable-cell">${it.hadiah ?? ""}</div></td>
          <td><div contenteditable="true" class="editable-cell">${diskonVal}</div></td>
          <td>
          <button class="row-save-btn"
          data-row="${barisSheet}"
          onclick="simpanBaris(${currentGroupIndex}, ${i}, this)">
          ðŸ’¾ Simpan
          </button>
          </td>
          </tr>
          `;
        });
        html += `
        </tbody>
        </table>
        </div>
        <br/>
        `;
      });
      // === Bagian 2: Pengaturan Link Live ===
      const isLinkLiveOpen = panelKey === 'linkLive';
      html += `
      <h4 class="accordion">LINK LIVE PASARAN</h4>
      <div class="panel" style="display:${isLinkLiveOpen ? "block" : "none"};">
      <table border="0" cellpadding="4">
      <thead>
      <tr>
      <th>Link</th>
      <th>Aksi</th>
      </tr>
      </thead>
      <tbody>
      `;
      res.linkLive.forEach((l, i) => {
        html += `
        <tr>
        <td>
        <div contenteditable="true" class="link-live-item editable-cell">${l}</div>
        </td>
        <td>
        <button class="row-save-btn" onclick="simpanLink(${i}, this)">
        ðŸ’¾ Simpan
        </button>
        </td></tr>
        `;
      });
      html += `
      </tbody>
      </table>
      </div>
      `;
      // === Bagian 3: Pengaturan Jadwal Pasaran ===
      const isJadwalPasaranOpen = panelKey === 'jadwalPasaran';
      html += `
      <h4 class="accordion">JAM JADWAL PASARAN</h4>
      <div class="panel" style="display:${isJadwalPasaranOpen ? "block" : "none"};">
      <table border="0" cellpadding="4">
      <thead>
      <tr>
      <th>Jam Tutup</th>
      <th>Nama Pasaran</th>
      <th>Diskon</th>
      <th>Jam Result</th>
      <th>Link resmi</th>
      <th>Aksi</th>
      </tr>
      </thead>
      <tbody>
      `;
      res.jadwalPasaran.forEach((j, i) => {
        const diskonValJadwal = (j.diskon && String(j.diskon).includes("%")) ? j.diskon : "NO DISCOUNT";
        html += `
        <tr>
        <td><div contenteditable="true" class="editable-cell">${j.jamTutup}</div></td>
        <td><div contenteditable="true" class="editable-cell">${j.namaPasaran}</div></td>
        <td><div contenteditable="true" class="editable-cell">${diskonValJadwal}</div></td>
        <td><div contenteditable="true" class="editable-cell">${j.jamResult}</div></td>
        <td><div contenteditable="true" class="editable-cell">${j.link}</div></td>
        <td>
        <button class="row-save-btn" onclick="simpanJadwal(${i}, this)">
        ðŸ’¾ Simpan
        </button>
        </td>
        </tr>
        `;
      });
      html += `
      </tbody>
      </table>
      </div>
      `;
      // === Bagian 4: Pengaturan Kendala All ===
      const isKendalaAllOpen = panelKey === 'kendalaAll';
      html += `
      <h4 class="accordion">KENDALA ALL</h4>
      <div class="panel" style="display:${isKendalaAllOpen ? "block" : "none"};">
      <button class="row-save-btn" style="margin-top:20px;" onclick="tambahKendalaAllRow()">
      âž• Tambah Baris
      </button>
      <div id="kendalaList">
      `;
      res.kendalaAllData.forEach(item => {
        html += `
        <h5 class="kendala-accordion" data-row-index="${item.rowIndex}">
        <span>${item.judul}</span>
        </h5>
        <div class="kendala-panel">
        <table border="0" cellpadding="4">
        <tbody>
        <tr><td>Judul:</td><td><div contenteditable="true" class="editable-cell">${item.judul}</div></td></tr>
        <tr><td>Jawaban 1:</td><td><div contenteditable="true" class="editable-cell">${item.jawaban1}</div></td></tr>
        <tr><td>Jawaban 2:</td><td><div contenteditable="true" class="editable-cell">${item.jawaban2}</div></td></tr>
        <tr><td>Jawaban 3:</td><td><div contenteditable="true" class="editable-cell">${item.jawaban3}</div></td></tr>
        </tbody>
        </table>
        <div style="text-align: right; padding: 10px 0;">
        <button class="row-save-btn" onclick="updateKendalaAllRow(${item.rowIndex}, this)">
        ðŸ’¾ Simpan
        </button>
        </div>
        </div>
        `;
      });
      html += `
      </div>
      </div>
      <br/>
      `;
      // Render HTML ke dalam DOM
      const contentPengaturan = document.getElementById("contentPengaturan");
      if (contentPengaturan) {
        contentPengaturan.innerHTML = html;
        // Menambahkan event listener untuk accordion utama
        document.querySelectorAll("#contentPengaturan .accordion").forEach(a => {
          a.onclick = function() {
            const panel = this.nextElementSibling;
            panel.style.display = (panel.style.display === "block") ? "none" : "block";
          };
        });
        // Menambahkan event listener untuk accordion kendala
        document.querySelectorAll(".kendala-accordion").forEach(a => {
          a.onclick = function() {
            const panel = this.nextElementSibling;
            panel.style.display = (panel.style.display === "block") ? "none" : "block";
          };
        });
      }
    })
    .getPengaturanTogelLengkap();
}

function simpanBaris(groupIndex, indexItem, btn) {
  const h4Elements = document.querySelectorAll("#contentPengaturan h4");
  const h = h4Elements[groupIndex];
  if (!h) return;
  const colNama = h.dataset.colNama;
  const colHadiah = h.dataset.colHadiah;
  const colDiskon = h.dataset.colDiskon;
  const rowNumber = btn.dataset.row;
  const row = btn.closest('tr');
  const nama = row.cells[0].innerText.trim();
  const hadiah = row.cells[1].querySelector('.editable-cell').innerText.trim();
  let diskon = row.cells[2].querySelector('.editable-cell').innerText.trim();
  if (diskon.toUpperCase() === "NO DISCOUNT") diskon = "";
  const payload = {
    nama,
    hadiah,
    diskon,
    rangeNama: `${colNama}${rowNumber}`,
    rangeHadiah: `${colHadiah}${rowNumber}`,
    rangeDiskon: `${colDiskon}${rowNumber}`
  };
  google.script.run
    .withSuccessHandler(res => {
      showToast(res.message);
      openPengaturanAfterSave('normal', groupIndex);
    })
    .withFailureHandler(err => showToast("Gagal simpan: " + err.message))
    .updatePengaturanTogelBaris(payload);
}

function simpanLink(index, btn) {
  const row = btn.closest('tr');
  const link = row.cells[0].querySelector('.link-live-item').textContent.trim();
  const payload = { index, link };
  // Simpan info fokus
  const focusInfo = {
    type: 'linkLive',
    rowIndex: index
  };
  google.script.run
    .withSuccessHandler(res => {
      showToast(res.message);
      openPengaturanAfterSaveAndFocus('linkLive', null, focusInfo);
    })
    .withFailureHandler(err => showToast("Gagal simpan: " + err.message))
    .updateLinkPasaran(payload);
}

function simpanJadwal(index, btn) {
  const row = btn.closest('tr');
  const jamTutup = row.cells[0].querySelector('.editable-cell').textContent.trim();
  const namaPasaran = row.cells[1].querySelector('.editable-cell').textContent.trim();
  const diskon = row.cells[2].querySelector('.editable-cell').textContent.trim();
  const jamResult = row.cells[3].querySelector('.editable-cell').textContent.trim();
  const link = row.cells[4].querySelector('.editable-cell').textContent.trim();
  const payload = { index, jamTutup, namaPasaran, diskon, jamResult, link };
  // Fokus ke kolom jamTutup (index 0) setelah simpan
  const focusInfo = {
    type: 'jadwalPasaran',
    rowIndex: index,
    colIndex: 0 // ubah ke 1,2,3,4 jika ingin fokus ke kolom lain
  };
  google.script.run
    .withSuccessHandler(res => {
      showToast(res.message);
      openPengaturanAfterSaveAndFocus('jadwalPasaran', null, focusInfo);
    })
    .updateJadwalPasaran(payload);
}

function openPengaturan(panelKey, groupIndex) {
  google.script.run
    .withSuccessHandler(res => {
      if (res.status === "error") {
        const contentPengaturan = document.getElementById("contentPengaturan");
        if (contentPengaturan) {
          contentPengaturan.innerHTML = `<p>${res.message}</p>`;
        }
        return;
      }
      let html = "";
      res.data.forEach((k, currentGroupIndex) => {
        const isPanelOpen = panelKey === 'normal' && groupIndex === currentGroupIndex;
        html += `
        <h4 class="accordion" data-col-nama="${k.colNama}" data-col-hadiah="${k.colHadiah}" data-col-diskon="${k.colDiskon}">
        ${k.judul}
        </h4>
        <div class="panel" style="display:${isPanelOpen ? "block" : "none"};">
        <table border="0" cellpadding="4">
        <thead><tr><th>Jenis Bet</th><th>Hadiah</th><th>Diskon</th><th>Aksi</th></tr></thead>
        <tbody>
        `;
        k.items.forEach((it, i) => {
          const diskonVal = (it.diskon && String(it.diskon).includes("%")) ? it.diskon : "NO DISCOUNT";
          const barisSheet = k.startRow + i;
          html += `
          <tr>
          <td>${it.nama}</td>
          <td><div contenteditable="true" class="editable-cell">${it.hadiah ?? ""}</div></td>
          <td><div contenteditable="true" class="editable-cell">${diskonVal}</div></td>
          <td><button class="row-save-btn" data-row="${barisSheet}" onclick="simpanBaris(${currentGroupIndex}, ${i}, this)">ðŸ’¾ Simpan</button></td>
          </tr>
          `;
        });
        html += `
        </tbody>
        </table>
        </div><br/>
        `;
      });
      const isLinkLiveOpen = panelKey === 'linkLive';
      html += `
      <h4 class="accordion">LINK LIVE PASARAN</h4>
      <div class="panel" style="display:${isLinkLiveOpen ? "block" : "none"};">
      <table border="0" cellpadding="4">
      <thead><tr><th>Link</th><th>Aksi</th></tr></thead>
      <tbody>
      `;
      res.linkLive.forEach((l, i) => {
        html += `
        <tr>
        <td><div contenteditable="true" class="link-live-item editable-cell">${l}</div></td>
        <td><button class="row-save-btn" onclick="simpanLink(${i}, this)">ðŸ’¾ Simpan</button></td>
        </tr>
        `;
      });
      html += `
      </tbody>
      </table>
      </div>
      `;
      const isJadwalPasaranOpen = panelKey === 'jadwalPasaran';
      html += `
      <h4 class="accordion">JAM JADWAL PASARAN</h4>
      <div class="panel" style="display:${isJadwalPasaranOpen ? "block" : "none"};">
      <table border="0" cellpadding="4">
      <thead><tr><th>Jam Tutup</th><th>Nama Pasaran</th><th>Diskon</th><th>Jam Result</th><th>Link resmi</th><th>Aksi</th></tr></thead>
      <tbody>
      `;
      res.jadwalPasaran.forEach((j, i) => {
        const diskonValJadwal = (j.diskon && String(j.diskon).includes("%")) ? j.diskon : "NO DISCOUNT";
        html += `
        <tr>
        <td><div contenteditable="true" class="editable-cell">${j.jamTutup}</div></td>
        <td><div contenteditable="true" class="editable-cell">${j.namaPasaran}</div></td>
        <td><div contenteditable="true" class="editable-cell">${diskonValJadwal}</div></td>
        <td><div contenteditable="true" class="editable-cell">${j.jamResult}</div></td>
        <td><div contenteditable="true" class="editable-cell">${j.link}</div></td>
        <td><button class="row-save-btn" onclick="simpanJadwal(${i}, this)">ðŸ’¾ Simpan</button></td>
        </tr>
        `;
      });
      html += `
      </tbody>
      </table>
      </div>
      `;
      const isKendalaAllOpen = panelKey === 'kendalaAll';
      html += `
      <h4 class="accordion">KENDALA ALL</h4>
      <div class="panel" style="display:${isKendalaAllOpen ? "block" : "none"};">
      <button class="row-save-btn" style="margin-top:20px;" onclick="tambahKendalaAllRow()">
      âž• Tambah Baris
      </button>
      <div id="kendalaList">
      `;
      res.kendalaAllData.forEach(item => {
        html += `
        <h5 class="kendala-accordion" data-row-index="${item.rowIndex}">
        <span>${item.judul}</span>
        </h5>
        <div class="kendala-panel">
        <table border="0" cellpadding="4">
        <tbody>
        <tr><td>Judul:</td><td><div contenteditable="true" class="editable-cell">${item.judul}</div></td></tr>
        <tr><td>Jawaban 1:</td><td><div contenteditable="true" class="editable-cell">${item.jawaban1}</div></td></tr>
        <tr><td>Jawaban 2:</td><td><div contenteditable="true" class="editable-cell">${item.jawaban2}</div></td></tr>
        <tr><td>Jawaban 3:</td><td><div contenteditable="true" class="editable-cell">${item.jawaban3}</div></td></tr>
        </tbody>
        </table>
        <div style="text-align: right; padding: 10px 0;">
        <button class="row-save-btn" onclick="updateKendalaAllRow(${item.rowIndex}, this)">ðŸ’¾ Simpan</button>
        </div>
        </div>
        `;
      });
      html += `
      </div>
      </div><br/>
      `;
      const contentPengaturan = document.getElementById("contentPengaturan");
      if (contentPengaturan) {
        contentPengaturan.innerHTML = html;
        document.querySelectorAll("#contentPengaturan .accordion").forEach(a => {
          a.onclick = function() {
            const panel = this.nextElementSibling;
            panel.style.display = (panel.style.display === "block") ? "none" : "block";
          };
        });
        document.querySelectorAll(".kendala-accordion").forEach(a => {
          a.onclick = function() {
            const panel = this.nextElementSibling;
            panel.style.display = (panel.style.display === "block") ? "none" : "block";
          };
        });
      }
    })
    .getPengaturanTogelLengkap();
}

function tambahKendalaAllRow() {
  const kendalaList = document.getElementById("kendalaList");
  if (!kendalaList) return;
  const newKendalaHtml = `
  <h5 class="kendala-accordion">
  <span>BARIS BARU (BELUM DISIMPAN)</span>
  </h5>
  <div class="kendala-panel" style="display:block;">
  <table border="0" cellpadding="4">
  <tbody>
  <tr><td>Judul:</td><td><div contenteditable="true" class="editable-cell"></div></td></tr>
  <tr><td>Jawaban 1:</td><td><div contenteditable="true" class="editable-cell"></div></td></tr>
  <tr><td>Jawaban 2:</td><td><div contenteditable="true" class="editable-cell"></div></td></tr>
  <tr><td>Jawaban 3:</td><td><div contenteditable="true" class="editable-cell"></div></td></tr>
  </tbody>
  </table>
  <div style="text-align: right; padding: 10px 0;">
  <button class="row-save-btn" onclick="updateKendalaAllRow(-1, this)">
  ðŸ’¾ Simpan
  </button>
  </div>
  </div>
  `;
  // Simpan posisi scroll sebelum menambahkan (opsional, tapi aman)
  const panelContainer = kendalaList.closest('.panel');
  // Tambahkan elemen baru
  kendalaList.insertAdjacentHTML('beforeend', newKendalaHtml);
  // Ambil elemen panel yang baru ditambahkan
  const newPanel = kendalaList.querySelector('.kendala-panel:last-of-type');
  // ðŸ”½ SCROLL OTOMATIS KE BAWAH ðŸ”½
  if (newPanel) {
    newPanel.scrollIntoView({
      behavior: "smooth",   // animasi scroll halus
      block: "nearest"      // posisi scroll minimal yang diperlukan
    });
  }
  // Tambahkan event listener ke accordion baru
  const newAccordion = kendalaList.querySelector('.kendala-accordion:last-child');
  if (newAccordion) {
    newAccordion.onclick = function() {
      const panel = this.nextElementSibling;
      panel.style.display = (panel.style.display === "block") ? "none" : "block";
    };
  }
  showToast("Baris kosong berhasil ditambahkan.");
}

function updateKendalaAllRow(rowIndex, btn) {
  const parent = btn.closest('.kendala-panel');
  const editableCells = parent.querySelectorAll('.editable-cell');
  const payload = {
    judul: editableCells[0].innerText.trim(),
    jawaban1: editableCells[1].innerText.trim(),
    jawaban2: editableCells[2].innerText.trim(),
    jawaban3: editableCells[3].innerText.trim()
  };
  if (rowIndex === -1) {
    google.script.run
      .withSuccessHandler(res => {
        showToast(res.message);
        openPengaturan('kendalaAll');
      })
      .withFailureHandler(err => showToast("Gagal simpan: " + err.message))
      .addNewKendala(payload);
  } else {
    payload.rowIndex = rowIndex;
    google.script.run
      .withSuccessHandler(res => {
        showToast(res.message);
        openPengaturan('kendalaAll');
      })
      .withFailureHandler(err => showToast("Gagal simpan: " + err.message))
      .updateKendalaAll(payload);
  }
}

// ========================================
// INITIALIZATION
// ========================================
window.onload = function() {
  const saved = localStorage.getItem('backgroundTheme');
  if (saved) {
    setBackground(saved);
    const select = document.querySelector('select');
    if (select) select.value = saved;
  } else {
    setBackground('bg-default');
  }
  // Inisialisasi event listeners setelah DOM dimuat
  initEventListeners();
  // Inisialisasi tanggal pasaran
  initTanggalPasaran();
};

function setBackground(type) {
  if (type) {
    document.body.className = type;
    localStorage.setItem('backgroundTheme', type);
  }
}

function initEventListeners() {
  // Dropdown Prediksi
  const dropdownPrediksi = document.getElementById("dropdownPrediksi");
  if (dropdownPrediksi) {
    dropdownPrediksi.addEventListener("change", () => {
      lastPrediksiIndex = dropdownPrediksi.value;
      showDetailWithAnimation('prediksi');
    });
  }
  // Dropdown Jadwal
  const dropdownJadwal = document.getElementById("dropdownJadwal");
  if (dropdownJadwal) {
    dropdownJadwal.addEventListener("change", () => {
      lastJadwalIndex = dropdownJadwal.value;
      showDetailWithAnimation('jadwal');
    });
  }
  // Tombol Toggle Tanggal
  const btnToggleTanggal = document.getElementById("btnToggleTanggal");
  if (btnToggleTanggal) {
    btnToggleTanggal.addEventListener("click", () => {
      const form = document.getElementById("formTanggal");
      if (form) {
        form.style.display = form.style.display === "none" ? "block" : "none";
      }
    });
  }
}

function initTanggalPasaran() {
  google.script.run.withSuccessHandler(dateStr => {
    if (!dateStr) return;
    const parts = dateStr.split("/");
    if (parts.length !== 3) return;
    const formattedForInput = `${parts[2]}-${parts[1].padStart(2, "0")}-${parts[0].padStart(2, "0")}`;
    const tanggalInput = document.getElementById("tanggalPasaran");
    if (tanggalInput) {
      tanggalInput.value = formattedForInput;
    }
    const tanggalDisplay = document.getElementById("tanggalTerpilihDisplay");
    if (tanggalDisplay) {
      tanggalDisplay.textContent = dateStr;
    }
    loadPasaranTogel();
  }).getTanggalPasaran();
}

// ========================================
// GOOGLE APPS SCRIPT PLACEHOLDER FUNCTIONS
// ========================================
// These functions will be replaced by actual Google Apps Script calls in your environment

function getNotes(folder) {
  // Placeholder: returns sample notes
  return [
    { title: "Server Gangguan", content: "Saat ini server sedang gangguan teknis. Estimasi perbaikan 15-30 menit." },
    { title: "Cara Deposit DANA", content: "1. Buka DANA\n2. Pilih Kirim > Ke Bank\n3. Masukkan rekening tujuan\n4. Cantumkan USERID di berita transfer" }
  ];
}

function getPasaranList() {
  // Placeholder: returns sample pasaran list
  return [
    ["SYDNEY - 4D/3D/2D\nColok Bebas: 2D\nColok Macau: 3D\nColok Naga: 4D\nShio: 12 Shio", "SYDNEY\nBuka: 13:50 WIB\nTutup: 13:30 WIB\nHadiah 4D: 3.000x\nDiskon 4D: 29%"],
    ["SINGAPORE - 4D/3D/2D\nColok Bebas: 2D\nColok Macau: 3D\nColok Naga: 4D\nShio: 12 Shio", "SINGAPORE\nBuka: 17:30 WIB\nTutup: 17:20 WIB\nHadiah 4D: 3.000x\nDiskon 4D: 29%"]
  ];
}

function getHitunganTogel() {
  // Placeholder: returns sample hitungan data
  return {
    kelompok: {
      "HITUNG HADIAH SEMUA PASARAN": [
        {label: "4D", value: "3.000x"},
        {label: "3D", value: "400x"},
        {label: "2D", value: "70x"}
      ]
    }
  };
}

function getReportLineData() {
  // Placeholder: returns sample report line data
  return {
    data: [
      { rowIndex: 2, colA: "Masalah Login", colB: "User tidak bisa login ke akun", colC: "Sudah diinformasikan ke tim IT", colD: "Ditindaklanjuti" }
    ]
  };
}

function getPengaturanTogelLengkap() {
  // Placeholder: returns sample pengaturan data
  return {
    data: [
      {
        judul: "HADIAH PASARAN SYDNEY",
        colNama: "A",
        colHadiah: "B",
        colDiskon: "C",
        startRow: 2,
        items: [
          { nama: "4D", hadiah: "3000", diskon: "29%" },
          { nama: "3D", hadiah: "400", diskon: "29%" }
        ]
      }
    ],
    linkLive: ["https://example.com/sydney"],
    jadwalPasaran: [{ jamTutup: "13:30", namaPasaran: "SYDNEY", diskon: "29%", jamResult: "13:50", link: "https://example.com" }],
    kendalaAllData: [{ rowIndex: 2, judul: "Masalah Login", jawaban1: "Coba reset password", jawaban2: "Clear cache browser", jawaban3: "Hubungi CS" }]
  };
}

// Simulate Google Apps Script run object
window.google = window.google || {};
window.google.script = window.google.script || {};
window.google.script.run = {
  withSuccessHandler: function(callback) {
    return {
      withFailureHandler: function(errorCallback) {
        return {
          getNotes: function(folder) {
            setTimeout(() => callback(getNotes(folder)), 100);
          },
          getPasaranList: function() {
            setTimeout(() => callback(getPasaranList()), 100);
          },
          getHitunganTogel: function() {
            setTimeout(() => callback(getHitunganTogel()), 100);
          },
          getReportLineData: function() {
            setTimeout(() => callback(getReportLineData()), 100);
          },
          getPengaturanTogelLengkap: function() {
            setTimeout(() => callback(getPengaturanTogelLengkap()), 100);
          },
          getTanggalPasaran: function() {
            setTimeout(() => callback("01/01/2026"), 100);
          },
          getDepositData: function() {
            setTimeout(() => callback("DEPO BCA / NAMA\t10000000"), 100);
          },
          getWithdrawData: function() {
            setTimeout(() => callback("KIRIM DANA\t10000000\tDEPO BCA / NAMA"), 100);
          }
        };
      }
    };
  }
};
</script>
</body>
</html>

